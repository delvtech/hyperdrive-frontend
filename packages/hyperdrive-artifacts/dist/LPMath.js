export const LPMath = { "abi": [], "bytecode": { "object": "0x60566037600b82828239805160001a607314602a57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600080fdfea2646970667358221220baeab4aa0b89fa04b101d9731cc3ddf714b0649d3dc9e78d141762ab1ca9262a64736f6c63430008140033", "sourceMap": "645:57737:126:-:0;;;;;;;;;;;;;;;-1:-1:-1;;;645:57737:126;;;;;;;;;;;;;;;;;", "linkReferences": {} }, "deployedBytecode": { "object": "0x73000000000000000000000000000000000000000030146080604052600080fdfea2646970667358221220baeab4aa0b89fa04b101d9731cc3ddf714b0649d3dc9e78d141762ab1ca9262a64736f6c63430008140033", "sourceMap": "645:57737:126:-:0;;;;;;;;", "linkReferences": {} }, "methodIdentifiers": {}, "rawMetadata": "{\"compiler\":{\"version\":\"0.8.20+commit.a1b79de6\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"author\":\"DELV\",\"custom:disclaimer\":\"The language used in this code is for coding convenience                    only, and is not intended to, and does not, have any                    particular legal or regulatory significance.\",\"kind\":\"dev\",\"methods\":{},\"stateVariables\":{\"SHARE_PROCEEDS_MAX_ITERATIONS\":{\"details\":\"The maximum number of iterations for the share proceeds calculation.\"},\"SHARE_PROCEEDS_MIN_TOLERANCE\":{\"details\":\"The minimum tolerance for the share proceeds calculation to      short-circuit.\"}},\"title\":\"LPMath\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Math for the Hyperdrive LP system.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/src/libraries/LPMath.sol\":\"LPMath\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":aave-v3-core/=lib/aave-v3-core/\",\":ds-test/=lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":openzeppelin/=lib/openzeppelin-contracts/contracts/\",\":solmate/=lib/solmate/src/\"]},\"sources\":{\"contracts/src/interfaces/IERC20.sol\":{\"keccak256\":\"0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac\",\"dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p\"]},\"contracts/src/interfaces/IHyperdrive.sol\":{\"keccak256\":\"0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf\",\"dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK\"]},\"contracts/src/interfaces/IHyperdriveCore.sol\":{\"keccak256\":\"0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24\",\"dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h\"]},\"contracts/src/interfaces/IHyperdriveEvents.sol\":{\"keccak256\":\"0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c\",\"dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG\"]},\"contracts/src/interfaces/IHyperdriveRead.sol\":{\"keccak256\":\"0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf\",\"dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6\"]},\"contracts/src/interfaces/IMultiToken.sol\":{\"keccak256\":\"0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7\",\"dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp\"]},\"contracts/src/interfaces/IMultiTokenCore.sol\":{\"keccak256\":\"0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae\",\"dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs\"]},\"contracts/src/interfaces/IMultiTokenEvents.sol\":{\"keccak256\":\"0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222\",\"dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK\"]},\"contracts/src/interfaces/IMultiTokenMetadata.sol\":{\"keccak256\":\"0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3\",\"dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG\"]},\"contracts/src/interfaces/IMultiTokenRead.sol\":{\"keccak256\":\"0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11\",\"dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR\"]},\"contracts/src/libraries/Errors.sol\":{\"keccak256\":\"0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88\",\"dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41\"]},\"contracts/src/libraries/FixedPointMath.sol\":{\"keccak256\":\"0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd\",\"dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L\"]},\"contracts/src/libraries/HyperdriveMath.sol\":{\"keccak256\":\"0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002\",\"dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY\"]},\"contracts/src/libraries/LPMath.sol\":{\"keccak256\":\"0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f\",\"dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ\"]},\"contracts/src/libraries/SafeCast.sol\":{\"keccak256\":\"0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8\",\"dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8\"]},\"contracts/src/libraries/YieldSpaceMath.sol\":{\"keccak256\":\"0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c\",\"dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy\"]}},\"version\":1}", "metadata": { "compiler": { "version": "0.8.20+commit.a1b79de6" }, "language": "Solidity", "output": { "abi": [], "devdoc": { "kind": "dev", "methods": {}, "version": 1 }, "userdoc": { "kind": "user", "methods": {}, "version": 1 } }, "settings": { "remappings": ["@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/", "aave-v3-core/=lib/aave-v3-core/", "ds-test/=lib/forge-std/lib/ds-test/src/", "erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/", "forge-std/=lib/forge-std/src/", "openzeppelin-contracts/=lib/openzeppelin-contracts/", "openzeppelin/=lib/openzeppelin-contracts/contracts/", "solmate/=lib/solmate/src/"], "optimizer": { "enabled": true, "runs": 200 }, "metadata": { "bytecodeHash": "ipfs" }, "compilationTarget": { "contracts/src/libraries/LPMath.sol": "LPMath" }, "libraries": {} }, "sources": { "contracts/src/interfaces/IERC20.sol": { "keccak256": "0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9", "urls": ["bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac", "dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdrive.sol": { "keccak256": "0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952", "urls": ["bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf", "dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveCore.sol": { "keccak256": "0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e", "urls": ["bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24", "dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveEvents.sol": { "keccak256": "0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0", "urls": ["bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c", "dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveRead.sol": { "keccak256": "0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55", "urls": ["bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf", "dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiToken.sol": { "keccak256": "0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f", "urls": ["bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7", "dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenCore.sol": { "keccak256": "0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501", "urls": ["bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae", "dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenEvents.sol": { "keccak256": "0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb", "urls": ["bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222", "dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenMetadata.sol": { "keccak256": "0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca", "urls": ["bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3", "dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenRead.sol": { "keccak256": "0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0", "urls": ["bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11", "dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR"], "license": "Apache-2.0" }, "contracts/src/libraries/Errors.sol": { "keccak256": "0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0", "urls": ["bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88", "dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41"], "license": "Apache-2.0" }, "contracts/src/libraries/FixedPointMath.sol": { "keccak256": "0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076", "urls": ["bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd", "dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L"], "license": "Apache-2.0" }, "contracts/src/libraries/HyperdriveMath.sol": { "keccak256": "0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab", "urls": ["bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002", "dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY"], "license": "Apache-2.0" }, "contracts/src/libraries/LPMath.sol": { "keccak256": "0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067", "urls": ["bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f", "dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ"], "license": "Apache-2.0" }, "contracts/src/libraries/SafeCast.sol": { "keccak256": "0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148", "urls": ["bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8", "dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8"], "license": "Apache-2.0" }, "contracts/src/libraries/YieldSpaceMath.sol": { "keccak256": "0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891", "urls": ["bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c", "dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy"], "license": "Apache-2.0" } }, "version": 1 }, "ast": { "absolutePath": "contracts/src/libraries/LPMath.sol", "id": 22135, "exportedSymbols": { "FixedPointMath": [19442], "HyperdriveMath": [20190], "IHyperdrive": [11076], "LPMath": [22134], "ONE": [18676], "SafeCast": [22313], "YieldSpaceMath": [23292] }, "nodeType": "SourceUnit", "src": "39:58344:126", "nodes": [{ "id": 20192, "nodeType": "PragmaDirective", "src": "39:23:126", "nodes": [], "literals": ["solidity", "0.8", ".20"] }, { "id": 20194, "nodeType": "ImportDirective", "src": "64:60:126", "nodes": [], "absolutePath": "contracts/src/interfaces/IHyperdrive.sol", "file": "../interfaces/IHyperdrive.sol", "nameLocation": "-1:-1:-1", "scope": 22135, "sourceUnit": 11077, "symbolAliases": [{ "foreign": { "id": 20193, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11076, "src": "73:11:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20197, "nodeType": "ImportDirective", "src": "125:59:126", "nodes": [], "absolutePath": "contracts/src/libraries/FixedPointMath.sol", "file": "./FixedPointMath.sol", "nameLocation": "-1:-1:-1", "scope": 22135, "sourceUnit": 19443, "symbolAliases": [{ "foreign": { "id": 20195, "name": "FixedPointMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 19442, "src": "134:14:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }, { "foreign": { "id": 20196, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "150:3:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20199, "nodeType": "ImportDirective", "src": "185:54:126", "nodes": [], "absolutePath": "contracts/src/libraries/HyperdriveMath.sol", "file": "./HyperdriveMath.sol", "nameLocation": "-1:-1:-1", "scope": 22135, "sourceUnit": 20191, "symbolAliases": [{ "foreign": { "id": 20198, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "194:14:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20201, "nodeType": "ImportDirective", "src": "240:42:126", "nodes": [], "absolutePath": "contracts/src/libraries/SafeCast.sol", "file": "./SafeCast.sol", "nameLocation": "-1:-1:-1", "scope": 22135, "sourceUnit": 22314, "symbolAliases": [{ "foreign": { "id": 20200, "name": "SafeCast", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22313, "src": "249:8:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20203, "nodeType": "ImportDirective", "src": "283:54:126", "nodes": [], "absolutePath": "contracts/src/libraries/YieldSpaceMath.sol", "file": "./YieldSpaceMath.sol", "nameLocation": "-1:-1:-1", "scope": 22135, "sourceUnit": 23293, "symbolAliases": [{ "foreign": { "id": 20202, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "292:14:126", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 22134, "nodeType": "ContractDefinition", "src": "645:57737:126", "nodes": [{ "id": 20206, "nodeType": "UsingForDirective", "src": "666:27:126", "nodes": [], "global": false, "libraryName": { "id": 20205, "name": "FixedPointMath", "nameLocations": ["672:14:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 19442, "src": "672:14:126" } }, { "id": 20209, "nodeType": "UsingForDirective", "src": "698:27:126", "nodes": [], "global": false, "libraryName": { "id": 20207, "name": "SafeCast", "nameLocations": ["704:8:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 22313, "src": "704:8:126" }, "typeName": { "id": 20208, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "717:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } } }, { "id": 20213, "nodeType": "VariableDeclaration", "src": "813:59:126", "nodes": [], "constant": true, "documentation": { "id": 20210, "nodeType": "StructuredDocumentation", "src": "731:77:126", "text": "@dev The maximum number of iterations for the share proceeds calculation." }, "mutability": "constant", "name": "SHARE_PROCEEDS_MAX_ITERATIONS", "nameLocation": "839:29:126", "scope": 22134, "stateVariable": true, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20211, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "813:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "value": { "hexValue": "34", "id": 20212, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "871:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_4_by_1", "typeString": "int_const 4" }, "value": "4" }, "visibility": "internal" }, { "id": 20217, "nodeType": "VariableDeclaration", "src": "980:60:126", "nodes": [], "constant": true, "documentation": { "id": 20214, "nodeType": "StructuredDocumentation", "src": "879:96:126", "text": "@dev The minimum tolerance for the share proceeds calculation to\n      short-circuit." }, "mutability": "constant", "name": "SHARE_PROCEEDS_MIN_TOLERANCE", "nameLocation": "1006:28:126", "scope": 22134, "stateVariable": true, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20215, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "980:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "value": { "hexValue": "316539", "id": 20216, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1037:3:126", "typeDescriptions": { "typeIdentifier": "t_rational_1000000000_by_1", "typeString": "int_const 1000000000" }, "value": "1e9" }, "visibility": "internal" }, { "id": 20264, "nodeType": "FunctionDefinition", "src": "1782:813:126", "nodes": [], "body": { "id": 20263, "nodeType": "Block", "src": "2159:436:126", "nodes": [], "statements": [{ "assignments": [20238], "declarations": [{ "constant": false, "id": 20238, "mutability": "mutable", "name": "success", "nameLocation": "2174:7:126", "nodeType": "VariableDeclaration", "scope": 20263, "src": "2169:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20237, "name": "bool", "nodeType": "ElementaryTypeName", "src": "2169:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20239, "nodeType": "VariableDeclarationStatement", "src": "2169:12:126" }, { "expression": { "id": 20252, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20240, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20231, "src": "2205:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20241, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20233, "src": "2232:15:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20242, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20235, "src": "2261:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20243, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20238, "src": "2287:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20244, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "2191:113:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20246, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20220, "src": "2349:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20247, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20222, "src": "2377:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20248, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20224, "src": "2407:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20249, "name": "_minimumShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20226, "src": "2434:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20250, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20228, "src": "2469:19:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20245, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20417, "src": "2307:28:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 20251, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2307:191:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "2191:307:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20253, "nodeType": "ExpressionStatement", "src": "2191:307:126" }, { "condition": { "id": 20255, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "2512:8:126", "subExpression": { "id": 20254, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20238, "src": "2513:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20262, "nodeType": "IfStatement", "src": "2508:81:126", "trueBody": { "id": 20261, "nodeType": "Block", "src": "2522:67:126", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20256, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11076, "src": "2543:11:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11076_$", "typeString": "type(contract IHyperdrive)" } }, "id": 20258, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2555:21:126", "memberName": "UpdateLiquidityFailed", "nodeType": "MemberAccess", "referencedDeclaration": 11045, "src": "2543:33:126", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 20259, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2543:35:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20260, "nodeType": "RevertStatement", "src": "2536:42:126" }] } }] }, "documentation": { "id": 20218, "nodeType": "StructuredDocumentation", "src": "1047:730:126", "text": "@dev Calculates the new share reserves, share adjustment, and bond\n      reserves after liquidity is added or removed from the pool. This\n      update is made in such a way that the pool's spot price remains\n      constant.\n @param _shareReserves The current share reserves.\n @param _shareAdjustment The current share adjustment.\n @param _bondReserves The current bond reserves.\n @param _minimumShareReserves The minimum share reserves.\n @param _shareReservesDelta The change in share reserves.\n @return shareReserves The updated share reserves.\n @return shareAdjustment The updated share adjustment.\n @return bondReserves The updated bond reserves." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateUpdateLiquidity", "nameLocation": "1791:24:126", "parameters": { "id": 20229, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20220, "mutability": "mutable", "name": "_shareReserves", "nameLocation": "1833:14:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "1825:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20219, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1825:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20222, "mutability": "mutable", "name": "_shareAdjustment", "nameLocation": "1864:16:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "1857:23:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20221, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1857:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20224, "mutability": "mutable", "name": "_bondReserves", "nameLocation": "1898:13:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "1890:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20223, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1890:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20226, "mutability": "mutable", "name": "_minimumShareReserves", "nameLocation": "1929:21:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "1921:29:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20225, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1921:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20228, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "1967:19:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "1960:26:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20227, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1960:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "1815:177:126" }, "returnParameters": { "id": 20236, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20231, "mutability": "mutable", "name": "shareReserves", "nameLocation": "2061:13:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "2053:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20230, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2053:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20233, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "2095:15:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "2088:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20232, "name": "int256", "nodeType": "ElementaryTypeName", "src": "2088:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20235, "mutability": "mutable", "name": "bondReserves", "nameLocation": "2132:12:126", "nodeType": "VariableDeclaration", "scope": 20264, "src": "2124:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20234, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2124:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "2039:115:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20417, "nodeType": "FunctionDefinition", "src": "3400:3557:126", "nodes": [], "body": { "id": 20416, "nodeType": "Block", "src": "3799:3158:126", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20288, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20286, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20275, "src": "3919:19:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 20287, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "3942:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "3919:24:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20296, "nodeType": "IfStatement", "src": "3915:117:126", "trueBody": { "id": 20295, "nodeType": "Block", "src": "3945:87:126", "statements": [{ "expression": { "components": [{ "id": 20289, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20267, "src": "3967:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20290, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20269, "src": "3983:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20291, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20271, "src": "4001:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20292, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "4016:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20293, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "3966:55:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "functionReturnParameters": 20285, "id": 20294, "nodeType": "Return", "src": "3959:62:126" }] } }, { "assignments": [20298], "declarations": [{ "constant": false, "id": 20298, "mutability": "mutable", "name": "shareReserves_", "nameLocation": "4208:14:126", "nodeType": "VariableDeclaration", "scope": 20416, "src": "4201:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20297, "name": "int256", "nodeType": "ElementaryTypeName", "src": "4201:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20304, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20303, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20299, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20267, "src": "4225:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20300, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "4240:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "4225:23:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20301, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4225:25:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 20302, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20275, "src": "4253:19:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "4225:47:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "4201:71:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20309, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20305, "name": "shareReserves_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20298, "src": "4286:14:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20306, "name": "_minimumShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20273, "src": "4303:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20307, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "4325:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "4303:30:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20308, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4303:32:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "4286:49:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20317, "nodeType": "IfStatement", "src": "4282:103:126", "trueBody": { "id": 20316, "nodeType": "Block", "src": "4337:48:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20310, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4359:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20311, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4362:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20312, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4365:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20313, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "4368:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20314, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "4358:16:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20285, "id": 20315, "nodeType": "Return", "src": "4351:23:126" }] } }, { "expression": { "id": 20323, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20318, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20278, "src": "4394:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20321, "name": "shareReserves_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20298, "src": "4418:14:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20320, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "4410:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20319, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4410:7:126", "typeDescriptions": {} } }, "id": 20322, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4410:23:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "4394:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20324, "nodeType": "ExpressionStatement", "src": "4394:39:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20327, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20325, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20269, "src": "4988:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 20326, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "5008:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "4988:21:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20357, "nodeType": "Block", "src": "5250:231:126", "statements": [{ "expression": { "id": 20355, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20342, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20280, "src": "5340:15:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "id": 20354, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "5358:112:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "arguments": [{ "id": 20348, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "5407:17:126", "subExpression": { "id": 20347, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20269, "src": "5408:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20346, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "5399:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20345, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5399:7:126", "typeDescriptions": {} } }, "id": 20349, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5399:26:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20350, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20267, "src": "5427:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20343, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20278, "src": "5359:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20344, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5390:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "5359:39:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20351, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5359:83:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20352, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5460:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "5359:109:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20353, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5359:111:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "5340:130:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20356, "nodeType": "ExpressionStatement", "src": "5340:130:126" }] }, "id": 20358, "nodeType": "IfStatement", "src": "4984:497:126", "trueBody": { "id": 20341, "nodeType": "Block", "src": "5011:233:126", "statements": [{ "expression": { "id": 20339, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20328, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20280, "src": "5103:15:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "arguments": [{ "id": 20333, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20269, "src": "5171:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20332, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "5163:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20331, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5163:7:126", "typeDescriptions": {} } }, "id": 20334, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5163:25:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20335, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20267, "src": "5190:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20329, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20278, "src": "5121:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20330, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5152:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "5121:41:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20336, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5121:84:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20337, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5223:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "5121:110:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20338, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5121:112:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "5103:130:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20340, "nodeType": "ExpressionStatement", "src": "5103:130:126" }] } }, { "assignments": [20360, 20362], "declarations": [{ "constant": false, "id": 20360, "mutability": "mutable", "name": "oldEffectiveShareReserves", "nameLocation": "6191:25:126", "nodeType": "VariableDeclaration", "scope": 20416, "src": "6183:33:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20359, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6183:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20362, "mutability": "mutable", "name": "success", "nameLocation": "6223:7:126", "nodeType": "VariableDeclaration", "scope": 20416, "src": "6218:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20361, "name": "bool", "nodeType": "ElementaryTypeName", "src": "6218:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20368, "initialValue": { "arguments": [{ "id": 20365, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20267, "src": "6315:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20366, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20269, "src": "6347:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20363, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "6234:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20190_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20364, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6262:35:126", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19670, "src": "6234:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20367, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6234:143:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "6182:195:126" }, { "condition": { "id": 20370, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "6391:8:126", "subExpression": { "id": 20369, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20362, "src": "6392:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20378, "nodeType": "IfStatement", "src": "6387:62:126", "trueBody": { "id": 20377, "nodeType": "Block", "src": "6401:48:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20371, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6423:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20372, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6426:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20373, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6429:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20374, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6432:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20375, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6422:16:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20285, "id": 20376, "nodeType": "Return", "src": "6415:23:126" }] } }, { "assignments": [20380], "declarations": [{ "constant": false, "id": 20380, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "6466:22:126", "nodeType": "VariableDeclaration", "scope": 20416, "src": "6458:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20379, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6458:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20381, "nodeType": "VariableDeclarationStatement", "src": "6458:30:126" }, { "expression": { "id": 20390, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20382, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20380, "src": "6499:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20383, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20362, "src": "6523:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20384, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "6498:33:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20387, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20278, "src": "6615:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20388, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20280, "src": "6646:15:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20385, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "6534:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20190_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20386, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6562:35:126", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19670, "src": "6534:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20389, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6534:141:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "6498:177:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20391, "nodeType": "ExpressionStatement", "src": "6498:177:126" }, { "condition": { "id": 20393, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "6689:8:126", "subExpression": { "id": 20392, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20362, "src": "6690:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20401, "nodeType": "IfStatement", "src": "6685:62:126", "trueBody": { "id": 20400, "nodeType": "Block", "src": "6699:48:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20394, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6721:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20395, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6724:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20396, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6727:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20397, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6730:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20398, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6720:16:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20285, "id": 20399, "nodeType": "Return", "src": "6713:23:126" }] } }, { "expression": { "id": 20408, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20402, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20282, "src": "6756:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20405, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20380, "src": "6809:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20406, "name": "oldEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20360, "src": "6845:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20403, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20271, "src": "6771:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20404, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6785:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "6771:24:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20407, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6771:109:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "6756:124:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20409, "nodeType": "ExpressionStatement", "src": "6756:124:126" }, { "expression": { "components": [{ "id": 20410, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20278, "src": "6899:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20411, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20280, "src": "6914:15:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20412, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20282, "src": "6931:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20413, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6945:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20414, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6898:52:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "functionReturnParameters": 20285, "id": 20415, "nodeType": "Return", "src": "6891:59:126" }] }, "documentation": { "id": 20265, "nodeType": "StructuredDocumentation", "src": "2601:794:126", "text": "@dev Calculates the new share reserves, share adjustment, and bond\n      reserves after liquidity is added or removed from the pool. This\n      update is made in such a way that the pool's spot price remains\n      constant.\n @param _shareReserves The current share reserves.\n @param _shareAdjustment The current share adjustment.\n @param _bondReserves The current bond reserves.\n @param _minimumShareReserves The minimum share reserves.\n @param _shareReservesDelta The change in share reserves.\n @return shareReserves The updated share reserves.\n @return shareAdjustment The updated share adjustment.\n @return bondReserves The updated bond reserves.\n @return A flag indicating if the calculation succeeded." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateUpdateLiquiditySafe", "nameLocation": "3409:28:126", "parameters": { "id": 20276, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20267, "mutability": "mutable", "name": "_shareReserves", "nameLocation": "3455:14:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3447:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20266, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3447:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20269, "mutability": "mutable", "name": "_shareAdjustment", "nameLocation": "3486:16:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3479:23:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20268, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3479:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20271, "mutability": "mutable", "name": "_bondReserves", "nameLocation": "3520:13:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3512:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20270, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3512:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20273, "mutability": "mutable", "name": "_minimumShareReserves", "nameLocation": "3551:21:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3543:29:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20272, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3543:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20275, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "3589:19:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3582:26:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20274, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3582:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "3437:177:126" }, "returnParameters": { "id": 20285, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20278, "mutability": "mutable", "name": "shareReserves", "nameLocation": "3683:13:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3675:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20277, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3675:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20280, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "3717:15:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3710:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20279, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3710:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20282, "mutability": "mutable", "name": "bondReserves", "nameLocation": "3754:12:126", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3746:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20281, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3746:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20284, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20417, "src": "3780:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20283, "name": "bool", "nodeType": "ElementaryTypeName", "src": "3780:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "3661:133:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20442, "nodeType": "StructDefinition", "src": "6963:462:126", "nodes": [], "canonicalName": "LPMath.PresentValueParams", "members": [{ "constant": false, "id": 20419, "mutability": "mutable", "name": "shareReserves", "nameLocation": "7007:13:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "6999:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20418, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6999:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20421, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "7037:15:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7030:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20420, "name": "int256", "nodeType": "ElementaryTypeName", "src": "7030:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20423, "mutability": "mutable", "name": "bondReserves", "nameLocation": "7070:12:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7062:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20422, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7062:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20425, "mutability": "mutable", "name": "vaultSharePrice", "nameLocation": "7100:15:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7092:23:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20424, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7092:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20427, "mutability": "mutable", "name": "initialVaultSharePrice", "nameLocation": "7133:22:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7125:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20426, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7125:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20429, "mutability": "mutable", "name": "minimumShareReserves", "nameLocation": "7173:20:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7165:28:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20428, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7165:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20431, "mutability": "mutable", "name": "minimumTransactionAmount", "nameLocation": "7211:24:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7203:32:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20430, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7203:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20433, "mutability": "mutable", "name": "timeStretch", "nameLocation": "7253:11:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7245:19:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20432, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7245:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20435, "mutability": "mutable", "name": "longsOutstanding", "nameLocation": "7282:16:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7274:24:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20434, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7274:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20437, "mutability": "mutable", "name": "longAverageTimeRemaining", "nameLocation": "7316:24:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7308:32:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20436, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7308:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20439, "mutability": "mutable", "name": "shortsOutstanding", "nameLocation": "7358:17:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7350:25:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20438, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7350:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20441, "mutability": "mutable", "name": "shortAverageTimeRemaining", "nameLocation": "7393:25:126", "nodeType": "VariableDeclaration", "scope": 20442, "src": "7385:33:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20440, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7385:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "name": "PresentValueParams", "nameLocation": "6970:18:126", "scope": 22134, "visibility": "public" }, { "id": 20471, "nodeType": "FunctionDefinition", "src": "7782:341:126", "nodes": [], "body": { "id": 20470, "nodeType": "Block", "src": "7894:229:126", "nodes": [], "statements": [{ "assignments": [20452, 20454], "declarations": [{ "constant": false, "id": 20452, "mutability": "mutable", "name": "presentValue", "nameLocation": "7913:12:126", "nodeType": "VariableDeclaration", "scope": 20470, "src": "7905:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20451, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7905:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20454, "mutability": "mutable", "name": "success", "nameLocation": "7932:7:126", "nodeType": "VariableDeclaration", "scope": 20470, "src": "7927:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20453, "name": "bool", "nodeType": "ElementaryTypeName", "src": "7927:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20458, "initialValue": { "arguments": [{ "id": 20456, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20446, "src": "7982:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20455, "name": "calculatePresentValueSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20537, "src": "7943:25:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256,bool)" } }, "id": 20457, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7943:56:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "7904:95:126" }, { "condition": { "id": 20460, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "8013:8:126", "subExpression": { "id": 20459, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20454, "src": "8014:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20467, "nodeType": "IfStatement", "src": "8009:79:126", "trueBody": { "id": 20466, "nodeType": "Block", "src": "8023:65:126", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20461, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11076, "src": "8044:11:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11076_$", "typeString": "type(contract IHyperdrive)" } }, "id": 20463, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "8056:19:126", "memberName": "InvalidPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 10974, "src": "8044:31:126", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 20464, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8044:33:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20465, "nodeType": "RevertStatement", "src": "8037:40:126" }] } }, { "expression": { "id": 20468, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20452, "src": "8104:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 20450, "id": 20469, "nodeType": "Return", "src": "8097:19:126" }] }, "documentation": { "id": 20443, "nodeType": "StructuredDocumentation", "src": "7431:346:126", "text": "@dev Calculates the present value LPs capital in the pool and reverts\n      if the value is negative. This calculation underestimates the\n      present value to avoid paying out more than the pool can afford.\n @param _params The parameters for the present value calculation.\n @return The present value of the pool." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculatePresentValue", "nameLocation": "7791:21:126", "parameters": { "id": 20447, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20446, "mutability": "mutable", "name": "_params", "nameLocation": "7848:7:126", "nodeType": "VariableDeclaration", "scope": 20471, "src": "7822:33:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20445, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20444, "name": "PresentValueParams", "nameLocations": ["7822:18:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20442, "src": "7822:18:126" }, "referencedDeclaration": 20442, "src": "7822:18:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "7812:49:126" }, "returnParameters": { "id": 20450, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20449, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20471, "src": "7885:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20448, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7885:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "7884:9:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20537, "nodeType": "FunctionDefinition", "src": "8818:1173:126", "nodes": [], "body": { "id": 20536, "nodeType": "Block", "src": "8940:1051:126", "nodes": [], "statements": [{ "assignments": [20483], "declarations": [{ "constant": false, "id": 20483, "mutability": "mutable", "name": "presentValue", "nameLocation": "9318:12:126", "nodeType": "VariableDeclaration", "scope": 20536, "src": "9311:19:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20482, "name": "int256", "nodeType": "ElementaryTypeName", "src": "9311:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20484, "nodeType": "VariableDeclarationStatement", "src": "9311:19:126" }, { "id": 20519, "nodeType": "Block", "src": "9340:422:126", "statements": [{ "assignments": [20486, 20488], "declarations": [{ "constant": false, "id": 20486, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "9362:13:126", "nodeType": "VariableDeclaration", "scope": 20519, "src": "9355:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20485, "name": "int256", "nodeType": "ElementaryTypeName", "src": "9355:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20488, "mutability": "mutable", "name": "success", "nameLocation": "9382:7:126", "nodeType": "VariableDeclaration", "scope": 20519, "src": "9377:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20487, "name": "bool", "nodeType": "ElementaryTypeName", "src": "9377:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20492, "initialValue": { "arguments": [{ "id": 20490, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20475, "src": "9437:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20489, "name": "calculateNetCurveTradeSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20872, "src": "9393:26:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_int256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256,bool)" } }, "id": 20491, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9393:65:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "9354:104:126" }, { "condition": { "id": 20494, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "9476:8:126", "subExpression": { "id": 20493, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20488, "src": "9477:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20500, "nodeType": "IfStatement", "src": "9472:64:126", "trueBody": { "id": 20499, "nodeType": "Block", "src": "9486:50:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20495, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9512:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20496, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9515:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20497, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9511:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20481, "id": 20498, "nodeType": "Return", "src": "9504:17:126" }] } }, { "expression": { "id": 20517, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20501, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20483, "src": "9549:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20516, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20511, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20507, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "expression": { "id": 20502, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20475, "src": "9580:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20503, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "9588:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "9580:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20504, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9602:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "9580:30:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20505, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9580:32:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 20506, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20486, "src": "9631:13:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:64:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 20509, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20475, "src": "9685:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20508, "name": "calculateNetFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20910, "src": "9663:21:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_int256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256)" } }, "id": 20510, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9663:30:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:113:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "expression": { "id": 20512, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20475, "src": "9712:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20513, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "9720:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "9712:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20514, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9741:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "9712:37:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20515, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9712:39:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:171:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9549:202:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20518, "nodeType": "ExpressionStatement", "src": "9549:202:126" }] }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20522, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20520, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20483, "src": "9878:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 20521, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9893:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "9878:16:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20528, "nodeType": "IfStatement", "src": "9874:64:126", "trueBody": { "id": 20527, "nodeType": "Block", "src": "9896:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20523, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9918:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20524, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9921:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20525, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9917:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20481, "id": 20526, "nodeType": "Return", "src": "9910:17:126" }] } }, { "expression": { "components": [{ "arguments": [{ "id": 20531, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20483, "src": "9964:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20530, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "9956:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20529, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9956:7:126", "typeDescriptions": {} } }, "id": 20532, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9956:21:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20533, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9979:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20534, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9955:29:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 20481, "id": 20535, "nodeType": "Return", "src": "9948:36:126" }] }, "documentation": { "id": 20472, "nodeType": "StructuredDocumentation", "src": "8129:684:126", "text": "@dev Calculates the present value LPs capital in the pool and returns\n      a flag indicating whether the calculation succeeded or failed.\n      For the most part, this calculation underestimates the present\n      value to avoid paying out more than the pool can afford; however,\n      it adheres faithfully to the rounding utilized when positions are\n      closed to accurately simulate the impact of closing the net curve\n      position.\n @param _params The parameters for the present value calculation.\n @return The present value of the pool.\n @return A flag indicating whether the calculation succeeded or failed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculatePresentValueSafe", "nameLocation": "8827:25:126", "parameters": { "id": 20476, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20475, "mutability": "mutable", "name": "_params", "nameLocation": "8888:7:126", "nodeType": "VariableDeclaration", "scope": 20537, "src": "8862:33:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20474, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20473, "name": "PresentValueParams", "nameLocations": ["8862:18:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20442, "src": "8862:18:126" }, "referencedDeclaration": 20442, "src": "8862:18:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "8852:49:126" }, "returnParameters": { "id": 20481, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20478, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20537, "src": "8925:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20477, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8925:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20480, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20537, "src": "8934:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20479, "name": "bool", "nodeType": "ElementaryTypeName", "src": "8934:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "8924:15:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20872, "nodeType": "FunctionDefinition", "src": "10319:9443:126", "nodes": [], "body": { "id": 20871, "nodeType": "Block", "src": "10441:9321:126", "nodes": [], "statements": [{ "assignments": [20549], "declarations": [{ "constant": false, "id": 20549, "mutability": "mutable", "name": "netCurvePosition", "nameLocation": "11244:16:126", "nodeType": "VariableDeclaration", "scope": 20871, "src": "11237:23:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20548, "name": "int256", "nodeType": "ElementaryTypeName", "src": "11237:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20567, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20566, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 20553, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11320:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20554, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11328:24:126", "memberName": "longAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20437, "src": "11320:32:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20550, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11263:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20551, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11284:16:126", "memberName": "longsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20435, "src": "11263:37:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20552, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11314:5:126", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18772, "src": "11263:56:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20555, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11263:90:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20556, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11367:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "11263:112:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20557, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11263:114:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 20561, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11460:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20562, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11468:25:126", "memberName": "shortAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20441, "src": "11460:33:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20558, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11392:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20559, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11417:17:126", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20439, "src": "11392:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20560, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11452:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "11392:67:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20563, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11392:102:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20564, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11512:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "11392:128:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20565, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11392:130:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "11263:259:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "11237:285:126" }, { "assignments": [20569, 20571], "declarations": [{ "constant": false, "id": 20569, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "11541:22:126", "nodeType": "VariableDeclaration", "scope": 20871, "src": "11533:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20568, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "11533:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20571, "mutability": "mutable", "name": "success", "nameLocation": "11570:7:126", "nodeType": "VariableDeclaration", "scope": 20871, "src": "11565:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20570, "name": "bool", "nodeType": "ElementaryTypeName", "src": "11565:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20579, "initialValue": { "arguments": [{ "expression": { "id": 20574, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11662:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20575, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11670:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "11662:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20576, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "11701:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20577, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11709:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "11701:23:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20572, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "11581:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20190_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20573, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11609:35:126", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19670, "src": "11581:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20578, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11581:157:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "11532:206:126" }, { "condition": { "id": 20581, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "11752:8:126", "subExpression": { "id": 20580, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "11753:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20587, "nodeType": "IfStatement", "src": "11748:160:126", "trueBody": { "id": 20586, "nodeType": "Block", "src": "11762:146:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20582, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "11888:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20583, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "11891:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20584, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "11887:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20585, "nodeType": "Return", "src": "11880:17:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20590, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20588, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20549, "src": "12138:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 20589, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "12157:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "12138:20:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20723, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20721, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20549, "src": "16221:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 20722, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "16240:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "16221:20:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20865, "nodeType": "IfStatement", "src": "16217:3512:126", "trueBody": { "id": 20864, "nodeType": "Block", "src": "16243:3486:126", "statements": [{ "assignments": [20725], "declarations": [{ "constant": false, "id": 20725, "mutability": "mutable", "name": "netCurvePosition_", "nameLocation": "16265:17:126", "nodeType": "VariableDeclaration", "scope": 20864, "src": "16257:25:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20724, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16257:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20731, "initialValue": { "arguments": [{ "id": 20729, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "16293:17:126", "subExpression": { "id": 20728, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20549, "src": "16294:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20727, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "16285:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20726, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16285:7:126", "typeDescriptions": {} } }, "id": 20730, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16285:26:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "16257:54:126" }, { "assignments": [20733], "declarations": [{ "constant": false, "id": 20733, "mutability": "mutable", "name": "maxCurveTrade", "nameLocation": "16436:13:126", "nodeType": "VariableDeclaration", "scope": 20864, "src": "16428:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20732, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16428:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20734, "nodeType": "VariableDeclarationStatement", "src": "16428:21:126" }, { "expression": { "id": 20752, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20735, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20733, "src": "16464:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20736, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "16479:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20737, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "16463:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20740, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20569, "src": "16571:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20741, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "16615:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20742, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16623:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "16615:20:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20746, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20743, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "16657:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20744, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "16663:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20745, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16671:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "16663:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "16657:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20747, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "16704:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20748, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16712:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "16704:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20749, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "16749:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20750, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16757:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "16749:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20738, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "16490:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20739, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16522:27:126", "memberName": "calculateMaxBuyBondsOutSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23092, "src": "16490:59:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20751, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16490:307:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "16463:334:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20753, "nodeType": "ExpressionStatement", "src": "16463:334:126" }, { "condition": { "id": 20755, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "16815:8:126", "subExpression": { "id": 20754, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "16816:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20761, "nodeType": "IfStatement", "src": "16811:64:126", "trueBody": { "id": 20760, "nodeType": "Block", "src": "16825:50:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20756, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "16851:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20757, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "16854:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20758, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "16850:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20759, "nodeType": "Return", "src": "16843:17:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20764, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20762, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20733, "src": "17035:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 20763, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20725, "src": "17052:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "17035:34:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20862, "nodeType": "Block", "src": "18727:992:126", "statements": [{ "assignments": [20817], "declarations": [{ "constant": false, "id": 20817, "mutability": "mutable", "name": "maxSharePayment", "nameLocation": "18805:15:126", "nodeType": "VariableDeclaration", "scope": 20862, "src": "18797:23:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20816, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "18797:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20818, "nodeType": "VariableDeclarationStatement", "src": "18797:23:126" }, { "expression": { "id": 20836, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20819, "name": "maxSharePayment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20817, "src": "18839:15:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20820, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "18856:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20821, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "18838:26:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20824, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20569, "src": "18956:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20825, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "19004:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20826, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19012:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "19004:20:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20830, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20827, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "19050:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20828, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "19056:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20829, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19064:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "19056:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19050:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20831, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "19101:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20832, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19109:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "19101:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20833, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "19150:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20834, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19158:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "19150:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20822, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "18867:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20823, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18903:27:126", "memberName": "calculateMaxBuySharesInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23009, "src": "18867:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20835, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18867:335:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "18838:364:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20837, "nodeType": "ExpressionStatement", "src": "18838:364:126" }, { "condition": { "id": 20839, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "19224:8:126", "subExpression": { "id": 20838, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "19225:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20845, "nodeType": "IfStatement", "src": "19220:72:126", "trueBody": { "id": 20844, "nodeType": "Block", "src": "19234:58:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20840, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "19264:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20841, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19267:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20842, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19263:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20843, "nodeType": "Return", "src": "19256:17:126" }] } }, { "expression": { "components": [{ "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20855, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20846, "name": "maxSharePayment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20817, "src": "19484:15:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "expression": { "id": 20852, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "19599:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20853, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19607:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "19599:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20849, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20847, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20725, "src": "19527:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 20848, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20733, "src": "19547:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19527:33:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20850, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19526:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20851, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "19562:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "19526:43:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20854, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "19526:122:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19484:164:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20856, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19483:166:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20857, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "19650:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "19483:175:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20858, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "19483:177:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20859, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19682:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20860, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19317:387:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20547, "id": 20861, "nodeType": "Return", "src": "19310:394:126" }] }, "id": 20863, "nodeType": "IfStatement", "src": "17031:2688:126", "trueBody": { "id": 20815, "nodeType": "Block", "src": "17071:1414:126", "statements": [{ "assignments": [20766], "declarations": [{ "constant": false, "id": 20766, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "17352:13:126", "nodeType": "VariableDeclaration", "scope": 20815, "src": "17344:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20765, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "17344:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20767, "nodeType": "VariableDeclarationStatement", "src": "17344:21:126" }, { "expression": { "id": 20786, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20768, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20766, "src": "17384:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20769, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "17399:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20770, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "17383:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20773, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20569, "src": "17508:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20774, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "17556:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20775, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17564:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "17556:20:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20776, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20725, "src": "17602:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20780, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20777, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "17645:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20778, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "17651:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20779, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17659:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "17651:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "17645:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20781, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "17696:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20782, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17704:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "17696:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20783, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "17745:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20784, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17753:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "17745:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20771, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "17410:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20772, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "17446:36:126", "memberName": "calculateSharesInGivenBondsOutUpSafe", "nodeType": "MemberAccess", "referencedDeclaration": 22619, "src": "17410:72:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20785, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "17410:387:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "17383:414:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20787, "nodeType": "ExpressionStatement", "src": "17383:414:126" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 20794, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20789, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "18103:8:126", "subExpression": { "id": 20788, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "18104:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20793, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20790, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20725, "src": "18135:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "id": 20791, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "18155:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20792, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "18163:24:126", "memberName": "minimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 20431, "src": "18155:32:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "18135:52:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "18103:84:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "id": 20801, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "18345:8:126", "subExpression": { "id": 20800, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "18346:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20807, "nodeType": "IfStatement", "src": "18341:72:126", "trueBody": { "id": 20806, "nodeType": "Block", "src": "18355:58:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20802, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "18385:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20803, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18388:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20804, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18384:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20805, "nodeType": "Return", "src": "18377:17:126" }] } }, "id": 20808, "nodeType": "IfStatement", "src": "18078:335:126", "trueBody": { "id": 20799, "nodeType": "Block", "src": "18206:57:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20795, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "18236:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20796, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18239:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20797, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18235:9:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20798, "nodeType": "Return", "src": "18228:16:126" }] } }, { "expression": { "components": [{ "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20809, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20766, "src": "18439:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20810, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18453:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "18439:22:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20811, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18439:24:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20812, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18465:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20813, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18438:32:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20547, "id": 20814, "nodeType": "Return", "src": "18431:39:126" }] } }] } }, "id": 20866, "nodeType": "IfStatement", "src": "12134:7595:126", "trueBody": { "id": 20720, "nodeType": "Block", "src": "12160:3965:126", "statements": [{ "assignments": [20592], "declarations": [{ "constant": false, "id": 20592, "mutability": "mutable", "name": "netCurvePosition_", "nameLocation": "12182:17:126", "nodeType": "VariableDeclaration", "scope": 20720, "src": "12174:25:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20591, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12174:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20597, "initialValue": { "arguments": [{ "id": 20595, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20549, "src": "12210:16:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20594, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "12202:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20593, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12202:7:126", "typeDescriptions": {} } }, "id": 20596, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12202:25:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12174:53:126" }, { "assignments": [20599], "declarations": [{ "constant": false, "id": 20599, "mutability": "mutable", "name": "maxCurveTrade", "nameLocation": "12423:13:126", "nodeType": "VariableDeclaration", "scope": 20720, "src": "12415:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20598, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12415:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20600, "nodeType": "VariableDeclarationStatement", "src": "12415:21:126" }, { "expression": { "id": 20623, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20601, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20599, "src": "12451:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20602, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "12466:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20603, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "12450:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 20606, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12558:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20607, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12566:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "12558:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20608, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12601:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20609, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12609:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "12601:23:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 20610, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12646:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20611, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12654:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "12646:20:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20612, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12688:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20613, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12696:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "12688:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20617, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20614, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "12738:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20615, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12744:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20616, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12752:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "12744:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "12738:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20618, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12785:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20619, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12793:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "12785:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20620, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "12830:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20621, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12838:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "12830:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20604, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "12477:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20605, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12509:27:126", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23223, "src": "12477:59:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20622, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12477:401:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "12450:428:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20624, "nodeType": "ExpressionStatement", "src": "12450:428:126" }, { "condition": { "id": 20626, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "12896:8:126", "subExpression": { "id": 20625, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "12897:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20632, "nodeType": "IfStatement", "src": "12892:176:126", "trueBody": { "id": 20631, "nodeType": "Block", "src": "12906:162:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20627, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "13044:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20628, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "13047:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20629, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "13043:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20630, "nodeType": "Return", "src": "13036:17:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20635, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20633, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20599, "src": "13228:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 20634, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20592, "src": "13245:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "13228:34:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20718, "nodeType": "Block", "src": "14929:1186:126", "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20691, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 20688, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "15323:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20689, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15331:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "15323:23:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 20690, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "15350:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "15323:28:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20716, "nodeType": "Block", "src": "15880:221:126", "statements": [{ "expression": { "components": [{ "id": 20712, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "15935:95:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20708, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 20704, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "15937:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20705, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15945:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "15937:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20706, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "15961:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20707, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15969:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "15961:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "15937:52:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20709, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15936:54:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20710, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16020:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "15936:92:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20711, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15936:94:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20713, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "16056:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20714, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15909:173:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20547, "id": 20715, "nodeType": "Return", "src": "15902:180:126" }] }, "id": 20717, "nodeType": "IfStatement", "src": "15319:782:126", "trueBody": { "id": 20703, "nodeType": "Block", "src": "15353:222:126", "statements": [{ "expression": { "components": [{ "id": 20699, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "15408:96:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20695, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20692, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20569, "src": "15410:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20693, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "15435:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20694, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15443:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "15435:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "15410:53:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20696, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15409:55:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20697, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15494:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "15409:93:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20698, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15409:95:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20700, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "15530:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20701, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15382:174:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20547, "id": 20702, "nodeType": "Return", "src": "15375:181:126" }] } }] }, "id": 20719, "nodeType": "IfStatement", "src": "13224:2891:126", "trueBody": { "id": 20687, "nodeType": "Block", "src": "13264:1416:126", "statements": [{ "assignments": [20637], "declarations": [{ "constant": false, "id": 20637, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "13544:13:126", "nodeType": "VariableDeclaration", "scope": 20687, "src": "13536:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20636, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13536:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20638, "nodeType": "VariableDeclarationStatement", "src": "13536:21:126" }, { "expression": { "id": 20657, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20639, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20637, "src": "13576:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20640, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "13591:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20641, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "13575:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20644, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20569, "src": "13702:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20645, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "13750:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20646, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13758:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "13750:20:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20647, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20592, "src": "13796:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20651, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20648, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "13839:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20649, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "13845:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20650, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13853:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "13845:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "13839:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20652, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "13890:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20653, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13898:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "13890:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20654, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "13939:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20655, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13947:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "13939:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20642, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "13602:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20643, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "13638:38:126", "memberName": "calculateSharesOutGivenBondsInDownSafe", "nodeType": "MemberAccess", "referencedDeclaration": 22919, "src": "13602:74:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20656, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "13602:389:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "13575:416:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20658, "nodeType": "ExpressionStatement", "src": "13575:416:126" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 20665, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20660, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "14297:8:126", "subExpression": { "id": 20659, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "14298:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20664, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20661, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20592, "src": "14329:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "id": 20662, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20541, "src": "14349:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20663, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "14357:24:126", "memberName": "minimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 20431, "src": "14349:32:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "14329:52:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "14297:84:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "id": 20672, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "14539:8:126", "subExpression": { "id": 20671, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20571, "src": "14540:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20678, "nodeType": "IfStatement", "src": "14535:72:126", "trueBody": { "id": 20677, "nodeType": "Block", "src": "14549:58:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20673, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "14579:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20674, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14582:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20675, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14578:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20676, "nodeType": "Return", "src": "14571:17:126" }] } }, "id": 20679, "nodeType": "IfStatement", "src": "14272:335:126", "trueBody": { "id": 20670, "nodeType": "Block", "src": "14400:57:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20666, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "14430:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20667, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14433:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20668, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14429:9:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20669, "nodeType": "Return", "src": "14422:16:126" }] } }, { "expression": { "components": [{ "id": 20683, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "14633:25:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20680, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20637, "src": "14634:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20681, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "14648:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "14634:22:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20682, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "14634:24:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20684, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14660:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20685, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14632:33:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20547, "id": 20686, "nodeType": "Return", "src": "14625:40:126" }] } }] } }, { "expression": { "components": [{ "hexValue": "30", "id": 20867, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "19747:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20868, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19750:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20869, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19746:9:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20547, "id": 20870, "nodeType": "Return", "src": "19739:16:126" }] }, "documentation": { "id": 20538, "nodeType": "StructuredDocumentation", "src": "9997:317:126", "text": "@dev Calculates the result of closing the net curve position.\n @param _params The parameters for the present value calculation.\n @return The impact of closing the net curve position on the share\n         reserves.\n @return A flag indicating whether the calculation succeeded or failed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateNetCurveTradeSafe", "nameLocation": "10328:26:126", "parameters": { "id": 20542, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20541, "mutability": "mutable", "name": "_params", "nameLocation": "10390:7:126", "nodeType": "VariableDeclaration", "scope": 20872, "src": "10364:33:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20540, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20539, "name": "PresentValueParams", "nameLocations": ["10364:18:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20442, "src": "10364:18:126" }, "referencedDeclaration": 20442, "src": "10364:18:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "10354:49:126" }, "returnParameters": { "id": 20547, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20544, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20872, "src": "10427:6:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20543, "name": "int256", "nodeType": "ElementaryTypeName", "src": "10427:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20546, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20872, "src": "10435:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20545, "name": "bool", "nodeType": "ElementaryTypeName", "src": "10435:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "10426:14:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20910, "nodeType": "FunctionDefinition", "src": "20009:1167:126", "nodes": [], "body": { "id": 20909, "nodeType": "Block", "src": "20120:1056:126", "nodes": [], "statements": [{ "expression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20907, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20887, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20884, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "20828:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20885, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "20834:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20886, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20842:25:126", "memberName": "shortAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20441, "src": "20834:33:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "20828:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20888, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "20889:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20889, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20897:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "20889:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20881, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "20770:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20882, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20778:17:126", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20439, "src": "20770:25:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20883, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20796:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "20770:36:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20890, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20770:160:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20891, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "20752:192:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20892, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20945:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "20752:201:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20893, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20752:203:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20900, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20897, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "21043:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20898, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "21049:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20899, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "21057:24:126", "memberName": "longAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20437, "src": "21049:32:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "21043:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20901, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "21103:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20902, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "21111:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "21103:23:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20894, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20876, "src": "20988:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20895, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20996:16:126", "memberName": "longsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20435, "src": "20988:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20896, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "21013:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "20988:33:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20903, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20988:156:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20904, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "20970:188:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20905, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "21159:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "20970:197:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20906, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20970:199:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "20752:417:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "functionReturnParameters": 20880, "id": 20908, "nodeType": "Return", "src": "20733:436:126" }] }, "documentation": { "id": 20873, "nodeType": "StructuredDocumentation", "src": "19768:236:126", "text": "@dev Calculates the result of closing the net flat position.\n @param _params The parameters for the present value calculation.\n @return The impact of closing the net flat position on the share\n         reserves." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateNetFlatTrade", "nameLocation": "20018:21:126", "parameters": { "id": 20877, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20876, "mutability": "mutable", "name": "_params", "nameLocation": "20075:7:126", "nodeType": "VariableDeclaration", "scope": 20910, "src": "20049:33:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20875, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20874, "name": "PresentValueParams", "nameLocations": ["20049:18:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20442, "src": "20049:18:126" }, "referencedDeclaration": 20442, "src": "20049:18:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "20039:49:126" }, "returnParameters": { "id": 20880, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20879, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20910, "src": "20112:6:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20878, "name": "int256", "nodeType": "ElementaryTypeName", "src": "20112:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "20111:8:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20930, "nodeType": "StructDefinition", "src": "21182:377:126", "nodes": [], "canonicalName": "LPMath.DistributeExcessIdleParams", "members": [{ "constant": false, "id": 20913, "mutability": "mutable", "name": "presentValueParams", "nameLocation": "21245:18:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21226:37:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20912, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20911, "name": "PresentValueParams", "nameLocations": ["21226:18:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20442, "src": "21226:18:126" }, "referencedDeclaration": 20442, "src": "21226:18:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }, { "constant": false, "id": 20915, "mutability": "mutable", "name": "startingPresentValue", "nameLocation": "21281:20:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21273:28:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20914, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21273:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20917, "mutability": "mutable", "name": "activeLpTotalSupply", "nameLocation": "21319:19:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21311:27:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20916, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21311:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20919, "mutability": "mutable", "name": "withdrawalSharesTotalSupply", "nameLocation": "21356:27:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21348:35:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20918, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21348:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20921, "mutability": "mutable", "name": "idle", "nameLocation": "21401:4:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21393:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20920, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21393:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20923, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "21422:13:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21415:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20922, "name": "int256", "nodeType": "ElementaryTypeName", "src": "21415:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20925, "mutability": "mutable", "name": "originalShareReserves", "nameLocation": "21453:21:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21445:29:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20924, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21445:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20927, "mutability": "mutable", "name": "originalShareAdjustment", "nameLocation": "21491:23:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21484:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20926, "name": "int256", "nodeType": "ElementaryTypeName", "src": "21484:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20929, "mutability": "mutable", "name": "originalBondReserves", "nameLocation": "21532:20:126", "nodeType": "VariableDeclaration", "scope": 20930, "src": "21524:28:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20928, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21524:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "name": "DistributeExcessIdleParams", "nameLocation": "21189:26:126", "scope": 22134, "visibility": "public" }, { "id": 21048, "nodeType": "FunctionDefinition", "src": "22927:3408:126", "nodes": [], "body": { "id": 21047, "nodeType": "Block", "src": "23064:3271:126", "nodes": [], "statements": [{ "assignments": [20942, 20944], "declarations": [{ "constant": false, "id": 20942, "mutability": "mutable", "name": "originalEffectiveShareReserves", "nameLocation": "23369:30:126", "nodeType": "VariableDeclaration", "scope": 21047, "src": "23361:38:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20941, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23361:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20944, "mutability": "mutable", "name": "success", "nameLocation": "23406:7:126", "nodeType": "VariableDeclaration", "scope": 21047, "src": "23401:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20943, "name": "bool", "nodeType": "ElementaryTypeName", "src": "23401:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20952, "initialValue": { "arguments": [{ "expression": { "id": 20947, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "23498:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 20948, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "23506:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "23498:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20949, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "23545:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 20950, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "23553:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "23545:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20945, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "23417:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20190_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20946, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "23445:35:126", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19670, "src": "23417:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20951, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23417:173:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "23360:230:126" }, { "condition": { "id": 20954, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "23604:8:126", "subExpression": { "id": 20953, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20944, "src": "23605:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20960, "nodeType": "IfStatement", "src": "23600:52:126", "trueBody": { "id": 20959, "nodeType": "Block", "src": "23614:38:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20955, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23636:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20956, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23639:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 20957, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "23635:6:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 20940, "id": 20958, "nodeType": "Return", "src": "23628:13:126" }] } }, { "assignments": [20962], "declarations": [{ "constant": false, "id": 20962, "mutability": "mutable", "name": "maxShareReservesDelta", "nameLocation": "23669:21:126", "nodeType": "VariableDeclaration", "scope": 21047, "src": "23661:29:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20961, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23661:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20963, "nodeType": "VariableDeclarationStatement", "src": "23661:29:126" }, { "expression": { "id": 20971, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20964, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "23701:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20965, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20944, "src": "23724:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20966, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "23700:32:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20968, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "23783:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 20969, "name": "originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20942, "src": "23804:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 20967, "name": "calculateMaxShareReservesDeltaSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21792, "src": "23735:34:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256) pure returns (uint256,bool)" } }, "id": 20970, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23735:109:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "23700:144:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20972, "nodeType": "ExpressionStatement", "src": "23700:144:126" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 20978, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20974, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "23858:8:126", "subExpression": { "id": 20973, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20944, "src": "23859:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20977, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20975, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "23870:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 20976, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23895:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "23870:26:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "23858:38:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20984, "nodeType": "IfStatement", "src": "23854:82:126", "trueBody": { "id": 20983, "nodeType": "Block", "src": "23898:38:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20979, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23920:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20980, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23923:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 20981, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "23919:6:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 20940, "id": 20982, "nodeType": "Return", "src": "23912:13:126" }] } }, { "assignments": [20986], "declarations": [{ "constant": false, "id": 20986, "mutability": "mutable", "name": "withdrawalSharesRedeemed", "nameLocation": "24232:24:126", "nodeType": "VariableDeclaration", "scope": 21047, "src": "24224:32:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20985, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24224:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20991, "initialValue": { "arguments": [{ "id": 20988, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "24330:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 20989, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "24355:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 20987, "name": "calculateDistributeExcessIdleWithdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21142, "src": "24259:53:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256) pure returns (uint256)" } }, "id": 20990, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "24259:131:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "24224:166:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20994, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20992, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20986, "src": "24527:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 20993, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24555:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "24527:29:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21003, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21000, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20986, "src": "24833:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "expression": { "id": 21001, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "24861:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21002, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "24869:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "24861:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "24833:63:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21014, "nodeType": "Block", "src": "25179:87:126", "statements": [{ "expression": { "id": 21012, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21009, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20986, "src": "25193:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "expression": { "id": 21010, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "25220:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21011, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "25228:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "25220:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "25193:62:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21013, "nodeType": "ExpressionStatement", "src": "25193:62:126" }] }, "id": 21015, "nodeType": "IfStatement", "src": "24816:450:126", "trueBody": { "id": 21008, "nodeType": "Block", "src": "24907:81:126", "statements": [{ "expression": { "components": [{ "id": 21004, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20986, "src": "24929:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21005, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "24955:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21006, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "24928:49:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "functionReturnParameters": 20940, "id": 21007, "nodeType": "Return", "src": "24921:56:126" }] } }, "id": 21016, "nodeType": "IfStatement", "src": "24523:743:126", "trueBody": { "id": 20999, "nodeType": "Block", "src": "24558:38:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20995, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24580:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20996, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24583:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 20997, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "24579:6:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 20940, "id": 20998, "nodeType": "Return", "src": "24572:13:126" }] } }, { "assignments": [21018], "declarations": [{ "constant": false, "id": 21018, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "25533:13:126", "nodeType": "VariableDeclaration", "scope": 21047, "src": "25525:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21017, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "25525:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21024, "initialValue": { "arguments": [{ "id": 21020, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20934, "src": "25605:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21021, "name": "originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20942, "src": "25626:30:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21022, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "25670:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21019, "name": "calculateDistributeExcessIdleShareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21523, "src": "25549:42:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,uint256) pure returns (uint256)" } }, "id": 21023, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "25549:152:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "25525:176:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21027, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21025, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21018, "src": "25715:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21026, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25732:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "25715:18:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21033, "nodeType": "IfStatement", "src": "25711:62:126", "trueBody": { "id": 21032, "nodeType": "Block", "src": "25735:38:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21028, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25757:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21029, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25760:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21030, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "25756:6:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 20940, "id": 21031, "nodeType": "Return", "src": "25749:13:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21036, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21034, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21018, "src": "26090:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21035, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20962, "src": "26107:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "26090:38:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21042, "nodeType": "IfStatement", "src": "26086:82:126", "trueBody": { "id": 21041, "nodeType": "Block", "src": "26130:38:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21037, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "26152:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21038, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "26155:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21039, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "26151:6:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 20940, "id": 21040, "nodeType": "Return", "src": "26144:13:126" }] } }, { "expression": { "components": [{ "id": 21043, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20986, "src": "26288:24:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21044, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21018, "src": "26314:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21045, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "26287:41:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "functionReturnParameters": 20940, "id": 21046, "nodeType": "Return", "src": "26280:48:126" }] }, "documentation": { "id": 20931, "nodeType": "StructuredDocumentation", "src": "21565:1357:126", "text": "@dev Calculates the amount of withdrawal shares that can be redeemed and\n      the share proceeds the withdrawal pool should receive given the\n      pool's current idle liquidity. We use the following algorithm to\n      ensure that the withdrawal pool receives the correct amount of\n      shares to (1) preserve the LP share price and (2) pay out as much\n      of the idle liquidity as possible to the withdrawal pool:\n      1. If `y_s * t_s <= y_l * t_l` or\n         `y_max_out(I) >= y_s * t_s - y_l * t_l`, set `dz_max = I` and\n         proceed to step (3). Otherwise, proceed to step (2).\n      2. Solve `y_max_out(dz_max) = y_s * t_s - y_l * t_l` for `dz_max`\n         using Newton's method.\n      3. Set `dw = (1 - PV(dz_max) / PV(0)) * l`. If `dw <= w`, then\n         proceed to step (5). Otherwise, set `dw = w` and continue to\n         step (4).\n      4. Solve `PV(0) / l = PV(dz) / (l - dw)` for `dz` using Newton's\n         method if `y_l * t_l != y_s * t_s` or directly otherwise.\n      5. Return `dw` and `dz`.\n @param _params The parameters for the distribute excess idle.\n @return The amount of withdrawal shares that can be redeemed.\n @return The share proceeds the withdrawal pool should receive." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdle", "nameLocation": "22936:29:126", "parameters": { "id": 20935, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20934, "mutability": "mutable", "name": "_params", "nameLocation": "23009:7:126", "nodeType": "VariableDeclaration", "scope": 21048, "src": "22975:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 20933, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20932, "name": "DistributeExcessIdleParams", "nameLocations": ["22975:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "22975:26:126" }, "referencedDeclaration": 20930, "src": "22975:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "src": "22965:57:126" }, "returnParameters": { "id": 20940, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20937, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21048, "src": "23046:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20936, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23046:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20939, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21048, "src": "23055:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20938, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23055:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "23045:18:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21142, "nodeType": "FunctionDefinition", "src": "27196:2209:126", "nodes": [], "body": { "id": 21141, "nodeType": "Block", "src": "27385:2020:126", "nodes": [], "statements": [{ "assignments": [21060], "declarations": [{ "constant": false, "id": 21060, "mutability": "mutable", "name": "success", "nameLocation": "27480:7:126", "nodeType": "VariableDeclaration", "scope": 21141, "src": "27475:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21059, "name": "bool", "nodeType": "ElementaryTypeName", "src": "27475:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21061, "nodeType": "VariableDeclarationStatement", "src": "27475:12:126" }, { "expression": { "id": 21090, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21062, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27511:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21065, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27519:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "27511:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21066, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27538:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "27511:40:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21067, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27565:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21068, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27573:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "27565:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21069, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27592:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "27565:42:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21070, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27621:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21071, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27629:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "27621:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21072, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27648:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "27621:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21073, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21060, "src": "27674:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21074, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "27497:194:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21076, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27736:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21077, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27744:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "27736:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21078, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27779:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21079, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27787:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "27779:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21080, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27824:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21081, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27832:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "27824:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21082, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "27866:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21083, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27874:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "27866:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21084, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27893:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "27866:47:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21088, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "27927:31:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21085, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21054, "src": "27928:19:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21086, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "27948:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "27928:28:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21087, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "27928:30:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21075, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20417, "src": "27694:28:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21089, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "27694:274:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "27497:471:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21091, "nodeType": "ExpressionStatement", "src": "27497:471:126" }, { "condition": { "id": 21093, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "27982:8:126", "subExpression": { "id": 21092, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21060, "src": "27983:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21097, "nodeType": "IfStatement", "src": "27978:167:126", "trueBody": { "id": 21096, "nodeType": "Block", "src": "27992:153:126", "statements": [{ "expression": { "hexValue": "30", "id": 21094, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28133:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21058, "id": 21095, "nodeType": "Return", "src": "28126:8:126" }] } }, { "assignments": [21099], "declarations": [{ "constant": false, "id": 21099, "mutability": "mutable", "name": "endingPresentValue", "nameLocation": "28162:18:126", "nodeType": "VariableDeclaration", "scope": 21141, "src": "28154:26:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21098, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "28154:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21100, "nodeType": "VariableDeclarationStatement", "src": "28154:26:126" }, { "expression": { "id": 21108, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21101, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21099, "src": "28191:18:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21102, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21060, "src": "28211:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21103, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "28190:29:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21105, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "28261:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21106, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "28269:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "28261:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21104, "name": "calculatePresentValueSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20537, "src": "28222:25:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256,bool)" } }, "id": 21107, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "28222:75:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "28190:107:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21109, "nodeType": "ExpressionStatement", "src": "28190:107:126" }, { "condition": { "id": 21111, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "28311:8:126", "subExpression": { "id": 21110, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21060, "src": "28312:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21115, "nodeType": "IfStatement", "src": "28307:167:126", "trueBody": { "id": 21114, "nodeType": "Block", "src": "28321:153:126", "statements": [{ "expression": { "hexValue": "30", "id": 21112, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28462:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21058, "id": 21113, "nodeType": "Return", "src": "28455:8:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21119, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21116, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21099, "src": "28786:18:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "expression": { "id": 21117, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "28808:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21118, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "28816:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "28808:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28786:50:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21123, "nodeType": "IfStatement", "src": "28782:89:126", "trueBody": { "id": 21122, "nodeType": "Block", "src": "28838:33:126", "statements": [{ "expression": { "hexValue": "30", "id": 21120, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28859:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21058, "id": 21121, "nodeType": "Return", "src": "28852:8:126" }] } }, { "assignments": [21125], "declarations": [{ "constant": false, "id": 21125, "mutability": "mutable", "name": "lpTotalSupply", "nameLocation": "29128:13:126", "nodeType": "VariableDeclaration", "scope": 21141, "src": "29120:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21124, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "29120:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21131, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21130, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21126, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "29144:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21127, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29152:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "29144:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21128, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "29186:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21129, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29194:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "29186:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "29144:77:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "29120:101:126" }, { "expression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21139, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21132, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21125, "src": "29250:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [{ "id": 21135, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21099, "src": "29320:18:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21136, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21052, "src": "29356:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21137, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29364:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "29356:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21133, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21125, "src": "29278:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21134, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "29292:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "29278:24:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21138, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "29278:120:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "29250:148:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21058, "id": 21140, "nodeType": "Return", "src": "29231:167:126" }] }, "documentation": { "id": 21049, "nodeType": "StructuredDocumentation", "src": "26341:850:126", "text": "@dev Calculates the amount of withdrawal shares that can be redeemed\n      given an amount of shares to remove from the share reserves.\n      Assuming that dz is the amount of shares to remove from the\n      reserves and dl is the amount of LP shares to be burned, we can\n      derive the calculation as follows:\n      PV(0) / l = PV(dx) / (l - dl)\n                =>\n      dl = l - l * (PV(dx) / PV(0))\n      We round this calculation up to err on the side of slightly too\n      many withdrawal shares being redeemed.\n @param _params The parameters for the present value calculation.\n @param _shareReservesDelta The amount of shares to remove from the\n        share reserves.\n @return The amount of withdrawal shares that can be redeemed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleWithdrawalSharesRedeemed", "nameLocation": "27205:53:126", "parameters": { "id": 21055, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21052, "mutability": "mutable", "name": "_params", "nameLocation": "27302:7:126", "nodeType": "VariableDeclaration", "scope": 21142, "src": "27268:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21051, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21050, "name": "DistributeExcessIdleParams", "nameLocations": ["27268:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "27268:26:126" }, "referencedDeclaration": 20930, "src": "27268:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21054, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "27327:19:126", "nodeType": "VariableDeclaration", "scope": 21142, "src": "27319:27:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21053, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27319:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "27258:94:126" }, "returnParameters": { "id": 21058, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21057, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21142, "src": "27376:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21056, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27376:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "27375:9:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21523, "nodeType": "FunctionDefinition", "src": "30287:10343:126", "nodes": [], "body": { "id": 21522, "nodeType": "Block", "src": "30517:10113:126", "nodes": [], "statements": [{ "assignments": [21156], "declarations": [{ "constant": false, "id": 21156, "mutability": "mutable", "name": "lpTotalSupply", "nameLocation": "30577:13:126", "nodeType": "VariableDeclaration", "scope": 21522, "src": "30569:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21155, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30569:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21162, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21161, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21157, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "30593:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21158, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "30601:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "30593:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21159, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "30635:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21160, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "30643:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "30635:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30593:77:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "30569:101:126" }, { "assignments": [21164], "declarations": [{ "constant": false, "id": 21164, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "31152:13:126", "nodeType": "VariableDeclaration", "scope": 21522, "src": "31144:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21163, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "31144:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21172, "initialValue": { "arguments": [{ "expression": { "id": 21168, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "31228:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21169, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31236:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "31228:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21170, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21156, "src": "31270:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21165, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "31168:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21166, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31176:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "31168:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21167, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "31204:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "31168:46:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21171, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "31168:125:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "31144:149:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21176, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21173, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "31406:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21174, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31414:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "31406:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21175, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "31431:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "31406:26:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21180, "nodeType": "IfStatement", "src": "31402:77:126", "trueBody": { "id": 21179, "nodeType": "Block", "src": "31434:45:126", "statements": [{ "expression": { "id": 21177, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "31455:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21154, "id": 21178, "nodeType": "Return", "src": "31448:20:126" }] } }, { "body": { "id": 21518, "nodeType": "Block", "src": "31894:8699:126", "statements": [{ "expression": { "id": 21193, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21188, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "32049:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21191, "name": "_maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21150, "src": "32083:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21189, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "32065:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21190, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "32079:3:126", "memberName": "min", "nodeType": "MemberAccess", "referencedDeclaration": 19387, "src": "32065:17:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21192, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32065:41:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "32049:57:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21194, "nodeType": "ExpressionStatement", "src": "32049:57:126" }, { "assignments": [21196], "declarations": [{ "constant": false, "id": 21196, "mutability": "mutable", "name": "success", "nameLocation": "32244:7:126", "nodeType": "VariableDeclaration", "scope": 21518, "src": "32239:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21195, "name": "bool", "nodeType": "ElementaryTypeName", "src": "32239:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21197, "nodeType": "VariableDeclarationStatement", "src": "32239:12:126" }, { "expression": { "id": 21226, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21198, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32283:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21201, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32291:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "32283:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21202, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32310:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "32283:40:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21203, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32341:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21204, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32349:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "32341:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21205, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32368:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "32341:42:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21206, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32401:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21207, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32409:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "32401:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21208, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32428:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "32401:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21209, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "32458:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21210, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "32265:214:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21212, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32528:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21213, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32536:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "32528:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21214, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32575:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21215, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32583:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "32575:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21216, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32624:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21217, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32632:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "32624:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21218, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "32670:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21219, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32678:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "32670:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21220, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32697:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "32670:47:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21224, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "32735:25:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21221, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "32736:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21222, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "32750:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "32736:22:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21223, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32736:24:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21211, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20417, "src": "32482:28:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21225, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32482:292:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "32265:509:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21227, "nodeType": "ExpressionStatement", "src": "32265:509:126" }, { "condition": { "id": 21229, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "32792:8:126", "subExpression": { "id": 21228, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "32793:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21233, "nodeType": "IfStatement", "src": "32788:268:126", "trueBody": { "id": 21232, "nodeType": "Block", "src": "32802:254:126", "statements": [{ "expression": { "hexValue": "30", "id": 21230, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "33040:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21231, "nodeType": "Return", "src": "33033:8:126" }] } }, { "assignments": [21235], "declarations": [{ "constant": false, "id": 21235, "mutability": "mutable", "name": "presentValue", "nameLocation": "33077:12:126", "nodeType": "VariableDeclaration", "scope": 21518, "src": "33069:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21234, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "33069:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21240, "initialValue": { "arguments": [{ "expression": { "id": 21237, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "33131:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21238, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "33139:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "33131:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21236, "name": "calculatePresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20471, "src": "33092:21:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_uint256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256)" } }, "id": 21239, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "33092:79:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "33069:102:126" }, { "condition": { "arguments": [{ "id": 21242, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "33349:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21243, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21235, "src": "33378:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21244, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21156, "src": "33412:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21241, "name": "shouldShortCircuitDistributeExcessIdleShareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21674, "src": "33276:51:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,uint256) pure returns (bool)" } }, "id": 21245, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "33276:167:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21248, "nodeType": "IfStatement", "src": "33255:241:126", "trueBody": { "id": 21247, "nodeType": "Block", "src": "33458:38:126", "statements": [{ "id": 21246, "nodeType": "Break", "src": "33476:5:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21252, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21249, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "33722:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21250, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "33730:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "33722:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 21251, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "33746:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "33722:25:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21408, "nodeType": "IfStatement", "src": "33718:4509:126", "trueBody": { "id": 21407, "nodeType": "Block", "src": "33749:4478:126", "statements": [{ "assignments": [21255], "declarations": [{ "constant": false, "id": 21255, "mutability": "mutable", "name": "params", "nameLocation": "33922:6:126", "nodeType": "VariableDeclaration", "scope": 21407, "src": "33888:40:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21254, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21253, "name": "DistributeExcessIdleParams", "nameLocations": ["33888:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "33888:26:126" }, "referencedDeclaration": 20930, "src": "33888:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "id": 21257, "initialValue": { "id": 21256, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "33931:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "nodeType": "VariableDeclarationStatement", "src": "33888:50:126" }, { "assignments": [21259], "declarations": [{ "constant": false, "id": 21259, "mutability": "mutable", "name": "maxBondAmount", "nameLocation": "33988:13:126", "nodeType": "VariableDeclaration", "scope": 21407, "src": "33980:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21258, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "33980:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21260, "nodeType": "VariableDeclarationStatement", "src": "33980:21:126" }, { "expression": { "id": 21290, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21261, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21259, "src": "34020:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21262, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "34035:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21263, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "34019:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 21266, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34135:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21267, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34142:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34135:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21268, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34161:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "34135:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21269, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34200:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21270, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34207:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34200:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21271, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34226:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "34200:41:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21272, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34267:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21273, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34274:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34267:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21274, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34293:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "34267:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21275, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34331:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21276, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34338:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34331:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21277, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34357:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "34331:46:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21282, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21278, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "34403:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21279, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34409:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21280, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34416:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34409:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21281, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34435:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "34409:37:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "34403:43:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21283, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34472:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21284, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34479:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34472:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21285, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34498:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "34472:41:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21286, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "34539:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21287, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34546:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "34539:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21288, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34565:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "34539:48:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21264, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "34046:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21265, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "34082:27:126", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23223, "src": "34046:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21289, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "34046:563:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "34019:590:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21291, "nodeType": "ExpressionStatement", "src": "34019:590:126" }, { "condition": { "id": 21293, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "34631:8:126", "subExpression": { "id": 21292, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "34632:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21297, "nodeType": "IfStatement", "src": "34627:289:126", "trueBody": { "id": 21296, "nodeType": "Block", "src": "34641:275:126", "statements": [{ "expression": { "hexValue": "30", "id": 21294, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "34896:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21295, "nodeType": "Return", "src": "34889:8:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21304, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21300, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "35102:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21301, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "35109:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "35102:20:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21299, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "35094:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21298, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "35094:7:126", "typeDescriptions": {} } }, "id": 21302, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "35094:29:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21303, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21259, "src": "35127:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "35094:46:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21406, "nodeType": "IfStatement", "src": "35090:3123:126", "trueBody": { "id": 21405, "nodeType": "Block", "src": "35142:3071:126", "statements": [{ "expression": { "id": 21311, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21305, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "35337:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21306, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "35376:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21307, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "35311:94:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21309, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "35495:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }], "id": 21308, "name": "calculateDistributeExcessIdleShareProceedsNetLongEdgeCaseSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21632, "src": "35408:61:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory) pure returns (uint256,bool)" } }, "id": 21310, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "35408:115:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "35311:212:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21312, "nodeType": "ExpressionStatement", "src": "35311:212:126" }, { "condition": { "id": 21314, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "35549:8:126", "subExpression": { "id": 21313, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "35550:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21318, "nodeType": "IfStatement", "src": "35545:200:126", "trueBody": { "id": 21317, "nodeType": "Block", "src": "35559:186:126", "statements": [{ "expression": { "hexValue": "30", "id": 21315, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "35721:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21316, "nodeType": "Return", "src": "35714:8:126" }] } }, { "expression": { "id": 21347, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21319, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "35929:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21322, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "35936:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "35929:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21323, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "35955:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "35929:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21324, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "35994:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21325, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36001:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "35994:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21326, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "36020:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "35994:41:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21327, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36061:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21328, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36068:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "36061:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21329, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "36087:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "36061:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21330, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "36125:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21331, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "35903:251:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21333, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36211:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21334, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36218:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "36211:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21335, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36265:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21336, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36272:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "36265:30:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21337, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36321:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21338, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36328:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "36321:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21339, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36374:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21340, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36381:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "36374:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21341, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36400:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "36374:46:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21345, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "36446:25:126", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21342, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "36447:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21343, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "36461:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "36447:22:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21344, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36447:24:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21332, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20417, "src": "36157:28:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21346, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36157:336:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "35903:590:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21348, "nodeType": "ExpressionStatement", "src": "35903:590:126" }, { "condition": { "id": 21350, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "36519:8:126", "subExpression": { "id": 21349, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "36520:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21354, "nodeType": "IfStatement", "src": "36515:200:126", "trueBody": { "id": 21353, "nodeType": "Block", "src": "36529:186:126", "statements": [{ "expression": { "hexValue": "30", "id": 21351, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "36691:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21352, "nodeType": "Return", "src": "36684:8:126" }] } }, { "expression": { "id": 21384, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21355, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21259, "src": "36737:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21356, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "36752:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21357, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "36736:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 21360, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36860:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21361, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36867:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "36860:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21362, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36886:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "36860:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21363, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "36929:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21364, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36936:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "36929:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21365, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36955:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "36929:41:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21366, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "37000:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21367, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37007:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "37000:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21368, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37026:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "37000:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21369, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "37068:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21370, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37075:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "37068:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21371, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37094:20:126", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20429, "src": "37068:46:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21376, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21372, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "37144:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21373, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "37150:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21374, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37158:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "37150:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21375, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37177:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "37150:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "37144:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21377, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "37218:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21378, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37225:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "37218:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21379, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37244:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "37218:41:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21380, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "37289:6:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21381, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37296:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "37289:25:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21382, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37315:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "37289:48:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21358, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "36763:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21359, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "36803:27:126", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23223, "src": "36763:67:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21383, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36763:600:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "36736:627:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21385, "nodeType": "ExpressionStatement", "src": "36736:627:126" }, { "condition": { "id": 21387, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "37389:8:126", "subExpression": { "id": 21386, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "37390:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21391, "nodeType": "IfStatement", "src": "37385:200:126", "trueBody": { "id": 21390, "nodeType": "Block", "src": "37399:186:126", "statements": [{ "expression": { "hexValue": "30", "id": 21388, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "37561:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21389, "nodeType": "Return", "src": "37554:8:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21398, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21392, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21259, "src": "37883:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "arguments": [{ "expression": { "id": 21395, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "37908:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21396, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37916:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "37908:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21394, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "37900:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21393, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "37900:7:126", "typeDescriptions": {} } }, "id": 21397, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "37900:30:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "37883:47:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21403, "nodeType": "Block", "src": "38138:57:126", "statements": [{ "id": 21402, "nodeType": "Continue", "src": "38164:8:126" }] }, "id": 21404, "nodeType": "IfStatement", "src": "37879:316:126", "trueBody": { "id": 21401, "nodeType": "Block", "src": "37932:69:126", "statements": [{ "expression": { "id": 21399, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "37965:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21154, "id": 21400, "nodeType": "Return", "src": "37958:20:126" }] } }] } }] } }, { "assignments": [21410], "declarations": [{ "constant": false, "id": 21410, "mutability": "mutable", "name": "derivative", "nameLocation": "38511:10:126", "nodeType": "VariableDeclaration", "scope": 21518, "src": "38503:18:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21409, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "38503:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21411, "nodeType": "VariableDeclarationStatement", "src": "38503:18:126" }, { "expression": { "id": 21421, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21412, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "38553:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21413, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "38581:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21414, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "38535:67:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21416, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "38672:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21417, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21148, "src": "38697:31:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21418, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "38746:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21419, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "38754:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "38746:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21415, "name": "calculateSharesDeltaGivenBondsDeltaDerivativeSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22133, "src": "38605:49:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$20930_memory_ptr_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,int256) pure returns (uint256,bool)" } }, "id": 21420, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "38605:176:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "38535:246:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21422, "nodeType": "ExpressionStatement", "src": "38535:246:126" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21428, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21424, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "38799:8:126", "subExpression": { "id": 21423, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21196, "src": "38800:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21427, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21425, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "38811:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21426, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "38825:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "38811:17:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "38799:29:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21432, "nodeType": "IfStatement", "src": "38795:189:126", "trueBody": { "id": 21431, "nodeType": "Block", "src": "38830:154:126", "statements": [{ "expression": { "hexValue": "30", "id": 21429, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "38968:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21430, "nodeType": "Return", "src": "38961:8:126" }] } }, { "id": 21439, "nodeType": "UncheckedBlock", "src": "38997:72:126", "statements": [{ "expression": { "id": 21437, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21433, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "39025:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21436, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21434, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "39038:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21435, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "39044:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39038:16:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39025:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21438, "nodeType": "ExpressionStatement", "src": "39025:29:126" }] }, { "assignments": [21441], "declarations": [{ "constant": false, "id": 21441, "mutability": "mutable", "name": "delta", "nameLocation": "39363:5:126", "nodeType": "VariableDeclaration", "scope": 21518, "src": "39356:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21440, "name": "int256", "nodeType": "ElementaryTypeName", "src": "39356:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 21457, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21456, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "id": 21444, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21156, "src": "39392:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21442, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21235, "src": "39371:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21443, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39384:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "39371:20:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21445, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39371:35:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21446, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39407:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "39371:44:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21447, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39371:46:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 21451, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "39513:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21452, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "39521:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "39513:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21448, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21146, "src": "39436:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21449, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "39465:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "39436:49:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21450, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39507:5:126", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18772, "src": "39436:76:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21453, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39436:105:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21454, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39563:8:126", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22312, "src": "39436:135:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21455, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39436:137:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "39371:202:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "39356:217:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21460, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21458, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21441, "src": "39591:5:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 21459, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "39599:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "39591:9:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21479, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21477, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21441, "src": "39846:5:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 21478, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "39854:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "39846:9:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21511, "nodeType": "Block", "src": "40442:38:126", "statements": [{ "id": 21510, "nodeType": "Break", "src": "40460:5:126" }] }, "id": 21512, "nodeType": "IfStatement", "src": "39842:638:126", "trueBody": { "id": 21509, "nodeType": "Block", "src": "39857:579:126", "statements": [{ "assignments": [21481], "declarations": [{ "constant": false, "id": 21481, "mutability": "mutable", "name": "delta_", "nameLocation": "39955:6:126", "nodeType": "VariableDeclaration", "scope": 21509, "src": "39947:14:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21480, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39947:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21493, "initialValue": { "arguments": [{ "id": 21491, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21156, "src": "40029:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21488, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "39988:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21485, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "39972:6:126", "subExpression": { "id": 21484, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21441, "src": "39973:5:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21483, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "39964:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21482, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39964:7:126", "typeDescriptions": {} } }, "id": 21486, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:15:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21487, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39980:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "39964:23:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21489, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:35:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21490, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "40000:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "39964:43:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21492, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:96:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "39947:113:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21496, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21494, "name": "delta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21481, "src": "40082:6:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21495, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "40091:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40082:22:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21507, "nodeType": "Block", "src": "40249:173:126", "statements": [{ "expression": { "hexValue": "30", "id": 21505, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "40402:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21154, "id": 21506, "nodeType": "Return", "src": "40395:8:126" }] }, "id": 21508, "nodeType": "IfStatement", "src": "40078:344:126", "trueBody": { "id": 21504, "nodeType": "Block", "src": "40106:137:126", "statements": [{ "id": 21503, "nodeType": "UncheckedBlock", "src": "40128:97:126", "statements": [{ "expression": { "id": 21501, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21497, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "40164:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21500, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21498, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "40180:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21499, "name": "delta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21481, "src": "40196:6:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40180:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40164:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21502, "nodeType": "ExpressionStatement", "src": "40164:38:126" }] }] } }] } }, "id": 21513, "nodeType": "IfStatement", "src": "39587:893:126", "trueBody": { "id": 21476, "nodeType": "Block", "src": "39602:234:126", "statements": [{ "expression": { "id": 21474, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21461, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "39692:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21473, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21462, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "39728:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 21471, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21156, "src": "39807:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21468, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21410, "src": "39787:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21465, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21441, "src": "39772:5:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21464, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "39764:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21463, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39764:7:126", "typeDescriptions": {} } }, "id": 21466, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:14:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21467, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39779:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "39764:22:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21469, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:34:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21470, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39799:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "39764:42:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21472, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:57:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39728:93:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39692:129:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21475, "nodeType": "ExpressionStatement", "src": "39692:129:126" }] } }, { "id": 21517, "nodeType": "UncheckedBlock", "src": "40537:46:126", "statements": [{ "expression": { "id": 21515, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": true, "src": "40565:3:126", "subExpression": { "id": 21514, "name": "i", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "40567:1:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21516, "nodeType": "ExpressionStatement", "src": "40565:3:126" }] }] }, "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21187, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21185, "name": "i", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "31857:1:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21186, "name": "SHARE_PROCEEDS_MAX_ITERATIONS", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20213, "src": "31861:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "31857:33:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21519, "initializationExpression": { "assignments": [21182], "declarations": [{ "constant": false, "id": 21182, "mutability": "mutable", "name": "i", "nameLocation": "31850:1:126", "nodeType": "VariableDeclaration", "scope": 21519, "src": "31842:9:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21181, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "31842:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21184, "initialValue": { "hexValue": "30", "id": 21183, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "31854:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "nodeType": "VariableDeclarationStatement", "src": "31842:13:126" }, "nodeType": "ForStatement", "src": "31837:8756:126" }, { "expression": { "id": 21520, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21164, "src": "40610:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21154, "id": 21521, "nodeType": "Return", "src": "40603:20:126" }] }, "documentation": { "id": 21143, "nodeType": "StructuredDocumentation", "src": "29411:871:126", "text": "@dev Calculates the share proceeds to distribute to the withdrawal pool\n      assuming that all of the outstanding withdrawal shares will be\n      redeemed. The share proceeds are calculated such that the LP share\n      price is conserved. When we need to round, we round down to err on\n      the side of slightly too few shares being paid out.\n @param _params The parameters for the distribute excess idle calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @param _maxShareReservesDelta The maximum change in the share reserves\n        that can result from distributing excess idle. This provides an\n        upper bound on the share proceeds returned from this calculation.\n @return The share proceeds to distribute to the withdrawal pool." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleShareProceeds", "nameLocation": "30296:42:126", "parameters": { "id": 21151, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21146, "mutability": "mutable", "name": "_params", "nameLocation": "30382:7:126", "nodeType": "VariableDeclaration", "scope": 21523, "src": "30348:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21145, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21144, "name": "DistributeExcessIdleParams", "nameLocations": ["30348:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "30348:26:126" }, "referencedDeclaration": 20930, "src": "30348:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21148, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "30407:31:126", "nodeType": "VariableDeclaration", "scope": 21523, "src": "30399:39:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21147, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30399:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21150, "mutability": "mutable", "name": "_maxShareReservesDelta", "nameLocation": "30456:22:126", "nodeType": "VariableDeclaration", "scope": 21523, "src": "30448:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21149, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30448:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "30338:146:126" }, "returnParameters": { "id": 21154, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21153, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21523, "src": "30508:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21152, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30508:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "30507:9:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21632, "nodeType": "FunctionDefinition", "src": "42321:1866:126", "nodes": [], "body": { "id": 21631, "nodeType": "Block", "src": "42487:1700:126", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21537, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21534, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "42728:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21535, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "42736:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "42728:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "hexValue": "30", "id": 21536, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "42763:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "42728:36:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21543, "nodeType": "IfStatement", "src": "42724:84:126", "trueBody": { "id": 21542, "nodeType": "Block", "src": "42766:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21538, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "42788:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21539, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "42791:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21540, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "42787:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21533, "id": 21541, "nodeType": "Return", "src": "42780:17:126" }] } }, { "assignments": [21545], "declarations": [{ "constant": false, "id": 21545, "mutability": "mutable", "name": "netFlatTrade", "nameLocation": "42866:12:126", "nodeType": "VariableDeclaration", "scope": 21631, "src": "42859:19:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21544, "name": "int256", "nodeType": "ElementaryTypeName", "src": "42859:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 21550, "initialValue": { "arguments": [{ "expression": { "id": 21547, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "42903:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21548, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "42911:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "42903:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21546, "name": "calculateNetFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20910, "src": "42881:21:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20442_memory_ptr_$returns$_t_int256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256)" } }, "id": 21549, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "42881:49:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "42859:71:126" }, { "assignments": [21552], "declarations": [{ "constant": false, "id": 21552, "mutability": "mutable", "name": "rhs", "nameLocation": "43081:3:126", "nodeType": "VariableDeclaration", "scope": 21631, "src": "43073:11:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21551, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43073:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21564, "initialValue": { "arguments": [{ "expression": { "id": 21556, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43138:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21557, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43146:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "43138:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21562, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21558, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43179:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21559, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43187:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "43179:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21560, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43209:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21561, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43217:27:126", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20919, "src": "43209:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43179:65:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21553, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43087:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21554, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43095:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "43087:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21555, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "43116:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "43087:37:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21563, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43087:167:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "43073:181:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21567, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21565, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21545, "src": "43268:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21566, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "43284:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "43268:17:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21598, "nodeType": "Block", "src": "43621:54:126", "statements": [{ "expression": { "id": 21596, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21590, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "43635:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [{ "id": 21594, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "43650:13:126", "subExpression": { "id": 21593, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21545, "src": "43651:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21592, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43642:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21591, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43642:7:126", "typeDescriptions": {} } }, "id": 21595, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43642:22:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43635:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21597, "nodeType": "ExpressionStatement", "src": "43635:29:126" }] }, "id": 21599, "nodeType": "IfStatement", "src": "43264:411:126", "trueBody": { "id": 21589, "nodeType": "Block", "src": "43287:328:126", "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21573, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "id": 21570, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21545, "src": "43313:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21569, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43305:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21568, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43305:7:126", "typeDescriptions": {} } }, "id": 21571, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43305:21:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21572, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "43329:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43305:27:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21587, "nodeType": "Block", "src": "43451:154:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21583, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "43581:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21584, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "43584:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21585, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "43580:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21533, "id": 21586, "nodeType": "Return", "src": "43573:17:126" }] }, "id": 21588, "nodeType": "IfStatement", "src": "43301:304:126", "trueBody": { "id": 21582, "nodeType": "Block", "src": "43334:111:126", "statements": [{ "id": 21581, "nodeType": "UncheckedBlock", "src": "43352:79:126", "statements": [{ "expression": { "id": 21579, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21574, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "43384:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "arguments": [{ "id": 21577, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21545, "src": "43399:12:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21576, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43391:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21575, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43391:7:126", "typeDescriptions": {} } }, "id": 21578, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43391:21:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43384:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21580, "nodeType": "ExpressionStatement", "src": "43384:28:126" }] }] } }] } }, { "expression": { "id": 21611, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21600, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "43832:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21604, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "43890:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "expression": { "id": 21607, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43915:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21608, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43923:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "43915:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21606, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43907:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21605, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43907:7:126", "typeDescriptions": {} } }, "id": 21609, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43907:40:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21601, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "43838:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21602, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43846:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "43838:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21603, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "43868:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "43838:38:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21610, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43838:119:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43832:125:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21612, "nodeType": "ExpressionStatement", "src": "43832:125:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21616, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21613, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "44008:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21614, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "44016:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "44008:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21615, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "44040:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "44008:35:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21622, "nodeType": "IfStatement", "src": "44004:83:126", "trueBody": { "id": 21621, "nodeType": "Block", "src": "44045:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21617, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "44067:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21618, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "44070:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21619, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "44066:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21533, "id": 21620, "nodeType": "Return", "src": "44059:17:126" }] } }, { "id": 21630, "nodeType": "UncheckedBlock", "src": "44096:85:126", "statements": [{ "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21626, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21623, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21527, "src": "44128:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21624, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "44136:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "44128:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21625, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21552, "src": "44160:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "44128:35:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21627, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "44165:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21628, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "44127:43:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21533, "id": 21629, "nodeType": "Return", "src": "44120:50:126" }] }] }, "documentation": { "id": 21524, "nodeType": "StructuredDocumentation", "src": "40636:1680:126", "text": "@dev One of the edge cases that occurs when using Newton's method for\n      the share proceeds while distributing excess idle is when the net\n      curve trade is larger than the max bond amount. In this case, the\n      the present value simplifies to the following:\n      PV(dz) = (z - dz) + net_c(dz) + net_f - z_min\n             = (z - dz) - y_max_out(dz) + net_f - z_min\n      There are two cases to evaluate:\n      (1) zeta > 0:\n          z_max_out(dz) = ((z - dz) / z) * (z - zeta) - z_min\n          =>\n          PV(dz) = zeta * ((z - dz) / z) + net_f\n      (2) zeta <= 0:\n          z_max_out(dz) = (z - dz) - z_min\n          =>\n          PV(dz) = net_f\n      Since the present value is constant with respect to the share\n      proceeds in case 2, Newton's method has achieved a stationary point\n      and can't proceed. On the other hand, the present value is linear\n      with respect to the share proceeds, and we can solve for the next\n      step of Newton's method directly as follows:\n      PV(0) / l = PV(dz) / (l - w)\n      =>\n      dz = z - ((PV(0) / l) * (l - w) - net_f) / (zeta / z)\n      We round the share proceeds down to err on the side of the\n      withdrawal pool receiving slightly less shares.\n @param _params The parameters for the calculation.\n @return The share proceeds.\n @return A flag indicating whether the calculation was successful." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleShareProceedsNetLongEdgeCaseSafe", "nameLocation": "42330:61:126", "parameters": { "id": 21528, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21527, "mutability": "mutable", "name": "_params", "nameLocation": "42435:7:126", "nodeType": "VariableDeclaration", "scope": 21632, "src": "42401:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21526, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21525, "name": "DistributeExcessIdleParams", "nameLocations": ["42401:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "42401:26:126" }, "referencedDeclaration": 20930, "src": "42401:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "src": "42391:57:126" }, "returnParameters": { "id": 21533, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21530, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21632, "src": "42472:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21529, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "42472:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21532, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21632, "src": "42481:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21531, "name": "bool", "nodeType": "ElementaryTypeName", "src": "42481:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "42471:15:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21674, "nodeType": "FunctionDefinition", "src": "44905:1269:126", "nodes": [], "body": { "id": 21673, "nodeType": "Block", "src": "45115:1059:126", "nodes": [], "statements": [{ "expression": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21671, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21655, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21647, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21636, "src": "45422:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21648, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45430:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "45422:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21645, "name": "_presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21640, "src": "45400:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21646, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45414:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "45400:21:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21649, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45400:50:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "arguments": [{ "id": 21653, "name": "_lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21638, "src": "45567:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21650, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21636, "src": "45532:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21651, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45540:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "45532:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21652, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45561:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "45532:34:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21654, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45532:50:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "45400:182:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21670, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21658, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21636, "src": "45916:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21659, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45924:19:126", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 20917, "src": "45916:27:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21656, "name": "_presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21640, "src": "45896:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21657, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45910:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "45896:19:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21660, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45896:48:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "arguments": [{ "expression": { "id": 21666, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21636, "src": "46093:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21667, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "46101:20:126", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 20915, "src": "46093:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21668, "name": "_lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21638, "src": "46139:14:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21663, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "leftExpression": { "id": 21661, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "46029:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 21662, "name": "SHARE_PROCEEDS_MIN_TOLERANCE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20217, "src": "46035:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "46029:34:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21664, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "46028:36:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21665, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "46065:10:126", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18704, "src": "46028:47:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21669, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "46028:139:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "45896:271:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "45400:767:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "functionReturnParameters": 21644, "id": 21672, "nodeType": "Return", "src": "45125:1042:126" }] }, "documentation": { "id": 21633, "nodeType": "StructuredDocumentation", "src": "44193:707:126", "text": "@dev Checks to see if we should short-circuit the iterative calculation\n     of the share proceeds when distributing excess idle liquidity. This\n     verifies that the ending LP share price is greater than or equal to\n     the starting LP share price and less than or equal to the starting\n     LP share price plus the minimum tolerance.\n @param _params The parameters for the calculation.\n @param _lpTotalSupply The total supply of LP shares.\n @param _presentValue The present value of the pool at this iteration of\n        the calculation.\n @return A flag indicating whether or not we should short-circuit the\n         calculation." }, "implemented": true, "kind": "function", "modifiers": [], "name": "shouldShortCircuitDistributeExcessIdleShareProceeds", "nameLocation": "44914:51:126", "parameters": { "id": 21641, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21636, "mutability": "mutable", "name": "_params", "nameLocation": "45009:7:126", "nodeType": "VariableDeclaration", "scope": 21674, "src": "44975:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21635, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21634, "name": "DistributeExcessIdleParams", "nameLocations": ["44975:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "44975:26:126" }, "referencedDeclaration": 20930, "src": "44975:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21638, "mutability": "mutable", "name": "_lpTotalSupply", "nameLocation": "45034:14:126", "nodeType": "VariableDeclaration", "scope": 21674, "src": "45026:22:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21637, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "45026:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21640, "mutability": "mutable", "name": "_presentValue", "nameLocation": "45066:13:126", "nodeType": "VariableDeclaration", "scope": 21674, "src": "45058:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21639, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "45058:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "44965:120:126" }, "returnParameters": { "id": 21644, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21643, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21674, "src": "45109:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21642, "name": "bool", "nodeType": "ElementaryTypeName", "src": "45109:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "45108:6:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21792, "nodeType": "FunctionDefinition", "src": "46936:3239:126", "nodes": [], "body": { "id": 21791, "nodeType": "Block", "src": "47154:3021:126", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21690, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21687, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47304:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21688, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47312:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "47304:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21689, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "47329:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "47304:26:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21697, "nodeType": "IfStatement", "src": "47300:84:126", "trueBody": { "id": 21696, "nodeType": "Block", "src": "47332:52:126", "statements": [{ "expression": { "components": [{ "expression": { "id": 21691, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47354:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21692, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47362:4:126", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 20921, "src": "47354:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21693, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "47368:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21694, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "47353:20:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21686, "id": 21695, "nodeType": "Return", "src": "47346:27:126" }] } }, { "assignments": [21699], "declarations": [{ "constant": false, "id": 21699, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "47401:13:126", "nodeType": "VariableDeclaration", "scope": 21791, "src": "47393:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21698, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47393:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21706, "initialValue": { "arguments": [{ "id": 21704, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "47425:22:126", "subExpression": { "expression": { "id": 21702, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47426:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21703, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47434:13:126", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 20923, "src": "47426:21:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21701, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "47417:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21700, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47417:7:126", "typeDescriptions": {} } }, "id": 21705, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "47417:31:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "47393:55:126" }, { "assignments": [21708], "declarations": [{ "constant": false, "id": 21708, "mutability": "mutable", "name": "maxBondAmount", "nameLocation": "47705:13:126", "nodeType": "VariableDeclaration", "scope": 21791, "src": "47697:21:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21707, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47697:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21709, "nodeType": "VariableDeclarationStatement", "src": "47697:21:126" }, { "expression": { "id": 21730, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21710, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21708, "src": "47729:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21711, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21685, "src": "47744:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21712, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "47728:24:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21715, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21680, "src": "47811:31:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21716, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47856:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21717, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47864:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "47856:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21722, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21718, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "47898:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21719, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47904:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21720, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47912:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "47904:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21721, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47931:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "47904:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "47898:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21723, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "47956:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21724, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47964:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "47956:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21725, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47983:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "47956:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21726, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "48012:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21727, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "48020:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "48012:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21728, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "48039:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "48012:49:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21713, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "47755:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21714, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "47770:27:126", "memberName": "calculateMaxBuyBondsOutSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23092, "src": "47755:42:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21729, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "47755:316:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "47728:343:126", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21731, "nodeType": "ExpressionStatement", "src": "47728:343:126" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21737, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21733, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "48085:8:126", "subExpression": { "id": 21732, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21685, "src": "48086:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21736, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21734, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21708, "src": "48097:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21735, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "48114:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "48097:18:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "48085:30:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21743, "nodeType": "IfStatement", "src": "48081:78:126", "trueBody": { "id": 21742, "nodeType": "Block", "src": "48117:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21738, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "48139:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21739, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "48142:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21740, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "48138:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21686, "id": 21741, "nodeType": "Return", "src": "48131:17:126" }] } }, { "assignments": [21745], "declarations": [{ "constant": false, "id": 21745, "mutability": "mutable", "name": "maxScalingFactor", "nameLocation": "49190:16:126", "nodeType": "VariableDeclaration", "scope": 21791, "src": "49182:24:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21744, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "49182:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21750, "initialValue": { "arguments": [{ "id": 21748, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21708, "src": "49229:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21746, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21699, "src": "49209:13:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21747, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "49223:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "49209:19:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21749, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "49209:34:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "49182:61:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21753, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21751, "name": "maxScalingFactor", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21745, "src": "49426:16:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "id": 21752, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "49446:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49426:23:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21774, "nodeType": "Block", "src": "49698:177:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21770, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "49855:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21771, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "49858:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21772, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "49854:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21686, "id": 21773, "nodeType": "Return", "src": "49847:17:126" }] }, "id": 21775, "nodeType": "IfStatement", "src": "49422:453:126", "trueBody": { "id": 21769, "nodeType": "Block", "src": "49451:241:126", "statements": [{ "id": 21760, "nodeType": "UncheckedBlock", "src": "49465:89:126", "statements": [{ "expression": { "id": 21758, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21754, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21683, "src": "49493:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21757, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21755, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "49517:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21756, "name": "maxScalingFactor", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21745, "src": "49523:16:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49517:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49493:46:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21759, "nodeType": "ExpressionStatement", "src": "49493:46:126" }] }, { "expression": { "id": 21767, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21761, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21683, "src": "49567:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21764, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "49638:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21765, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "49646:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "49638:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21762, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21683, "src": "49591:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21763, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "49613:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "49591:29:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21766, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "49591:90:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49567:114:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21768, "nodeType": "ExpressionStatement", "src": "49567:114:126" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21779, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21776, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21683, "src": "50033:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "expression": { "id": 21777, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "50057:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21778, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "50065:4:126", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 20921, "src": "50057:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "50033:36:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21786, "nodeType": "IfStatement", "src": "50029:94:126", "trueBody": { "id": 21785, "nodeType": "Block", "src": "50071:52:126", "statements": [{ "expression": { "components": [{ "expression": { "id": 21780, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21678, "src": "50093:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21781, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "50101:4:126", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 20921, "src": "50093:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21782, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "50107:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21783, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "50092:20:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21686, "id": 21784, "nodeType": "Return", "src": "50085:27:126" }] } }, { "expression": { "components": [{ "id": 21787, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21683, "src": "50140:21:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21788, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "50163:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21789, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "50139:29:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21686, "id": 21790, "nodeType": "Return", "src": "50132:36:126" }] }, "documentation": { "id": 21675, "nodeType": "StructuredDocumentation", "src": "46180:751:126", "text": "@dev Calculates the upper bound on the share proceeds of distributing\n      excess idle. When the pool is net long or net neutral, the upper\n      bound is the amount of idle liquidity. When the pool is net short,\n      the upper bound is the share reserves delta that results in the\n      maximum amount of bonds that can be purchased being equal to the\n      net short position.\n @param _params The parameters for the distribute excess idle calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @return maxShareReservesDelta The upper bound on the share proceeds.\n @return success A flag indicating if the calculation succeeded." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateMaxShareReservesDeltaSafe", "nameLocation": "46945:34:126", "parameters": { "id": 21681, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21678, "mutability": "mutable", "name": "_params", "nameLocation": "47023:7:126", "nodeType": "VariableDeclaration", "scope": 21792, "src": "46989:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21677, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21676, "name": "DistributeExcessIdleParams", "nameLocations": ["46989:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "46989:26:126" }, "referencedDeclaration": 20930, "src": "46989:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21680, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "47048:31:126", "nodeType": "VariableDeclaration", "scope": 21792, "src": "47040:39:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21679, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47040:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "46979:106:126" }, "returnParameters": { "id": 21686, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21683, "mutability": "mutable", "name": "maxShareReservesDelta", "nameLocation": "47117:21:126", "nodeType": "VariableDeclaration", "scope": 21792, "src": "47109:29:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21682, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47109:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21685, "mutability": "mutable", "name": "success", "nameLocation": "47145:7:126", "nodeType": "VariableDeclaration", "scope": 21792, "src": "47140:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21684, "name": "bool", "nodeType": "ElementaryTypeName", "src": "47140:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "47108:45:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 22133, "nodeType": "FunctionDefinition", "src": "52581:5799:126", "nodes": [], "body": { "id": 22132, "nodeType": "Block", "src": "52812:5568:126", "nodes": [], "statements": [{ "assignments": [21808], "declarations": [{ "constant": false, "id": 21808, "mutability": "mutable", "name": "bondReserves", "nameLocation": "52903:12:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "52895:20:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21807, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52895:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21809, "nodeType": "VariableDeclarationStatement", "src": "52895:20:126" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21812, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21810, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21800, "src": "52929:11:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21811, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "52944:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "52929:16:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21854, "nodeType": "Block", "src": "53087:508:126", "statements": [{ "assignments": [21826], "declarations": [{ "constant": false, "id": 21826, "mutability": "mutable", "name": "bondAmount", "nameLocation": "53109:10:126", "nodeType": "VariableDeclaration", "scope": 21854, "src": "53101:18:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21825, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53101:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21832, "initialValue": { "arguments": [{ "id": 21830, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "53130:12:126", "subExpression": { "id": 21829, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21800, "src": "53131:11:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21828, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "53122:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21827, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53122:7:126", "typeDescriptions": {} } }, "id": 21831, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53122:21:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "53101:42:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21837, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21833, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21826, "src": "53161:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "expression": { "id": 21834, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "53174:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21835, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53182:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "53174:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21836, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53201:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "53174:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53161:52:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21852, "nodeType": "Block", "src": "53419:166:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21848, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "53561:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21849, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "53564:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21850, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "53560:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 21851, "nodeType": "Return", "src": "53553:17:126" }] }, "id": 21853, "nodeType": "IfStatement", "src": "53157:428:126", "trueBody": { "id": 21847, "nodeType": "Block", "src": "53215:198:126", "statements": [{ "id": 21846, "nodeType": "UncheckedBlock", "src": "53233:166:126", "statements": [{ "expression": { "id": 21844, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21838, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "53265:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21843, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "expression": { "id": 21839, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "53304:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21840, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53312:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "53304:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21841, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53331:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "53304:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21842, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21826, "src": "53370:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53304:76:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53265:115:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21845, "nodeType": "ExpressionStatement", "src": "53265:115:126" }] }] } }] }, "id": 21855, "nodeType": "IfStatement", "src": "52925:670:126", "trueBody": { "id": 21824, "nodeType": "Block", "src": "52947:134:126", "statements": [{ "expression": { "id": 21822, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21813, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "52961:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21821, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "expression": { "id": 21814, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "52992:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21815, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53000:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "52992:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21816, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53019:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "52992:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 21819, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21800, "src": "53058:11:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21818, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "53050:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21817, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53050:7:126", "typeDescriptions": {} } }, "id": 21820, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53050:20:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "52992:78:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "52961:109:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21823, "nodeType": "ExpressionStatement", "src": "52961:109:126" }] } }, { "assignments": [21857, 21859], "declarations": [{ "constant": false, "id": 21857, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "53863:22:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "53855:30:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21856, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53855:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21859, "mutability": "mutable", "name": "success", "nameLocation": "53892:7:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "53887:12:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21858, "name": "bool", "nodeType": "ElementaryTypeName", "src": "53887:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21869, "initialValue": { "arguments": [{ "expression": { "expression": { "id": 21862, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "53984:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21863, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53992:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "53984:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21864, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54011:13:126", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20419, "src": "53984:40:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21865, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54042:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21866, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54050:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54042:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21867, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54069:15:126", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20421, "src": "54042:42:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 21860, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20190, "src": "53903:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20190_$", "typeString": "type(library HyperdriveMath)" } }, "id": 21861, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "53931:35:126", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19670, "src": "53903:63:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 21868, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53903:195:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "53854:244:126" }, { "condition": { "id": 21871, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "54112:8:126", "subExpression": { "id": 21870, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21859, "src": "54113:7:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21877, "nodeType": "IfStatement", "src": "54108:56:126", "trueBody": { "id": 21876, "nodeType": "Block", "src": "54122:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21872, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "54144:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21873, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "54147:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21874, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "54143:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 21875, "nodeType": "Return", "src": "54136:17:126" }] } }, { "assignments": [21879], "declarations": [{ "constant": false, "id": 21879, "mutability": "mutable", "name": "derivative", "nameLocation": "54181:10:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "54173:18:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21878, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "54173:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21912, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21911, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 21891, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54410:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21892, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54418:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54410:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21893, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54437:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "54410:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21888, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21857, "src": "54365:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 21884, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54256:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21885, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54281:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54256:43:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21886, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54317:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "54256:83:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21887, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54357:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "54256:108:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21889, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54256:132:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21890, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54406:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "54256:153:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21894, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54256:193:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 21880, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54194:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21881, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54202:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54194:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21882, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54221:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "54194:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21883, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54237:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "54194:48:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21895, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54194:265:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 21905, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54656:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21906, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54664:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54656:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21907, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54683:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "54656:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 21901, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54587:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21902, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54595:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54587:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21903, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54614:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "54587:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21904, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54627:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "54587:43:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21908, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54587:129:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21899, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21798, "src": "54526:31:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21900, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54558:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "54526:39:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21909, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54526:208:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21896, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54474:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21897, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54482:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "54474:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21898, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54503:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "54474:34:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21910, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54474:274:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "54194:554:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "54173:575:126" }, { "assignments": [21914], "declarations": [{ "constant": false, "id": 21914, "mutability": "mutable", "name": "rhs", "nameLocation": "54826:3:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "54818:11:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21913, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "54818:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21928, "initialValue": { "arguments": [{ "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 21922, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54954:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21923, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54962:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "54954:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21924, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54981:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "54954:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21920, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "54937:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21921, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54950:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "54937:16:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21925, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54937:56:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21918, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21798, "src": "54882:31:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21919, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54914:5:126", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18772, "src": "54882:37:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21926, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54882:125:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21915, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "54832:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21916, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54840:20:126", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20929, "src": "54832:28:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21917, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54861:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "54832:36:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21927, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54832:185:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "54818:199:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21931, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21929, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "55031:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21930, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "55044:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55031:16:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21937, "nodeType": "IfStatement", "src": "55027:64:126", "trueBody": { "id": 21936, "nodeType": "Block", "src": "55049:42:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21932, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "55071:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21933, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "55074:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21934, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "55070:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 21935, "nodeType": "Return", "src": "55063:17:126" }] } }, { "id": 21942, "nodeType": "UncheckedBlock", "src": "55100:52:126", "statements": [{ "expression": { "id": 21940, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21938, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "55124:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "id": 21939, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "55138:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55124:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21941, "nodeType": "ExpressionStatement", "src": "55124:17:126" }] }, { "assignments": [21944], "declarations": [{ "constant": false, "id": 21944, "mutability": "mutable", "name": "k", "nameLocation": "55389:1:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "55381:9:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21943, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "55381:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21963, "initialValue": { "arguments": [{ "id": 21947, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21857, "src": "55425:22:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21948, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "55461:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21949, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55469:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "55461:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21950, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55488:12:126", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20423, "src": "55461:39:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21955, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21951, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "55514:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21952, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "55520:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21953, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55528:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "55520:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21954, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55547:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "55520:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55514:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21956, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "55572:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21957, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55580:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "55572:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21958, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55599:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "55572:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21959, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "55628:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21960, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55636:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "55628:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21961, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55655:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "55628:49:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21945, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23292, "src": "55393:14:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23292_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21946, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "55408:3:126", "memberName": "kUp", "nodeType": "MemberAccess", "referencedDeclaration": 23257, "src": "55393:18:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21962, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "55393:294:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "55381:306:126" }, { "assignments": [21965], "declarations": [{ "constant": false, "id": 21965, "mutability": "mutable", "name": "inner", "nameLocation": "55705:5:126", "nodeType": "VariableDeclaration", "scope": 22132, "src": "55697:13:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21964, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "55697:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21974, "initialValue": { "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21972, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21968, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "55743:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21969, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "55749:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21970, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55757:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "55749:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21971, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55776:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "55749:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55743:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21966, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "55713:12:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21967, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "55726:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "55713:16:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21973, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "55713:84:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "55697:100:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21977, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21975, "name": "k", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21944, "src": "55811:1:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21976, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "55815:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55811:9:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21983, "nodeType": "IfStatement", "src": "55807:201:126", "trueBody": { "id": 21982, "nodeType": "Block", "src": "55822:186:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21978, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "55988:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21979, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "55991:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21980, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "55987:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 21981, "nodeType": "Return", "src": "55980:17:126" }] } }, { "id": 21990, "nodeType": "UncheckedBlock", "src": "56017:52:126", "statements": [{ "expression": { "id": 21988, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21984, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56041:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21987, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21985, "name": "k", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21944, "src": "56049:1:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21986, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56053:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56049:9:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56041:17:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21989, "nodeType": "ExpressionStatement", "src": "56041:17:126" }] }, { "expression": { "id": 22001, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21991, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56078:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 21994, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56114:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21995, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56122:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56114:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21996, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56141:22:126", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20427, "src": "56114:49:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21997, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56177:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21998, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56185:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56177:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21999, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56204:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "56177:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21992, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56086:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21993, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56092:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "56086:14:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 22000, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56086:143:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56078:151:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22002, "nodeType": "ExpressionStatement", "src": "56078:151:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22005, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22003, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56243:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 22004, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "56252:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56243:12:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22039, "nodeType": "Block", "src": "56541:282:126", "statements": [{ "expression": { "id": 22037, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22023, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56633:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22034, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22030, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "56736:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22031, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56742:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22032, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56750:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56742:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22033, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56769:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "56742:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56736:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22026, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56668:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22027, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56676:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56668:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22028, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56695:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "56668:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22029, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56707:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "56668:46:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22035, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56668:130:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22024, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56641:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22025, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56647:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "56641:9:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22036, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56641:171:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56633:179:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22038, "nodeType": "ExpressionStatement", "src": "56633:179:126" }] }, "id": 22040, "nodeType": "IfStatement", "src": "56239:584:126", "trueBody": { "id": 22022, "nodeType": "Block", "src": "56257:278:126", "statements": [{ "expression": { "id": 22020, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22006, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56347:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22017, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22013, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "56448:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22014, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56454:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22015, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56462:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56454:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22016, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56481:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "56454:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56448:44:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22009, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56382:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22010, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56390:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56382:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22011, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56409:11:126", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20433, "src": "56382:38:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22012, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56421:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "56382:44:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22018, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56382:128:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22007, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56355:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22008, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56361:3:126", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18847, "src": "56355:9:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22019, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56355:169:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56347:177:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22021, "nodeType": "ExpressionStatement", "src": "56347:177:126" }] } }, { "expression": { "id": 22049, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22041, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "56910:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 22044, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21965, "src": "56956:5:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22045, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "56975:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22046, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56983:18:126", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 20913, "src": "56975:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20442_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22047, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57002:15:126", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20425, "src": "56975:42:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22042, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "56923:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22043, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56934:8:126", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18754, "src": "56923:19:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 22048, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56923:104:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56910:117:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22050, "nodeType": "ExpressionStatement", "src": "56910:117:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22053, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22051, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "57081:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "id": 22052, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "57087:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57081:16:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22066, "nodeType": "Block", "src": "57201:274:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22062, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57456:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 22063, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "57459:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 22064, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "57455:9:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 22065, "nodeType": "Return", "src": "57448:16:126" }] }, "id": 22067, "nodeType": "IfStatement", "src": "57077:398:126", "trueBody": { "id": 22061, "nodeType": "Block", "src": "57099:96:126", "statements": [{ "id": 22060, "nodeType": "UncheckedBlock", "src": "57113:72:126", "statements": [{ "expression": { "id": 22058, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22054, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "57141:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22057, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22055, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "57154:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 22056, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "57160:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57154:16:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57141:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22059, "nodeType": "ExpressionStatement", "src": "57141:29:126" }] }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 22071, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 22068, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "57614:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22069, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57622:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "57614:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 22070, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57649:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "57614:36:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22126, "nodeType": "Block", "src": "58098:240:126", "statements": [{ "expression": { "id": 22124, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22108, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "58112:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22122, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22111, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "58161:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "expression": { "id": 22119, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "58262:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22120, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "58270:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "58262:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 22116, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "58195:32:126", "subExpression": { "expression": { "id": 22114, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "58196:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22115, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "58204:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "58196:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 22113, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "58187:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 22112, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "58187:7:126", "typeDescriptions": {} } }, "id": 22117, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58187:41:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22118, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58229:7:126", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18740, "src": "58187:49:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22121, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58187:126:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58161:152:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22109, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "58125:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22110, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58136:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "58125:18:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22123, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58125:202:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58112:215:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22125, "nodeType": "ExpressionStatement", "src": "58112:215:126" }] }, "id": 22127, "nodeType": "IfStatement", "src": "57610:728:126", "trueBody": { "id": 22107, "nodeType": "Block", "src": "57652:440:126", "statements": [{ "expression": { "id": 22082, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22072, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "57666:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 22079, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "57736:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22080, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57744:21:126", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20925, "src": "57736:29:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "expression": { "id": 22075, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21796, "src": "57680:7:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22076, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57688:23:126", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20927, "src": "57680:31:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 22074, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "57672:7:126", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 22073, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "57672:7:126", "typeDescriptions": {} } }, "id": 22077, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "57672:40:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22078, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "57713:5:126", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18790, "src": "57672:46:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22081, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "57672:107:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57666:113:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22083, "nodeType": "ExpressionStatement", "src": "57666:113:126" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22086, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22084, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "57797:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 22085, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "57804:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57797:10:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 22092, "nodeType": "IfStatement", "src": "57793:168:126", "trueBody": { "id": 22091, "nodeType": "Block", "src": "57809:152:126", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22087, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57937:1:126", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 22088, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "57940:5:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 22089, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "57936:10:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21806, "id": 22090, "nodeType": "Return", "src": "57929:17:126" }] } }, { "id": 22099, "nodeType": "UncheckedBlock", "src": "57974:58:126", "statements": [{ "expression": { "id": 22097, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22093, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "58002:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22096, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22094, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18676, "src": "58008:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 22095, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "58014:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58008:9:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58002:15:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22098, "nodeType": "ExpressionStatement", "src": "58002:15:126" }] }, { "expression": { "id": 22105, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22100, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "58045:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 22103, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21914, "src": "58077:3:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22101, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "58058:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22102, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58069:7:126", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18722, "src": "58058:18:126", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22104, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58058:23:126", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58045:36:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22106, "nodeType": "ExpressionStatement", "src": "58045:36:126" }] } }, { "expression": { "components": [{ "id": 22128, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21879, "src": "58356:10:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 22129, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "58368:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 22130, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "58355:18:126", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21806, "id": 22131, "nodeType": "Return", "src": "58348:25:126" }] }, "documentation": { "id": 21793, "nodeType": "StructuredDocumentation", "src": "50181:2395:126", "text": "@dev Given a signed bond amount, this function calculates the negation\n      of the derivative of `calculateSharesOutGivenBondsIn` when the\n      bond amount is positive or the derivative of\n      `calculateSharesInGivenBondsOut` when the bond amount is negative.\n      In both cases, the calculation is given by:\n      derivative = (1 - zeta / z) * (\n          1 - (1 / c) * (\n              c * (mu * z_e(x)) ** -t_s +\n              (y / z_e) * y(x) ** -t_s  -\n              (y / z_e) * (y(x) + dy) ** -t_s\n          ) * (\n              (mu / c) * (k(x) - (y(x) + dy) ** (1 - t_s))\n          ) ** (t_s / (1 - t_s))\n      )\n      This quantity is used in Newton's method to search for the optimal\n      share proceeds. When the pool is net long, We can express the\n      derivative of the objective function F(x) by the derivative\n      -z_out'(x) that this function returns:\n      -F'(x) = l * -PV'(x)\n             = l * (1 - net_c'(x))\n             = l * (1 + z_out'(x))\n             = l * (1 - derivative)\n      When the pool is net short, we can express the derivative of the\n      objective function F(x) by the derivative z_in'(x) that this\n      function returns:\n      -F'(x) = l * -PV'(x)\n             = l * (1 - net_c'(x))\n             = l * (1 - z_in'(x))\n             = l * (1 - derivative)\n      With these calculations in mind, this function rounds its result\n      down so that F'(x) is overestimated. Since F'(x) is in the\n      denominator of Newton's method, overestimating F'(x) helps to avoid\n      overshooting the optimal solution.\n @param _params The parameters for the calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @param _bondAmount The amount of bonds that are being bought or sold.\n @return The negation of the derivative of\n         `calculateSharesOutGivenBondsIn` when the bond amount is\n         positive or the derivative of `calculateSharesInGivenBondsOut`\n         when the bond amount is negative.\n @return A flag indicating whether the derivative could be computed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateSharesDeltaGivenBondsDeltaDerivativeSafe", "nameLocation": "52590:49:126", "parameters": { "id": 21801, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21796, "mutability": "mutable", "name": "_params", "nameLocation": "52683:7:126", "nodeType": "VariableDeclaration", "scope": 22133, "src": "52649:41:126", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21795, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21794, "name": "DistributeExcessIdleParams", "nameLocations": ["52649:26:126"], "nodeType": "IdentifierPath", "referencedDeclaration": 20930, "src": "52649:26:126" }, "referencedDeclaration": 20930, "src": "52649:26:126", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$20930_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21798, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "52708:31:126", "nodeType": "VariableDeclaration", "scope": 22133, "src": "52700:39:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21797, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52700:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21800, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "52756:11:126", "nodeType": "VariableDeclaration", "scope": 22133, "src": "52749:18:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21799, "name": "int256", "nodeType": "ElementaryTypeName", "src": "52749:6:126", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "52639:134:126" }, "returnParameters": { "id": 21806, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21803, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 22133, "src": "52797:7:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21802, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52797:7:126", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21805, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 22133, "src": "52806:4:126", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21804, "name": "bool", "nodeType": "ElementaryTypeName", "src": "52806:4:126", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "52796:15:126" }, "scope": 22134, "stateMutability": "pure", "virtual": false, "visibility": "internal" }], "abstract": false, "baseContracts": [], "canonicalName": "LPMath", "contractDependencies": [], "contractKind": "library", "documentation": { "id": 20204, "nodeType": "StructuredDocumentation", "src": "339:306:126", "text": "@author DELV\n @title LPMath\n @notice Math for the Hyperdrive LP system.\n @custom:disclaimer The language used in this code is for coding convenience\n                    only, and is not intended to, and does not, have any\n                    particular legal or regulatory significance." }, "fullyImplemented": true, "linearizedBaseContracts": [22134], "name": "LPMath", "nameLocation": "653:6:126", "scope": 22135, "usedErrors": [], "usedEvents": [] }], "license": "Apache-2.0" }, "id": 126 };

export const LPMath = { "abi": [], "bytecode": { "object": "0x60566037600b82828239805160001a607314602a57634e487b7160e01b600052600060045260246000fd5b30600052607381538281f3fe73000000000000000000000000000000000000000030146080604052600080fdfea2646970667358221220baeab4aa0b89fa04b101d9731cc3ddf714b0649d3dc9e78d141762ab1ca9262a64736f6c63430008140033", "sourceMap": "645:57737:130:-:0;;;;;;;;;;;;;;;-1:-1:-1;;;645:57737:130;;;;;;;;;;;;;;;;;", "linkReferences": {} }, "deployedBytecode": { "object": "0x73000000000000000000000000000000000000000030146080604052600080fdfea2646970667358221220baeab4aa0b89fa04b101d9731cc3ddf714b0649d3dc9e78d141762ab1ca9262a64736f6c63430008140033", "sourceMap": "645:57737:130:-:0;;;;;;;;", "linkReferences": {} }, "methodIdentifiers": {}, "rawMetadata": "{\"compiler\":{\"version\":\"0.8.20+commit.a1b79de6\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"author\":\"DELV\",\"custom:disclaimer\":\"The language used in this code is for coding convenience                    only, and is not intended to, and does not, have any                    particular legal or regulatory significance.\",\"kind\":\"dev\",\"methods\":{},\"stateVariables\":{\"SHARE_PROCEEDS_MAX_ITERATIONS\":{\"details\":\"The maximum number of iterations for the share proceeds calculation.\"},\"SHARE_PROCEEDS_MIN_TOLERANCE\":{\"details\":\"The minimum tolerance for the share proceeds calculation to      short-circuit.\"}},\"title\":\"LPMath\",\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"notice\":\"Math for the Hyperdrive LP system.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/src/libraries/LPMath.sol\":\"LPMath\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":aave-v3-core/=lib/aave-v3-core/\",\":ds-test/=lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":openzeppelin/=lib/openzeppelin-contracts/contracts/\",\":solmate/=lib/solmate/src/\"]},\"sources\":{\"contracts/src/interfaces/IERC20.sol\":{\"keccak256\":\"0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac\",\"dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p\"]},\"contracts/src/interfaces/IHyperdrive.sol\":{\"keccak256\":\"0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf\",\"dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK\"]},\"contracts/src/interfaces/IHyperdriveCore.sol\":{\"keccak256\":\"0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24\",\"dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h\"]},\"contracts/src/interfaces/IHyperdriveEvents.sol\":{\"keccak256\":\"0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c\",\"dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG\"]},\"contracts/src/interfaces/IHyperdriveRead.sol\":{\"keccak256\":\"0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf\",\"dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6\"]},\"contracts/src/interfaces/IMultiToken.sol\":{\"keccak256\":\"0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7\",\"dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp\"]},\"contracts/src/interfaces/IMultiTokenCore.sol\":{\"keccak256\":\"0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae\",\"dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs\"]},\"contracts/src/interfaces/IMultiTokenEvents.sol\":{\"keccak256\":\"0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222\",\"dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK\"]},\"contracts/src/interfaces/IMultiTokenMetadata.sol\":{\"keccak256\":\"0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3\",\"dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG\"]},\"contracts/src/interfaces/IMultiTokenRead.sol\":{\"keccak256\":\"0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11\",\"dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR\"]},\"contracts/src/libraries/Errors.sol\":{\"keccak256\":\"0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88\",\"dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41\"]},\"contracts/src/libraries/FixedPointMath.sol\":{\"keccak256\":\"0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd\",\"dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L\"]},\"contracts/src/libraries/HyperdriveMath.sol\":{\"keccak256\":\"0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002\",\"dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY\"]},\"contracts/src/libraries/LPMath.sol\":{\"keccak256\":\"0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f\",\"dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ\"]},\"contracts/src/libraries/SafeCast.sol\":{\"keccak256\":\"0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8\",\"dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8\"]},\"contracts/src/libraries/YieldSpaceMath.sol\":{\"keccak256\":\"0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c\",\"dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy\"]}},\"version\":1}", "metadata": { "compiler": { "version": "0.8.20+commit.a1b79de6" }, "language": "Solidity", "output": { "abi": [], "devdoc": { "kind": "dev", "methods": {}, "version": 1 }, "userdoc": { "kind": "user", "methods": {}, "version": 1 } }, "settings": { "remappings": ["@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/", "aave-v3-core/=lib/aave-v3-core/", "ds-test/=lib/forge-std/lib/ds-test/src/", "erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/", "forge-std/=lib/forge-std/src/", "openzeppelin-contracts/=lib/openzeppelin-contracts/", "openzeppelin/=lib/openzeppelin-contracts/contracts/", "solmate/=lib/solmate/src/"], "optimizer": { "enabled": true, "runs": 200 }, "metadata": { "bytecodeHash": "ipfs" }, "compilationTarget": { "contracts/src/libraries/LPMath.sol": "LPMath" }, "libraries": {} }, "sources": { "contracts/src/interfaces/IERC20.sol": { "keccak256": "0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9", "urls": ["bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac", "dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdrive.sol": { "keccak256": "0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952", "urls": ["bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf", "dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveCore.sol": { "keccak256": "0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e", "urls": ["bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24", "dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveEvents.sol": { "keccak256": "0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0", "urls": ["bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c", "dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveRead.sol": { "keccak256": "0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55", "urls": ["bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf", "dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiToken.sol": { "keccak256": "0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f", "urls": ["bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7", "dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenCore.sol": { "keccak256": "0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501", "urls": ["bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae", "dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenEvents.sol": { "keccak256": "0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb", "urls": ["bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222", "dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenMetadata.sol": { "keccak256": "0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca", "urls": ["bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3", "dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenRead.sol": { "keccak256": "0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0", "urls": ["bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11", "dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR"], "license": "Apache-2.0" }, "contracts/src/libraries/Errors.sol": { "keccak256": "0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0", "urls": ["bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88", "dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41"], "license": "Apache-2.0" }, "contracts/src/libraries/FixedPointMath.sol": { "keccak256": "0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076", "urls": ["bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd", "dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L"], "license": "Apache-2.0" }, "contracts/src/libraries/HyperdriveMath.sol": { "keccak256": "0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab", "urls": ["bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002", "dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY"], "license": "Apache-2.0" }, "contracts/src/libraries/LPMath.sol": { "keccak256": "0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067", "urls": ["bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f", "dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ"], "license": "Apache-2.0" }, "contracts/src/libraries/SafeCast.sol": { "keccak256": "0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148", "urls": ["bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8", "dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8"], "license": "Apache-2.0" }, "contracts/src/libraries/YieldSpaceMath.sol": { "keccak256": "0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891", "urls": ["bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c", "dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy"], "license": "Apache-2.0" } }, "version": 1 }, "ast": { "absolutePath": "contracts/src/libraries/LPMath.sol", "id": 22265, "exportedSymbols": { "FixedPointMath": [19572], "HyperdriveMath": [20320], "IHyperdrive": [11143], "LPMath": [22264], "ONE": [18806], "SafeCast": [22443], "YieldSpaceMath": [23422] }, "nodeType": "SourceUnit", "src": "39:58344:130", "nodes": [{ "id": 20322, "nodeType": "PragmaDirective", "src": "39:23:130", "nodes": [], "literals": ["solidity", "0.8", ".20"] }, { "id": 20324, "nodeType": "ImportDirective", "src": "64:60:130", "nodes": [], "absolutePath": "contracts/src/interfaces/IHyperdrive.sol", "file": "../interfaces/IHyperdrive.sol", "nameLocation": "-1:-1:-1", "scope": 22265, "sourceUnit": 11144, "symbolAliases": [{ "foreign": { "id": 20323, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "73:11:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20327, "nodeType": "ImportDirective", "src": "125:59:130", "nodes": [], "absolutePath": "contracts/src/libraries/FixedPointMath.sol", "file": "./FixedPointMath.sol", "nameLocation": "-1:-1:-1", "scope": 22265, "sourceUnit": 19573, "symbolAliases": [{ "foreign": { "id": 20325, "name": "FixedPointMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 19572, "src": "134:14:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }, { "foreign": { "id": 20326, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "150:3:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20329, "nodeType": "ImportDirective", "src": "185:54:130", "nodes": [], "absolutePath": "contracts/src/libraries/HyperdriveMath.sol", "file": "./HyperdriveMath.sol", "nameLocation": "-1:-1:-1", "scope": 22265, "sourceUnit": 20321, "symbolAliases": [{ "foreign": { "id": 20328, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "194:14:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20331, "nodeType": "ImportDirective", "src": "240:42:130", "nodes": [], "absolutePath": "contracts/src/libraries/SafeCast.sol", "file": "./SafeCast.sol", "nameLocation": "-1:-1:-1", "scope": 22265, "sourceUnit": 22444, "symbolAliases": [{ "foreign": { "id": 20330, "name": "SafeCast", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22443, "src": "249:8:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 20333, "nodeType": "ImportDirective", "src": "283:54:130", "nodes": [], "absolutePath": "contracts/src/libraries/YieldSpaceMath.sol", "file": "./YieldSpaceMath.sol", "nameLocation": "-1:-1:-1", "scope": 22265, "sourceUnit": 23423, "symbolAliases": [{ "foreign": { "id": 20332, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "292:14:130", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 22264, "nodeType": "ContractDefinition", "src": "645:57737:130", "nodes": [{ "id": 20336, "nodeType": "UsingForDirective", "src": "666:27:130", "nodes": [], "global": false, "libraryName": { "id": 20335, "name": "FixedPointMath", "nameLocations": ["672:14:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 19572, "src": "672:14:130" } }, { "id": 20339, "nodeType": "UsingForDirective", "src": "698:27:130", "nodes": [], "global": false, "libraryName": { "id": 20337, "name": "SafeCast", "nameLocations": ["704:8:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 22443, "src": "704:8:130" }, "typeName": { "id": 20338, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "717:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } } }, { "id": 20343, "nodeType": "VariableDeclaration", "src": "813:59:130", "nodes": [], "constant": true, "documentation": { "id": 20340, "nodeType": "StructuredDocumentation", "src": "731:77:130", "text": "@dev The maximum number of iterations for the share proceeds calculation." }, "mutability": "constant", "name": "SHARE_PROCEEDS_MAX_ITERATIONS", "nameLocation": "839:29:130", "scope": 22264, "stateVariable": true, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20341, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "813:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "value": { "hexValue": "34", "id": 20342, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "871:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_4_by_1", "typeString": "int_const 4" }, "value": "4" }, "visibility": "internal" }, { "id": 20347, "nodeType": "VariableDeclaration", "src": "980:60:130", "nodes": [], "constant": true, "documentation": { "id": 20344, "nodeType": "StructuredDocumentation", "src": "879:96:130", "text": "@dev The minimum tolerance for the share proceeds calculation to\n      short-circuit." }, "mutability": "constant", "name": "SHARE_PROCEEDS_MIN_TOLERANCE", "nameLocation": "1006:28:130", "scope": 22264, "stateVariable": true, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20345, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "980:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "value": { "hexValue": "316539", "id": 20346, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "1037:3:130", "typeDescriptions": { "typeIdentifier": "t_rational_1000000000_by_1", "typeString": "int_const 1000000000" }, "value": "1e9" }, "visibility": "internal" }, { "id": 20394, "nodeType": "FunctionDefinition", "src": "1782:813:130", "nodes": [], "body": { "id": 20393, "nodeType": "Block", "src": "2159:436:130", "nodes": [], "statements": [{ "assignments": [20368], "declarations": [{ "constant": false, "id": 20368, "mutability": "mutable", "name": "success", "nameLocation": "2174:7:130", "nodeType": "VariableDeclaration", "scope": 20393, "src": "2169:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20367, "name": "bool", "nodeType": "ElementaryTypeName", "src": "2169:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20369, "nodeType": "VariableDeclarationStatement", "src": "2169:12:130" }, { "expression": { "id": 20382, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20370, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20361, "src": "2205:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20371, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20363, "src": "2232:15:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20372, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20365, "src": "2261:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20373, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20368, "src": "2287:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20374, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "2191:113:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20376, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20350, "src": "2349:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20377, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20352, "src": "2377:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20378, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20354, "src": "2407:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20379, "name": "_minimumShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20356, "src": "2434:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20380, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20358, "src": "2469:19:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20375, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20547, "src": "2307:28:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 20381, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2307:191:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "2191:307:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20383, "nodeType": "ExpressionStatement", "src": "2191:307:130" }, { "condition": { "id": 20385, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "2512:8:130", "subExpression": { "id": 20384, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20368, "src": "2513:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20392, "nodeType": "IfStatement", "src": "2508:81:130", "trueBody": { "id": 20391, "nodeType": "Block", "src": "2522:67:130", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20386, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "2543:11:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 20388, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2555:21:130", "memberName": "UpdateLiquidityFailed", "nodeType": "MemberAccess", "referencedDeclaration": 11112, "src": "2543:33:130", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 20389, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2543:35:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20390, "nodeType": "RevertStatement", "src": "2536:42:130" }] } }] }, "documentation": { "id": 20348, "nodeType": "StructuredDocumentation", "src": "1047:730:130", "text": "@dev Calculates the new share reserves, share adjustment, and bond\n      reserves after liquidity is added or removed from the pool. This\n      update is made in such a way that the pool's spot price remains\n      constant.\n @param _shareReserves The current share reserves.\n @param _shareAdjustment The current share adjustment.\n @param _bondReserves The current bond reserves.\n @param _minimumShareReserves The minimum share reserves.\n @param _shareReservesDelta The change in share reserves.\n @return shareReserves The updated share reserves.\n @return shareAdjustment The updated share adjustment.\n @return bondReserves The updated bond reserves." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateUpdateLiquidity", "nameLocation": "1791:24:130", "parameters": { "id": 20359, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20350, "mutability": "mutable", "name": "_shareReserves", "nameLocation": "1833:14:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "1825:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20349, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1825:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20352, "mutability": "mutable", "name": "_shareAdjustment", "nameLocation": "1864:16:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "1857:23:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20351, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1857:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20354, "mutability": "mutable", "name": "_bondReserves", "nameLocation": "1898:13:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "1890:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20353, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1890:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20356, "mutability": "mutable", "name": "_minimumShareReserves", "nameLocation": "1929:21:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "1921:29:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20355, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1921:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20358, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "1967:19:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "1960:26:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20357, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1960:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "1815:177:130" }, "returnParameters": { "id": 20366, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20361, "mutability": "mutable", "name": "shareReserves", "nameLocation": "2061:13:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "2053:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20360, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2053:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20363, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "2095:15:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "2088:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20362, "name": "int256", "nodeType": "ElementaryTypeName", "src": "2088:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20365, "mutability": "mutable", "name": "bondReserves", "nameLocation": "2132:12:130", "nodeType": "VariableDeclaration", "scope": 20394, "src": "2124:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20364, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2124:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "2039:115:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20547, "nodeType": "FunctionDefinition", "src": "3400:3557:130", "nodes": [], "body": { "id": 20546, "nodeType": "Block", "src": "3799:3158:130", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20418, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20416, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20405, "src": "3919:19:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 20417, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "3942:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "3919:24:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20426, "nodeType": "IfStatement", "src": "3915:117:130", "trueBody": { "id": 20425, "nodeType": "Block", "src": "3945:87:130", "statements": [{ "expression": { "components": [{ "id": 20419, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20397, "src": "3967:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20420, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20399, "src": "3983:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20421, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20401, "src": "4001:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20422, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "4016:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20423, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "3966:55:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "functionReturnParameters": 20415, "id": 20424, "nodeType": "Return", "src": "3959:62:130" }] } }, { "assignments": [20428], "declarations": [{ "constant": false, "id": 20428, "mutability": "mutable", "name": "shareReserves_", "nameLocation": "4208:14:130", "nodeType": "VariableDeclaration", "scope": 20546, "src": "4201:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20427, "name": "int256", "nodeType": "ElementaryTypeName", "src": "4201:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20434, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20433, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20429, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20397, "src": "4225:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20430, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "4240:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "4225:23:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20431, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4225:25:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 20432, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20405, "src": "4253:19:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "4225:47:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "4201:71:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20439, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20435, "name": "shareReserves_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20428, "src": "4286:14:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20436, "name": "_minimumShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20403, "src": "4303:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20437, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "4325:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "4303:30:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20438, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4303:32:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "4286:49:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20447, "nodeType": "IfStatement", "src": "4282:103:130", "trueBody": { "id": 20446, "nodeType": "Block", "src": "4337:48:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20440, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4359:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20441, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4362:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20442, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "4365:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20443, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "4368:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20444, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "4358:16:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20415, "id": 20445, "nodeType": "Return", "src": "4351:23:130" }] } }, { "expression": { "id": 20453, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20448, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20408, "src": "4394:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20451, "name": "shareReserves_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20428, "src": "4418:14:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20450, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "4410:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20449, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4410:7:130", "typeDescriptions": {} } }, "id": 20452, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4410:23:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "4394:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20454, "nodeType": "ExpressionStatement", "src": "4394:39:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20457, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20455, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20399, "src": "4988:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 20456, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "5008:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "4988:21:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20487, "nodeType": "Block", "src": "5250:231:130", "statements": [{ "expression": { "id": 20485, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20472, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20410, "src": "5340:15:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "id": 20484, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "5358:112:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "arguments": [{ "id": 20478, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "5407:17:130", "subExpression": { "id": 20477, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20399, "src": "5408:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20476, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "5399:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20475, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5399:7:130", "typeDescriptions": {} } }, "id": 20479, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5399:26:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20480, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20397, "src": "5427:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20473, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20408, "src": "5359:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20474, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5390:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "5359:39:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20481, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5359:83:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20482, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5460:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "5359:109:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20483, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5359:111:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "5340:130:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20486, "nodeType": "ExpressionStatement", "src": "5340:130:130" }] }, "id": 20488, "nodeType": "IfStatement", "src": "4984:497:130", "trueBody": { "id": 20471, "nodeType": "Block", "src": "5011:233:130", "statements": [{ "expression": { "id": 20469, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20458, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20410, "src": "5103:15:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "arguments": [{ "id": 20463, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20399, "src": "5171:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20462, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "5163:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20461, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5163:7:130", "typeDescriptions": {} } }, "id": 20464, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5163:25:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20465, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20397, "src": "5190:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20459, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20408, "src": "5121:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20460, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5152:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "5121:41:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20466, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5121:84:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20467, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5223:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "5121:110:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20468, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5121:112:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "5103:130:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20470, "nodeType": "ExpressionStatement", "src": "5103:130:130" }] } }, { "assignments": [20490, 20492], "declarations": [{ "constant": false, "id": 20490, "mutability": "mutable", "name": "oldEffectiveShareReserves", "nameLocation": "6191:25:130", "nodeType": "VariableDeclaration", "scope": 20546, "src": "6183:33:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20489, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6183:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20492, "mutability": "mutable", "name": "success", "nameLocation": "6223:7:130", "nodeType": "VariableDeclaration", "scope": 20546, "src": "6218:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20491, "name": "bool", "nodeType": "ElementaryTypeName", "src": "6218:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20498, "initialValue": { "arguments": [{ "id": 20495, "name": "_shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20397, "src": "6315:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20496, "name": "_shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20399, "src": "6347:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20493, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "6234:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20494, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6262:35:130", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19800, "src": "6234:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20497, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6234:143:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "6182:195:130" }, { "condition": { "id": 20500, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "6391:8:130", "subExpression": { "id": 20499, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20492, "src": "6392:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20508, "nodeType": "IfStatement", "src": "6387:62:130", "trueBody": { "id": 20507, "nodeType": "Block", "src": "6401:48:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20501, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6423:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20502, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6426:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20503, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6429:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20504, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6432:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20505, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6422:16:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20415, "id": 20506, "nodeType": "Return", "src": "6415:23:130" }] } }, { "assignments": [20510], "declarations": [{ "constant": false, "id": 20510, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "6466:22:130", "nodeType": "VariableDeclaration", "scope": 20546, "src": "6458:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20509, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6458:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20511, "nodeType": "VariableDeclarationStatement", "src": "6458:30:130" }, { "expression": { "id": 20520, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20512, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20510, "src": "6499:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20513, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20492, "src": "6523:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20514, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "6498:33:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20517, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20408, "src": "6615:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20518, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20410, "src": "6646:15:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20515, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "6534:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20516, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6562:35:130", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19800, "src": "6534:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20519, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6534:141:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "6498:177:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20521, "nodeType": "ExpressionStatement", "src": "6498:177:130" }, { "condition": { "id": 20523, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "6689:8:130", "subExpression": { "id": 20522, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20492, "src": "6690:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20531, "nodeType": "IfStatement", "src": "6685:62:130", "trueBody": { "id": 20530, "nodeType": "Block", "src": "6699:48:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20524, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6721:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20525, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6724:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 20526, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "6727:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20527, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6730:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20528, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6720:16:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,int_const 0,int_const 0,bool)" } }, "functionReturnParameters": 20415, "id": 20529, "nodeType": "Return", "src": "6713:23:130" }] } }, { "expression": { "id": 20538, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20532, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20412, "src": "6756:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20535, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20510, "src": "6809:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20536, "name": "oldEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20490, "src": "6845:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20533, "name": "_bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20401, "src": "6771:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20534, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6785:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "6771:24:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 20537, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6771:109:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "6756:124:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20539, "nodeType": "ExpressionStatement", "src": "6756:124:130" }, { "expression": { "components": [{ "id": 20540, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20408, "src": "6899:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20541, "name": "shareAdjustment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20410, "src": "6914:15:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 20542, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20412, "src": "6931:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20543, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "6945:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20544, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6898:52:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "functionReturnParameters": 20415, "id": 20545, "nodeType": "Return", "src": "6891:59:130" }] }, "documentation": { "id": 20395, "nodeType": "StructuredDocumentation", "src": "2601:794:130", "text": "@dev Calculates the new share reserves, share adjustment, and bond\n      reserves after liquidity is added or removed from the pool. This\n      update is made in such a way that the pool's spot price remains\n      constant.\n @param _shareReserves The current share reserves.\n @param _shareAdjustment The current share adjustment.\n @param _bondReserves The current bond reserves.\n @param _minimumShareReserves The minimum share reserves.\n @param _shareReservesDelta The change in share reserves.\n @return shareReserves The updated share reserves.\n @return shareAdjustment The updated share adjustment.\n @return bondReserves The updated bond reserves.\n @return A flag indicating if the calculation succeeded." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateUpdateLiquiditySafe", "nameLocation": "3409:28:130", "parameters": { "id": 20406, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20397, "mutability": "mutable", "name": "_shareReserves", "nameLocation": "3455:14:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3447:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20396, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3447:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20399, "mutability": "mutable", "name": "_shareAdjustment", "nameLocation": "3486:16:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3479:23:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20398, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3479:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20401, "mutability": "mutable", "name": "_bondReserves", "nameLocation": "3520:13:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3512:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20400, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3512:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20403, "mutability": "mutable", "name": "_minimumShareReserves", "nameLocation": "3551:21:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3543:29:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20402, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3543:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20405, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "3589:19:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3582:26:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20404, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3582:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "3437:177:130" }, "returnParameters": { "id": 20415, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20408, "mutability": "mutable", "name": "shareReserves", "nameLocation": "3683:13:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3675:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20407, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3675:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20410, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "3717:15:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3710:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20409, "name": "int256", "nodeType": "ElementaryTypeName", "src": "3710:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20412, "mutability": "mutable", "name": "bondReserves", "nameLocation": "3754:12:130", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3746:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20411, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3746:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20414, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20547, "src": "3780:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20413, "name": "bool", "nodeType": "ElementaryTypeName", "src": "3780:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "3661:133:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20572, "nodeType": "StructDefinition", "src": "6963:462:130", "nodes": [], "canonicalName": "LPMath.PresentValueParams", "members": [{ "constant": false, "id": 20549, "mutability": "mutable", "name": "shareReserves", "nameLocation": "7007:13:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "6999:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20548, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "6999:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20551, "mutability": "mutable", "name": "shareAdjustment", "nameLocation": "7037:15:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7030:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20550, "name": "int256", "nodeType": "ElementaryTypeName", "src": "7030:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20553, "mutability": "mutable", "name": "bondReserves", "nameLocation": "7070:12:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7062:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20552, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7062:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20555, "mutability": "mutable", "name": "vaultSharePrice", "nameLocation": "7100:15:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7092:23:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20554, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7092:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20557, "mutability": "mutable", "name": "initialVaultSharePrice", "nameLocation": "7133:22:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7125:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20556, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7125:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20559, "mutability": "mutable", "name": "minimumShareReserves", "nameLocation": "7173:20:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7165:28:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20558, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7165:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20561, "mutability": "mutable", "name": "minimumTransactionAmount", "nameLocation": "7211:24:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7203:32:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20560, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7203:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20563, "mutability": "mutable", "name": "timeStretch", "nameLocation": "7253:11:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7245:19:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20562, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7245:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20565, "mutability": "mutable", "name": "longsOutstanding", "nameLocation": "7282:16:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7274:24:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20564, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7274:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20567, "mutability": "mutable", "name": "longAverageTimeRemaining", "nameLocation": "7316:24:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7308:32:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20566, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7308:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20569, "mutability": "mutable", "name": "shortsOutstanding", "nameLocation": "7358:17:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7350:25:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20568, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7350:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20571, "mutability": "mutable", "name": "shortAverageTimeRemaining", "nameLocation": "7393:25:130", "nodeType": "VariableDeclaration", "scope": 20572, "src": "7385:33:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20570, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7385:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "name": "PresentValueParams", "nameLocation": "6970:18:130", "scope": 22264, "visibility": "public" }, { "id": 20601, "nodeType": "FunctionDefinition", "src": "7782:341:130", "nodes": [], "body": { "id": 20600, "nodeType": "Block", "src": "7894:229:130", "nodes": [], "statements": [{ "assignments": [20582, 20584], "declarations": [{ "constant": false, "id": 20582, "mutability": "mutable", "name": "presentValue", "nameLocation": "7913:12:130", "nodeType": "VariableDeclaration", "scope": 20600, "src": "7905:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20581, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7905:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20584, "mutability": "mutable", "name": "success", "nameLocation": "7932:7:130", "nodeType": "VariableDeclaration", "scope": 20600, "src": "7927:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20583, "name": "bool", "nodeType": "ElementaryTypeName", "src": "7927:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20588, "initialValue": { "arguments": [{ "id": 20586, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20576, "src": "7982:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20585, "name": "calculatePresentValueSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20667, "src": "7943:25:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256,bool)" } }, "id": 20587, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7943:56:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "7904:95:130" }, { "condition": { "id": 20590, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "8013:8:130", "subExpression": { "id": 20589, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20584, "src": "8014:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20597, "nodeType": "IfStatement", "src": "8009:79:130", "trueBody": { "id": 20596, "nodeType": "Block", "src": "8023:65:130", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20591, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "8044:11:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 20593, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "8056:19:130", "memberName": "InvalidPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 11041, "src": "8044:31:130", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 20594, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8044:33:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20595, "nodeType": "RevertStatement", "src": "8037:40:130" }] } }, { "expression": { "id": 20598, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20582, "src": "8104:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 20580, "id": 20599, "nodeType": "Return", "src": "8097:19:130" }] }, "documentation": { "id": 20573, "nodeType": "StructuredDocumentation", "src": "7431:346:130", "text": "@dev Calculates the present value LPs capital in the pool and reverts\n      if the value is negative. This calculation underestimates the\n      present value to avoid paying out more than the pool can afford.\n @param _params The parameters for the present value calculation.\n @return The present value of the pool." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculatePresentValue", "nameLocation": "7791:21:130", "parameters": { "id": 20577, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20576, "mutability": "mutable", "name": "_params", "nameLocation": "7848:7:130", "nodeType": "VariableDeclaration", "scope": 20601, "src": "7822:33:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20575, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20574, "name": "PresentValueParams", "nameLocations": ["7822:18:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 20572, "src": "7822:18:130" }, "referencedDeclaration": 20572, "src": "7822:18:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "7812:49:130" }, "returnParameters": { "id": 20580, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20579, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20601, "src": "7885:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20578, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7885:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "7884:9:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 20667, "nodeType": "FunctionDefinition", "src": "8818:1173:130", "nodes": [], "body": { "id": 20666, "nodeType": "Block", "src": "8940:1051:130", "nodes": [], "statements": [{ "assignments": [20613], "declarations": [{ "constant": false, "id": 20613, "mutability": "mutable", "name": "presentValue", "nameLocation": "9318:12:130", "nodeType": "VariableDeclaration", "scope": 20666, "src": "9311:19:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20612, "name": "int256", "nodeType": "ElementaryTypeName", "src": "9311:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20614, "nodeType": "VariableDeclarationStatement", "src": "9311:19:130" }, { "id": 20649, "nodeType": "Block", "src": "9340:422:130", "statements": [{ "assignments": [20616, 20618], "declarations": [{ "constant": false, "id": 20616, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "9362:13:130", "nodeType": "VariableDeclaration", "scope": 20649, "src": "9355:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20615, "name": "int256", "nodeType": "ElementaryTypeName", "src": "9355:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20618, "mutability": "mutable", "name": "success", "nameLocation": "9382:7:130", "nodeType": "VariableDeclaration", "scope": 20649, "src": "9377:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20617, "name": "bool", "nodeType": "ElementaryTypeName", "src": "9377:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20622, "initialValue": { "arguments": [{ "id": 20620, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20605, "src": "9437:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20619, "name": "calculateNetCurveTradeSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21002, "src": "9393:26:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_int256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256,bool)" } }, "id": 20621, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9393:65:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "9354:104:130" }, { "condition": { "id": 20624, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "9476:8:130", "subExpression": { "id": 20623, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20618, "src": "9477:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20630, "nodeType": "IfStatement", "src": "9472:64:130", "trueBody": { "id": 20629, "nodeType": "Block", "src": "9486:50:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20625, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9512:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20626, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9515:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20627, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9511:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20611, "id": 20628, "nodeType": "Return", "src": "9504:17:130" }] } }, { "expression": { "id": 20647, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 20631, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20613, "src": "9549:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20646, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20641, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20637, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "expression": { "id": 20632, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20605, "src": "9580:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20633, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "9588:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "9580:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20634, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9602:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "9580:30:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20635, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9580:32:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 20636, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20616, "src": "9631:13:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:64:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 20639, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20605, "src": "9685:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 20638, "name": "calculateNetFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21040, "src": "9663:21:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_int256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256)" } }, "id": 20640, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9663:30:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:113:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "expression": { "id": 20642, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20605, "src": "9712:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20643, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "9720:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "9712:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20644, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9741:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "9712:37:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20645, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9712:39:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9580:171:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9549:202:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 20648, "nodeType": "ExpressionStatement", "src": "9549:202:130" }] }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20652, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20650, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20613, "src": "9878:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 20651, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9893:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "9878:16:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20658, "nodeType": "IfStatement", "src": "9874:64:130", "trueBody": { "id": 20657, "nodeType": "Block", "src": "9896:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20653, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "9918:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20654, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9921:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20655, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9917:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20611, "id": 20656, "nodeType": "Return", "src": "9910:17:130" }] } }, { "expression": { "components": [{ "arguments": [{ "id": 20661, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20613, "src": "9964:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20660, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "9956:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20659, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "9956:7:130", "typeDescriptions": {} } }, "id": 20662, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9956:21:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 20663, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "9979:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20664, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "9955:29:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 20611, "id": 20665, "nodeType": "Return", "src": "9948:36:130" }] }, "documentation": { "id": 20602, "nodeType": "StructuredDocumentation", "src": "8129:684:130", "text": "@dev Calculates the present value LPs capital in the pool and returns\n      a flag indicating whether the calculation succeeded or failed.\n      For the most part, this calculation underestimates the present\n      value to avoid paying out more than the pool can afford; however,\n      it adheres faithfully to the rounding utilized when positions are\n      closed to accurately simulate the impact of closing the net curve\n      position.\n @param _params The parameters for the present value calculation.\n @return The present value of the pool.\n @return A flag indicating whether the calculation succeeded or failed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculatePresentValueSafe", "nameLocation": "8827:25:130", "parameters": { "id": 20606, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20605, "mutability": "mutable", "name": "_params", "nameLocation": "8888:7:130", "nodeType": "VariableDeclaration", "scope": 20667, "src": "8862:33:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20604, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20603, "name": "PresentValueParams", "nameLocations": ["8862:18:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 20572, "src": "8862:18:130" }, "referencedDeclaration": 20572, "src": "8862:18:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "8852:49:130" }, "returnParameters": { "id": 20611, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20608, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20667, "src": "8925:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20607, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8925:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20610, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 20667, "src": "8934:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20609, "name": "bool", "nodeType": "ElementaryTypeName", "src": "8934:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "8924:15:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21002, "nodeType": "FunctionDefinition", "src": "10319:9443:130", "nodes": [], "body": { "id": 21001, "nodeType": "Block", "src": "10441:9321:130", "nodes": [], "statements": [{ "assignments": [20679], "declarations": [{ "constant": false, "id": 20679, "mutability": "mutable", "name": "netCurvePosition", "nameLocation": "11244:16:130", "nodeType": "VariableDeclaration", "scope": 21001, "src": "11237:23:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20678, "name": "int256", "nodeType": "ElementaryTypeName", "src": "11237:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 20697, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20696, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 20683, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11320:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20684, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11328:24:130", "memberName": "longAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20567, "src": "11320:32:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20680, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11263:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20681, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11284:16:130", "memberName": "longsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20565, "src": "11263:37:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20682, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11314:5:130", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18902, "src": "11263:56:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20685, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11263:90:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20686, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11367:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "11263:112:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20687, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11263:114:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 20691, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11460:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20692, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11468:25:130", "memberName": "shortAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20571, "src": "11460:33:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 20688, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11392:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20689, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11417:17:130", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20569, "src": "11392:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20690, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11452:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "11392:67:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20693, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11392:102:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20694, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11512:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "11392:128:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20695, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11392:130:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "11263:259:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "11237:285:130" }, { "assignments": [20699, 20701], "declarations": [{ "constant": false, "id": 20699, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "11541:22:130", "nodeType": "VariableDeclaration", "scope": 21001, "src": "11533:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20698, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "11533:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 20701, "mutability": "mutable", "name": "success", "nameLocation": "11570:7:130", "nodeType": "VariableDeclaration", "scope": 21001, "src": "11565:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20700, "name": "bool", "nodeType": "ElementaryTypeName", "src": "11565:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 20709, "initialValue": { "arguments": [{ "expression": { "id": 20704, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11662:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20705, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11670:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "11662:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20706, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "11701:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20707, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "11709:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "11701:23:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 20702, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "11581:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 20703, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11609:35:130", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19800, "src": "11581:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 20708, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11581:157:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "11532:206:130" }, { "condition": { "id": 20711, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "11752:8:130", "subExpression": { "id": 20710, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "11753:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20717, "nodeType": "IfStatement", "src": "11748:160:130", "trueBody": { "id": 20716, "nodeType": "Block", "src": "11762:146:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20712, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "11888:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20713, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "11891:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20714, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "11887:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20715, "nodeType": "Return", "src": "11880:17:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20720, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20718, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20679, "src": "12138:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 20719, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "12157:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "12138:20:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20853, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20851, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20679, "src": "16221:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 20852, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "16240:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "16221:20:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20995, "nodeType": "IfStatement", "src": "16217:3512:130", "trueBody": { "id": 20994, "nodeType": "Block", "src": "16243:3486:130", "statements": [{ "assignments": [20855], "declarations": [{ "constant": false, "id": 20855, "mutability": "mutable", "name": "netCurvePosition_", "nameLocation": "16265:17:130", "nodeType": "VariableDeclaration", "scope": 20994, "src": "16257:25:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20854, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16257:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20861, "initialValue": { "arguments": [{ "id": 20859, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "16293:17:130", "subExpression": { "id": 20858, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20679, "src": "16294:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20857, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "16285:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20856, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16285:7:130", "typeDescriptions": {} } }, "id": 20860, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16285:26:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "16257:54:130" }, { "assignments": [20863], "declarations": [{ "constant": false, "id": 20863, "mutability": "mutable", "name": "maxCurveTrade", "nameLocation": "16436:13:130", "nodeType": "VariableDeclaration", "scope": 20994, "src": "16428:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20862, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "16428:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20864, "nodeType": "VariableDeclarationStatement", "src": "16428:21:130" }, { "expression": { "id": 20882, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20865, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20863, "src": "16464:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20866, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "16479:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20867, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "16463:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20870, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20699, "src": "16571:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20871, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "16615:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20872, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16623:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "16615:20:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20876, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20873, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "16657:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20874, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "16663:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20875, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16671:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "16663:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "16657:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20877, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "16704:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20878, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16712:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "16704:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20879, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "16749:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20880, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "16757:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "16749:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20868, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "16490:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20869, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16522:27:130", "memberName": "calculateMaxBuyBondsOutSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23222, "src": "16490:59:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20881, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16490:307:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "16463:334:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20883, "nodeType": "ExpressionStatement", "src": "16463:334:130" }, { "condition": { "id": 20885, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "16815:8:130", "subExpression": { "id": 20884, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "16816:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20891, "nodeType": "IfStatement", "src": "16811:64:130", "trueBody": { "id": 20890, "nodeType": "Block", "src": "16825:50:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20886, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "16851:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20887, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "16854:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20888, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "16850:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20889, "nodeType": "Return", "src": "16843:17:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20894, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20892, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20863, "src": "17035:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 20893, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20855, "src": "17052:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "17035:34:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20992, "nodeType": "Block", "src": "18727:992:130", "statements": [{ "assignments": [20947], "declarations": [{ "constant": false, "id": 20947, "mutability": "mutable", "name": "maxSharePayment", "nameLocation": "18805:15:130", "nodeType": "VariableDeclaration", "scope": 20992, "src": "18797:23:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20946, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "18797:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20948, "nodeType": "VariableDeclarationStatement", "src": "18797:23:130" }, { "expression": { "id": 20966, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20949, "name": "maxSharePayment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20947, "src": "18839:15:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20950, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "18856:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20951, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "18838:26:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20954, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20699, "src": "18956:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20955, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "19004:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20956, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19012:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "19004:20:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20960, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20957, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "19050:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20958, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "19056:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20959, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19064:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "19056:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19050:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20961, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "19101:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20962, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19109:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "19101:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20963, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "19150:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20964, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19158:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "19150:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20952, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "18867:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20953, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18903:27:130", "memberName": "calculateMaxBuySharesInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23139, "src": "18867:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20965, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18867:335:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "18838:364:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20967, "nodeType": "ExpressionStatement", "src": "18838:364:130" }, { "condition": { "id": 20969, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "19224:8:130", "subExpression": { "id": 20968, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "19225:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20975, "nodeType": "IfStatement", "src": "19220:72:130", "trueBody": { "id": 20974, "nodeType": "Block", "src": "19234:58:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20970, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "19264:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20971, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19267:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20972, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19263:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20973, "nodeType": "Return", "src": "19256:17:130" }] } }, { "expression": { "components": [{ "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20985, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20976, "name": "maxSharePayment", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20947, "src": "19484:15:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "expression": { "id": 20982, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "19599:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20983, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "19607:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "19599:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20979, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20977, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20855, "src": "19527:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 20978, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20863, "src": "19547:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19527:33:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20980, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19526:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20981, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "19562:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "19526:43:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 20984, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "19526:122:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "19484:164:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20986, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19483:166:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20987, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "19650:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "19483:175:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20988, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "19483:177:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20989, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19682:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20990, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19317:387:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20677, "id": 20991, "nodeType": "Return", "src": "19310:394:130" }] }, "id": 20993, "nodeType": "IfStatement", "src": "17031:2688:130", "trueBody": { "id": 20945, "nodeType": "Block", "src": "17071:1414:130", "statements": [{ "assignments": [20896], "declarations": [{ "constant": false, "id": 20896, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "17352:13:130", "nodeType": "VariableDeclaration", "scope": 20945, "src": "17344:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20895, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "17344:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20897, "nodeType": "VariableDeclarationStatement", "src": "17344:21:130" }, { "expression": { "id": 20916, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20898, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20896, "src": "17384:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20899, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "17399:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20900, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "17383:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20903, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20699, "src": "17508:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20904, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "17556:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20905, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17564:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "17556:20:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20906, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20855, "src": "17602:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20910, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20907, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "17645:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20908, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "17651:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20909, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17659:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "17651:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "17645:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20911, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "17696:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20912, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17704:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "17696:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20913, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "17745:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20914, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "17753:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "17745:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20901, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "17410:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20902, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "17446:36:130", "memberName": "calculateSharesInGivenBondsOutUpSafe", "nodeType": "MemberAccess", "referencedDeclaration": 22749, "src": "17410:72:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20915, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "17410:387:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "17383:414:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20917, "nodeType": "ExpressionStatement", "src": "17383:414:130" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 20924, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20919, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "18103:8:130", "subExpression": { "id": 20918, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "18104:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20923, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20920, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20855, "src": "18135:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "id": 20921, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "18155:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20922, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "18163:24:130", "memberName": "minimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 20561, "src": "18155:32:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "18135:52:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "18103:84:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "id": 20931, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "18345:8:130", "subExpression": { "id": 20930, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "18346:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20937, "nodeType": "IfStatement", "src": "18341:72:130", "trueBody": { "id": 20936, "nodeType": "Block", "src": "18355:58:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20932, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "18385:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20933, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18388:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20934, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18384:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20935, "nodeType": "Return", "src": "18377:17:130" }] } }, "id": 20938, "nodeType": "IfStatement", "src": "18078:335:130", "trueBody": { "id": 20929, "nodeType": "Block", "src": "18206:57:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20925, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "18236:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20926, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18239:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20927, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18235:9:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20928, "nodeType": "Return", "src": "18228:16:130" }] } }, { "expression": { "components": [{ "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20939, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20896, "src": "18439:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20940, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18453:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "18439:22:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20941, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18439:24:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20942, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18465:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20943, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "18438:32:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20677, "id": 20944, "nodeType": "Return", "src": "18431:39:130" }] } }] } }, "id": 20996, "nodeType": "IfStatement", "src": "12134:7595:130", "trueBody": { "id": 20850, "nodeType": "Block", "src": "12160:3965:130", "statements": [{ "assignments": [20722], "declarations": [{ "constant": false, "id": 20722, "mutability": "mutable", "name": "netCurvePosition_", "nameLocation": "12182:17:130", "nodeType": "VariableDeclaration", "scope": 20850, "src": "12174:25:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20721, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12174:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20727, "initialValue": { "arguments": [{ "id": 20725, "name": "netCurvePosition", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20679, "src": "12210:16:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 20724, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "12202:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 20723, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12202:7:130", "typeDescriptions": {} } }, "id": 20726, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12202:25:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12174:53:130" }, { "assignments": [20729], "declarations": [{ "constant": false, "id": 20729, "mutability": "mutable", "name": "maxCurveTrade", "nameLocation": "12423:13:130", "nodeType": "VariableDeclaration", "scope": 20850, "src": "12415:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20728, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12415:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20730, "nodeType": "VariableDeclarationStatement", "src": "12415:21:130" }, { "expression": { "id": 20753, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20731, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20729, "src": "12451:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20732, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "12466:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20733, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "12450:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 20736, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12558:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20737, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12566:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "12558:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20738, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12601:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20739, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12609:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "12601:23:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 20740, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12646:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20741, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12654:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "12646:20:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20742, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12688:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20743, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12696:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "12688:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20747, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20744, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "12738:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20745, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12744:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20746, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12752:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "12744:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "12738:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20748, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12785:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20749, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12793:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "12785:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20750, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "12830:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20751, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "12838:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "12830:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20734, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "12477:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20735, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12509:27:130", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23353, "src": "12477:59:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20752, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12477:401:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "12450:428:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20754, "nodeType": "ExpressionStatement", "src": "12450:428:130" }, { "condition": { "id": 20756, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "12896:8:130", "subExpression": { "id": 20755, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "12897:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20762, "nodeType": "IfStatement", "src": "12892:176:130", "trueBody": { "id": 20761, "nodeType": "Block", "src": "12906:162:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20757, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "13044:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20758, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "13047:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20759, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "13043:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20760, "nodeType": "Return", "src": "13036:17:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20765, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20763, "name": "maxCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20729, "src": "13228:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 20764, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20722, "src": "13245:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "13228:34:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20848, "nodeType": "Block", "src": "14929:1186:130", "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 20821, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 20818, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "15323:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20819, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15331:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "15323:23:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 20820, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "15350:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "15323:28:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 20846, "nodeType": "Block", "src": "15880:221:130", "statements": [{ "expression": { "components": [{ "id": 20842, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "15935:95:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20838, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 20834, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "15937:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20835, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15945:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "15937:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20836, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "15961:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20837, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15969:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "15961:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "15937:52:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20839, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15936:54:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20840, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16020:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "15936:92:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20841, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15936:94:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20843, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "16056:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20844, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15909:173:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20677, "id": 20845, "nodeType": "Return", "src": "15902:180:130" }] }, "id": 20847, "nodeType": "IfStatement", "src": "15319:782:130", "trueBody": { "id": 20833, "nodeType": "Block", "src": "15353:222:130", "statements": [{ "expression": { "components": [{ "id": 20829, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "15408:96:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20825, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20822, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20699, "src": "15410:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20823, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "15435:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20824, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15443:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "15435:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "15410:53:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 20826, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15409:55:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20827, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15494:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "15409:93:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20828, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15409:95:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20830, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "15530:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20831, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "15382:174:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20677, "id": 20832, "nodeType": "Return", "src": "15375:181:130" }] } }] }, "id": 20849, "nodeType": "IfStatement", "src": "13224:2891:130", "trueBody": { "id": 20817, "nodeType": "Block", "src": "13264:1416:130", "statements": [{ "assignments": [20767], "declarations": [{ "constant": false, "id": 20767, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "13544:13:130", "nodeType": "VariableDeclaration", "scope": 20817, "src": "13536:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 20766, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13536:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 20768, "nodeType": "VariableDeclarationStatement", "src": "13536:21:130" }, { "expression": { "id": 20787, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 20769, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20767, "src": "13576:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20770, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "13591:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 20771, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "13575:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 20774, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20699, "src": "13702:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20775, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "13750:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20776, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13758:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "13750:20:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 20777, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20722, "src": "13796:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20781, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20778, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "13839:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 20779, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "13845:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20780, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13853:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "13845:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "13839:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20782, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "13890:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20783, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13898:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "13890:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 20784, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "13939:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20785, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "13947:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "13939:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 20772, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "13602:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 20773, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "13638:38:130", "memberName": "calculateSharesOutGivenBondsInDownSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23049, "src": "13602:74:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 20786, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "13602:389:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "13575:416:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 20788, "nodeType": "ExpressionStatement", "src": "13575:416:130" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 20795, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20790, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "14297:8:130", "subExpression": { "id": 20789, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "14298:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 20794, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 20791, "name": "netCurvePosition_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20722, "src": "14329:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "id": 20792, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20671, "src": "14349:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 20793, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "14357:24:130", "memberName": "minimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 20561, "src": "14349:32:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "14329:52:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "14297:84:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "id": 20802, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "14539:8:130", "subExpression": { "id": 20801, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20701, "src": "14540:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 20808, "nodeType": "IfStatement", "src": "14535:72:130", "trueBody": { "id": 20807, "nodeType": "Block", "src": "14549:58:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20803, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "14579:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 20804, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14582:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 20805, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14578:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20806, "nodeType": "Return", "src": "14571:17:130" }] } }, "id": 20809, "nodeType": "IfStatement", "src": "14272:335:130", "trueBody": { "id": 20800, "nodeType": "Block", "src": "14400:57:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 20796, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "14430:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20797, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14433:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20798, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14429:9:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 20799, "nodeType": "Return", "src": "14422:16:130" }] } }, { "expression": { "components": [{ "id": 20813, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "14633:25:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 20810, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20767, "src": "14634:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 20811, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "14648:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "14634:22:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 20812, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "14634:24:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "hexValue": "74727565", "id": 20814, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "14660:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20815, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "14632:33:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_int256_$_t_bool_$", "typeString": "tuple(int256,bool)" } }, "functionReturnParameters": 20677, "id": 20816, "nodeType": "Return", "src": "14625:40:130" }] } }] } }, { "expression": { "components": [{ "hexValue": "30", "id": 20997, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "19747:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 20998, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "19750:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 20999, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "19746:9:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 20677, "id": 21000, "nodeType": "Return", "src": "19739:16:130" }] }, "documentation": { "id": 20668, "nodeType": "StructuredDocumentation", "src": "9997:317:130", "text": "@dev Calculates the result of closing the net curve position.\n @param _params The parameters for the present value calculation.\n @return The impact of closing the net curve position on the share\n         reserves.\n @return A flag indicating whether the calculation succeeded or failed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateNetCurveTradeSafe", "nameLocation": "10328:26:130", "parameters": { "id": 20672, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20671, "mutability": "mutable", "name": "_params", "nameLocation": "10390:7:130", "nodeType": "VariableDeclaration", "scope": 21002, "src": "10364:33:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 20670, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 20669, "name": "PresentValueParams", "nameLocations": ["10364:18:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 20572, "src": "10364:18:130" }, "referencedDeclaration": 20572, "src": "10364:18:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "10354:49:130" }, "returnParameters": { "id": 20677, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 20674, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21002, "src": "10427:6:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 20673, "name": "int256", "nodeType": "ElementaryTypeName", "src": "10427:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 20676, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21002, "src": "10435:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 20675, "name": "bool", "nodeType": "ElementaryTypeName", "src": "10435:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "10426:14:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21040, "nodeType": "FunctionDefinition", "src": "20009:1167:130", "nodes": [], "body": { "id": 21039, "nodeType": "Block", "src": "20120:1056:130", "nodes": [], "statements": [{ "expression": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21037, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21017, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21014, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "20828:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 21015, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "20834:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21016, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20842:25:130", "memberName": "shortAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20571, "src": "20834:33:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "20828:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21018, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "20889:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21019, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20897:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "20889:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21011, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "20770:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21012, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20778:17:130", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20569, "src": "20770:25:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21013, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20796:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "20770:36:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21020, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20770:160:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21021, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "20752:192:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21022, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20945:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "20752:201:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21023, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20752:203:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "components": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21030, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21027, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "21043:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "id": 21028, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "21049:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21029, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "21057:24:130", "memberName": "longAverageTimeRemaining", "nodeType": "MemberAccess", "referencedDeclaration": 20567, "src": "21049:32:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "21043:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21031, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "21103:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21032, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "21111:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "21103:23:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21024, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21006, "src": "20988:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21025, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20996:16:130", "memberName": "longsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 20565, "src": "20988:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21026, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "21013:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "20988:33:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21033, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20988:156:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21034, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "20970:188:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21035, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "21159:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "20970:197:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21036, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20970:199:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "20752:417:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "functionReturnParameters": 21010, "id": 21038, "nodeType": "Return", "src": "20733:436:130" }] }, "documentation": { "id": 21003, "nodeType": "StructuredDocumentation", "src": "19768:236:130", "text": "@dev Calculates the result of closing the net flat position.\n @param _params The parameters for the present value calculation.\n @return The impact of closing the net flat position on the share\n         reserves." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateNetFlatTrade", "nameLocation": "20018:21:130", "parameters": { "id": 21007, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21006, "mutability": "mutable", "name": "_params", "nameLocation": "20075:7:130", "nodeType": "VariableDeclaration", "scope": 21040, "src": "20049:33:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 21005, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21004, "name": "PresentValueParams", "nameLocations": ["20049:18:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 20572, "src": "20049:18:130" }, "referencedDeclaration": 20572, "src": "20049:18:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }], "src": "20039:49:130" }, "returnParameters": { "id": 21010, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21009, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21040, "src": "20112:6:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21008, "name": "int256", "nodeType": "ElementaryTypeName", "src": "20112:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "20111:8:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21060, "nodeType": "StructDefinition", "src": "21182:377:130", "nodes": [], "canonicalName": "LPMath.DistributeExcessIdleParams", "members": [{ "constant": false, "id": 21043, "mutability": "mutable", "name": "presentValueParams", "nameLocation": "21245:18:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21226:37:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" }, "typeName": { "id": 21042, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21041, "name": "PresentValueParams", "nameLocations": ["21226:18:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 20572, "src": "21226:18:130" }, "referencedDeclaration": 20572, "src": "21226:18:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_storage_ptr", "typeString": "struct LPMath.PresentValueParams" } }, "visibility": "internal" }, { "constant": false, "id": 21045, "mutability": "mutable", "name": "startingPresentValue", "nameLocation": "21281:20:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21273:28:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21044, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21273:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21047, "mutability": "mutable", "name": "activeLpTotalSupply", "nameLocation": "21319:19:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21311:27:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21046, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21311:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21049, "mutability": "mutable", "name": "withdrawalSharesTotalSupply", "nameLocation": "21356:27:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21348:35:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21048, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21348:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21051, "mutability": "mutable", "name": "idle", "nameLocation": "21401:4:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21393:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21050, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21393:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21053, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "21422:13:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21415:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21052, "name": "int256", "nodeType": "ElementaryTypeName", "src": "21415:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 21055, "mutability": "mutable", "name": "originalShareReserves", "nameLocation": "21453:21:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21445:29:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21054, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21445:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21057, "mutability": "mutable", "name": "originalShareAdjustment", "nameLocation": "21491:23:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21484:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21056, "name": "int256", "nodeType": "ElementaryTypeName", "src": "21484:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 21059, "mutability": "mutable", "name": "originalBondReserves", "nameLocation": "21532:20:130", "nodeType": "VariableDeclaration", "scope": 21060, "src": "21524:28:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21058, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21524:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "name": "DistributeExcessIdleParams", "nameLocation": "21189:26:130", "scope": 22264, "visibility": "public" }, { "id": 21178, "nodeType": "FunctionDefinition", "src": "22927:3408:130", "nodes": [], "body": { "id": 21177, "nodeType": "Block", "src": "23064:3271:130", "nodes": [], "statements": [{ "assignments": [21072, 21074], "declarations": [{ "constant": false, "id": 21072, "mutability": "mutable", "name": "originalEffectiveShareReserves", "nameLocation": "23369:30:130", "nodeType": "VariableDeclaration", "scope": 21177, "src": "23361:38:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21071, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23361:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21074, "mutability": "mutable", "name": "success", "nameLocation": "23406:7:130", "nodeType": "VariableDeclaration", "scope": 21177, "src": "23401:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21073, "name": "bool", "nodeType": "ElementaryTypeName", "src": "23401:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21082, "initialValue": { "arguments": [{ "expression": { "id": 21077, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "23498:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21078, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "23506:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "23498:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21079, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "23545:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21080, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "23553:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "23545:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 21075, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "23417:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 21076, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "23445:35:130", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19800, "src": "23417:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 21081, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23417:173:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "23360:230:130" }, { "condition": { "id": 21084, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "23604:8:130", "subExpression": { "id": 21083, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21074, "src": "23605:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21090, "nodeType": "IfStatement", "src": "23600:52:130", "trueBody": { "id": 21089, "nodeType": "Block", "src": "23614:38:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21085, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23636:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21086, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23639:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21087, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "23635:6:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 21070, "id": 21088, "nodeType": "Return", "src": "23628:13:130" }] } }, { "assignments": [21092], "declarations": [{ "constant": false, "id": 21092, "mutability": "mutable", "name": "maxShareReservesDelta", "nameLocation": "23669:21:130", "nodeType": "VariableDeclaration", "scope": 21177, "src": "23661:29:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21091, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23661:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21093, "nodeType": "VariableDeclarationStatement", "src": "23661:29:130" }, { "expression": { "id": 21101, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21094, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "23701:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21095, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21074, "src": "23724:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21096, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "23700:32:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21098, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "23783:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21099, "name": "originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21072, "src": "23804:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21097, "name": "calculateMaxShareReservesDeltaSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21922, "src": "23735:34:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256) pure returns (uint256,bool)" } }, "id": 21100, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23735:109:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "23700:144:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21102, "nodeType": "ExpressionStatement", "src": "23700:144:130" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21108, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21104, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "23858:8:130", "subExpression": { "id": 21103, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21074, "src": "23859:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21107, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21105, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "23870:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21106, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23895:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "23870:26:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "23858:38:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21114, "nodeType": "IfStatement", "src": "23854:82:130", "trueBody": { "id": 21113, "nodeType": "Block", "src": "23898:38:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21109, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23920:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21110, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "23923:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21111, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "23919:6:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 21070, "id": 21112, "nodeType": "Return", "src": "23912:13:130" }] } }, { "assignments": [21116], "declarations": [{ "constant": false, "id": 21116, "mutability": "mutable", "name": "withdrawalSharesRedeemed", "nameLocation": "24232:24:130", "nodeType": "VariableDeclaration", "scope": 21177, "src": "24224:32:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21115, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24224:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21121, "initialValue": { "arguments": [{ "id": 21118, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "24330:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21119, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "24355:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21117, "name": "calculateDistributeExcessIdleWithdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21272, "src": "24259:53:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256) pure returns (uint256)" } }, "id": 21120, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "24259:131:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "24224:166:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21124, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21122, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21116, "src": "24527:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21123, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24555:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "24527:29:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21133, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21130, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21116, "src": "24833:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "expression": { "id": 21131, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "24861:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21132, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "24869:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "24861:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "24833:63:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21144, "nodeType": "Block", "src": "25179:87:130", "statements": [{ "expression": { "id": 21142, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21139, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21116, "src": "25193:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "expression": { "id": 21140, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "25220:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21141, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "25228:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "25220:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "25193:62:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21143, "nodeType": "ExpressionStatement", "src": "25193:62:130" }] }, "id": 21145, "nodeType": "IfStatement", "src": "24816:450:130", "trueBody": { "id": 21138, "nodeType": "Block", "src": "24907:81:130", "statements": [{ "expression": { "components": [{ "id": 21134, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21116, "src": "24929:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21135, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "24955:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21136, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "24928:49:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "functionReturnParameters": 21070, "id": 21137, "nodeType": "Return", "src": "24921:56:130" }] } }, "id": 21146, "nodeType": "IfStatement", "src": "24523:743:130", "trueBody": { "id": 21129, "nodeType": "Block", "src": "24558:38:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21125, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24580:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21126, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "24583:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21127, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "24579:6:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 21070, "id": 21128, "nodeType": "Return", "src": "24572:13:130" }] } }, { "assignments": [21148], "declarations": [{ "constant": false, "id": 21148, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "25533:13:130", "nodeType": "VariableDeclaration", "scope": 21177, "src": "25525:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21147, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "25525:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21154, "initialValue": { "arguments": [{ "id": 21150, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21064, "src": "25605:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21151, "name": "originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21072, "src": "25626:30:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21152, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "25670:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21149, "name": "calculateDistributeExcessIdleShareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21653, "src": "25549:42:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,uint256) pure returns (uint256)" } }, "id": 21153, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "25549:152:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "25525:176:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21157, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21155, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21148, "src": "25715:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21156, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25732:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "25715:18:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21163, "nodeType": "IfStatement", "src": "25711:62:130", "trueBody": { "id": 21162, "nodeType": "Block", "src": "25735:38:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21158, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25757:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21159, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "25760:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21160, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "25756:6:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 21070, "id": 21161, "nodeType": "Return", "src": "25749:13:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21166, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21164, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21148, "src": "26090:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21165, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21092, "src": "26107:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "26090:38:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21172, "nodeType": "IfStatement", "src": "26086:82:130", "trueBody": { "id": 21171, "nodeType": "Block", "src": "26130:38:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21167, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "26152:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "30", "id": 21168, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "26155:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }], "id": 21169, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "26151:6:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_rational_0_by_1_$", "typeString": "tuple(int_const 0,int_const 0)" } }, "functionReturnParameters": 21070, "id": 21170, "nodeType": "Return", "src": "26144:13:130" }] } }, { "expression": { "components": [{ "id": 21173, "name": "withdrawalSharesRedeemed", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21116, "src": "26288:24:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21174, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21148, "src": "26314:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21175, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "26287:41:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "functionReturnParameters": 21070, "id": 21176, "nodeType": "Return", "src": "26280:48:130" }] }, "documentation": { "id": 21061, "nodeType": "StructuredDocumentation", "src": "21565:1357:130", "text": "@dev Calculates the amount of withdrawal shares that can be redeemed and\n      the share proceeds the withdrawal pool should receive given the\n      pool's current idle liquidity. We use the following algorithm to\n      ensure that the withdrawal pool receives the correct amount of\n      shares to (1) preserve the LP share price and (2) pay out as much\n      of the idle liquidity as possible to the withdrawal pool:\n      1. If `y_s * t_s <= y_l * t_l` or\n         `y_max_out(I) >= y_s * t_s - y_l * t_l`, set `dz_max = I` and\n         proceed to step (3). Otherwise, proceed to step (2).\n      2. Solve `y_max_out(dz_max) = y_s * t_s - y_l * t_l` for `dz_max`\n         using Newton's method.\n      3. Set `dw = (1 - PV(dz_max) / PV(0)) * l`. If `dw <= w`, then\n         proceed to step (5). Otherwise, set `dw = w` and continue to\n         step (4).\n      4. Solve `PV(0) / l = PV(dz) / (l - dw)` for `dz` using Newton's\n         method if `y_l * t_l != y_s * t_s` or directly otherwise.\n      5. Return `dw` and `dz`.\n @param _params The parameters for the distribute excess idle.\n @return The amount of withdrawal shares that can be redeemed.\n @return The share proceeds the withdrawal pool should receive." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdle", "nameLocation": "22936:29:130", "parameters": { "id": 21065, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21064, "mutability": "mutable", "name": "_params", "nameLocation": "23009:7:130", "nodeType": "VariableDeclaration", "scope": 21178, "src": "22975:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21063, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21062, "name": "DistributeExcessIdleParams", "nameLocations": ["22975:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "22975:26:130" }, "referencedDeclaration": 21060, "src": "22975:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "src": "22965:57:130" }, "returnParameters": { "id": 21070, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21067, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21178, "src": "23046:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21066, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23046:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21069, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21178, "src": "23055:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21068, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "23055:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "23045:18:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21272, "nodeType": "FunctionDefinition", "src": "27196:2209:130", "nodes": [], "body": { "id": 21271, "nodeType": "Block", "src": "27385:2020:130", "nodes": [], "statements": [{ "assignments": [21190], "declarations": [{ "constant": false, "id": 21190, "mutability": "mutable", "name": "success", "nameLocation": "27480:7:130", "nodeType": "VariableDeclaration", "scope": 21271, "src": "27475:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21189, "name": "bool", "nodeType": "ElementaryTypeName", "src": "27475:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21191, "nodeType": "VariableDeclarationStatement", "src": "27475:12:130" }, { "expression": { "id": 21220, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21192, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27511:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21195, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27519:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "27511:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21196, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27538:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "27511:40:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21197, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27565:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21198, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27573:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "27565:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21199, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27592:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "27565:42:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21200, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27621:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21201, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27629:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "27621:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21202, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "27648:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "27621:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21203, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21190, "src": "27674:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21204, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "27497:194:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21206, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27736:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21207, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27744:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "27736:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21208, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27779:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21209, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27787:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "27779:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21210, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27824:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21211, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27832:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "27824:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21212, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "27866:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21213, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27874:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "27866:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21214, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "27893:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "27866:47:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21218, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "27927:31:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21215, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21184, "src": "27928:19:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21216, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "27948:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "27928:28:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21217, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "27928:30:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21205, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20547, "src": "27694:28:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21219, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "27694:274:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "27497:471:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21221, "nodeType": "ExpressionStatement", "src": "27497:471:130" }, { "condition": { "id": 21223, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "27982:8:130", "subExpression": { "id": 21222, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21190, "src": "27983:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21227, "nodeType": "IfStatement", "src": "27978:167:130", "trueBody": { "id": 21226, "nodeType": "Block", "src": "27992:153:130", "statements": [{ "expression": { "hexValue": "30", "id": 21224, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28133:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21188, "id": 21225, "nodeType": "Return", "src": "28126:8:130" }] } }, { "assignments": [21229], "declarations": [{ "constant": false, "id": 21229, "mutability": "mutable", "name": "endingPresentValue", "nameLocation": "28162:18:130", "nodeType": "VariableDeclaration", "scope": 21271, "src": "28154:26:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21228, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "28154:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21230, "nodeType": "VariableDeclarationStatement", "src": "28154:26:130" }, { "expression": { "id": 21238, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21231, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21229, "src": "28191:18:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21232, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21190, "src": "28211:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21233, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "28190:29:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21235, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "28261:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21236, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "28269:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "28261:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21234, "name": "calculatePresentValueSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20667, "src": "28222:25:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256,bool)" } }, "id": 21237, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "28222:75:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "28190:107:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21239, "nodeType": "ExpressionStatement", "src": "28190:107:130" }, { "condition": { "id": 21241, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "28311:8:130", "subExpression": { "id": 21240, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21190, "src": "28312:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21245, "nodeType": "IfStatement", "src": "28307:167:130", "trueBody": { "id": 21244, "nodeType": "Block", "src": "28321:153:130", "statements": [{ "expression": { "hexValue": "30", "id": 21242, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28462:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21188, "id": 21243, "nodeType": "Return", "src": "28455:8:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21249, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21246, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21229, "src": "28786:18:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "expression": { "id": 21247, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "28808:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21248, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "28816:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "28808:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28786:50:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21253, "nodeType": "IfStatement", "src": "28782:89:130", "trueBody": { "id": 21252, "nodeType": "Block", "src": "28838:33:130", "statements": [{ "expression": { "hexValue": "30", "id": 21250, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "28859:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21188, "id": 21251, "nodeType": "Return", "src": "28852:8:130" }] } }, { "assignments": [21255], "declarations": [{ "constant": false, "id": 21255, "mutability": "mutable", "name": "lpTotalSupply", "nameLocation": "29128:13:130", "nodeType": "VariableDeclaration", "scope": 21271, "src": "29120:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21254, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "29120:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21261, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21260, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21256, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "29144:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21257, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29152:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "29144:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21258, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "29186:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21259, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29194:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "29186:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "29144:77:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "29120:101:130" }, { "expression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21269, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21262, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "29250:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [{ "id": 21265, "name": "endingPresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21229, "src": "29320:18:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21266, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21182, "src": "29356:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21267, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29364:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "29356:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21263, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21255, "src": "29278:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21264, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "29292:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "29278:24:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21268, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "29278:120:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "29250:148:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21188, "id": 21270, "nodeType": "Return", "src": "29231:167:130" }] }, "documentation": { "id": 21179, "nodeType": "StructuredDocumentation", "src": "26341:850:130", "text": "@dev Calculates the amount of withdrawal shares that can be redeemed\n      given an amount of shares to remove from the share reserves.\n      Assuming that dz is the amount of shares to remove from the\n      reserves and dl is the amount of LP shares to be burned, we can\n      derive the calculation as follows:\n      PV(0) / l = PV(dx) / (l - dl)\n                =>\n      dl = l - l * (PV(dx) / PV(0))\n      We round this calculation up to err on the side of slightly too\n      many withdrawal shares being redeemed.\n @param _params The parameters for the present value calculation.\n @param _shareReservesDelta The amount of shares to remove from the\n        share reserves.\n @return The amount of withdrawal shares that can be redeemed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleWithdrawalSharesRedeemed", "nameLocation": "27205:53:130", "parameters": { "id": 21185, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21182, "mutability": "mutable", "name": "_params", "nameLocation": "27302:7:130", "nodeType": "VariableDeclaration", "scope": 21272, "src": "27268:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21181, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21180, "name": "DistributeExcessIdleParams", "nameLocations": ["27268:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "27268:26:130" }, "referencedDeclaration": 21060, "src": "27268:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21184, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "27327:19:130", "nodeType": "VariableDeclaration", "scope": 21272, "src": "27319:27:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21183, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27319:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "27258:94:130" }, "returnParameters": { "id": 21188, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21187, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21272, "src": "27376:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21186, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27376:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "27375:9:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21653, "nodeType": "FunctionDefinition", "src": "30287:10343:130", "nodes": [], "body": { "id": 21652, "nodeType": "Block", "src": "30517:10113:130", "nodes": [], "statements": [{ "assignments": [21286], "declarations": [{ "constant": false, "id": 21286, "mutability": "mutable", "name": "lpTotalSupply", "nameLocation": "30577:13:130", "nodeType": "VariableDeclaration", "scope": 21652, "src": "30569:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21285, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30569:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21292, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21291, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21287, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "30593:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21288, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "30601:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "30593:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21289, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "30635:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21290, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "30643:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "30635:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30593:77:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "30569:101:130" }, { "assignments": [21294], "declarations": [{ "constant": false, "id": 21294, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "31152:13:130", "nodeType": "VariableDeclaration", "scope": 21652, "src": "31144:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21293, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "31144:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21302, "initialValue": { "arguments": [{ "expression": { "id": 21298, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "31228:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21299, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31236:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "31228:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21300, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21286, "src": "31270:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21295, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "31168:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21296, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31176:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "31168:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21297, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "31204:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "31168:46:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21301, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "31168:125:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "31144:149:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21306, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21303, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "31406:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21304, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "31414:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "31406:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21305, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "31431:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "31406:26:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21310, "nodeType": "IfStatement", "src": "31402:77:130", "trueBody": { "id": 21309, "nodeType": "Block", "src": "31434:45:130", "statements": [{ "expression": { "id": 21307, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "31455:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21284, "id": 21308, "nodeType": "Return", "src": "31448:20:130" }] } }, { "body": { "id": 21648, "nodeType": "Block", "src": "31894:8699:130", "statements": [{ "expression": { "id": 21323, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21318, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "32049:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21321, "name": "_maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21280, "src": "32083:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21319, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "32065:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21320, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "32079:3:130", "memberName": "min", "nodeType": "MemberAccess", "referencedDeclaration": 19517, "src": "32065:17:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21322, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32065:41:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "32049:57:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21324, "nodeType": "ExpressionStatement", "src": "32049:57:130" }, { "assignments": [21326], "declarations": [{ "constant": false, "id": 21326, "mutability": "mutable", "name": "success", "nameLocation": "32244:7:130", "nodeType": "VariableDeclaration", "scope": 21648, "src": "32239:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21325, "name": "bool", "nodeType": "ElementaryTypeName", "src": "32239:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21327, "nodeType": "VariableDeclarationStatement", "src": "32239:12:130" }, { "expression": { "id": 21356, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21328, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32283:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21331, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32291:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "32283:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21332, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32310:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "32283:40:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21333, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32341:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21334, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32349:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "32341:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21335, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32368:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "32341:42:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21336, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32401:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21337, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32409:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "32401:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21338, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "32428:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "32401:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21339, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "32458:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21340, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "32265:214:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21342, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32528:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21343, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32536:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "32528:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21344, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32575:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21345, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32583:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "32575:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21346, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32624:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21347, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32632:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "32624:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21348, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "32670:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21349, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32678:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "32670:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21350, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "32697:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "32670:47:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21354, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "32735:25:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21351, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "32736:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21352, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "32750:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "32736:22:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21353, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32736:24:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21341, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20547, "src": "32482:28:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21355, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "32482:292:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "32265:509:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21357, "nodeType": "ExpressionStatement", "src": "32265:509:130" }, { "condition": { "id": 21359, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "32792:8:130", "subExpression": { "id": 21358, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "32793:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21363, "nodeType": "IfStatement", "src": "32788:268:130", "trueBody": { "id": 21362, "nodeType": "Block", "src": "32802:254:130", "statements": [{ "expression": { "hexValue": "30", "id": 21360, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "33040:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21361, "nodeType": "Return", "src": "33033:8:130" }] } }, { "assignments": [21365], "declarations": [{ "constant": false, "id": 21365, "mutability": "mutable", "name": "presentValue", "nameLocation": "33077:12:130", "nodeType": "VariableDeclaration", "scope": 21648, "src": "33069:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21364, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "33069:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21370, "initialValue": { "arguments": [{ "expression": { "id": 21367, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "33131:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21368, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "33139:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "33131:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21366, "name": "calculatePresentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20601, "src": "33092:21:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_uint256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (uint256)" } }, "id": 21369, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "33092:79:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "33069:102:130" }, { "condition": { "arguments": [{ "id": 21372, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "33349:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21373, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21365, "src": "33378:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21374, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21286, "src": "33412:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 21371, "name": "shouldShortCircuitDistributeExcessIdleShareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21804, "src": "33276:51:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$_t_uint256_$_t_uint256_$returns$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,uint256) pure returns (bool)" } }, "id": 21375, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "33276:167:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21378, "nodeType": "IfStatement", "src": "33255:241:130", "trueBody": { "id": 21377, "nodeType": "Block", "src": "33458:38:130", "statements": [{ "id": 21376, "nodeType": "Break", "src": "33476:5:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21382, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21379, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "33722:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21380, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "33730:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "33722:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 21381, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "33746:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "33722:25:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21538, "nodeType": "IfStatement", "src": "33718:4509:130", "trueBody": { "id": 21537, "nodeType": "Block", "src": "33749:4478:130", "statements": [{ "assignments": [21385], "declarations": [{ "constant": false, "id": 21385, "mutability": "mutable", "name": "params", "nameLocation": "33922:6:130", "nodeType": "VariableDeclaration", "scope": 21537, "src": "33888:40:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21384, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21383, "name": "DistributeExcessIdleParams", "nameLocations": ["33888:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "33888:26:130" }, "referencedDeclaration": 21060, "src": "33888:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "id": 21387, "initialValue": { "id": 21386, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "33931:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "nodeType": "VariableDeclarationStatement", "src": "33888:50:130" }, { "assignments": [21389], "declarations": [{ "constant": false, "id": 21389, "mutability": "mutable", "name": "maxBondAmount", "nameLocation": "33988:13:130", "nodeType": "VariableDeclaration", "scope": 21537, "src": "33980:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21388, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "33980:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21390, "nodeType": "VariableDeclarationStatement", "src": "33980:21:130" }, { "expression": { "id": 21420, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21391, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21389, "src": "34020:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21392, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "34035:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21393, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "34019:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 21396, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34135:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21397, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34142:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34135:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21398, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34161:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "34135:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21399, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34200:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21400, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34207:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34200:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21401, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34226:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "34200:41:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21402, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34267:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21403, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34274:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34267:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21404, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34293:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "34267:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21405, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34331:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21406, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34338:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34331:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21407, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34357:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "34331:46:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21412, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21408, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "34403:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21409, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34409:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21410, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34416:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34409:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21411, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34435:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "34409:37:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "34403:43:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21413, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34472:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21414, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34479:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34472:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21415, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34498:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "34472:41:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21416, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "34539:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21417, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34546:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "34539:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21418, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "34565:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "34539:48:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21394, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "34046:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21395, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "34082:27:130", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23353, "src": "34046:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21419, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "34046:563:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "34019:590:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21421, "nodeType": "ExpressionStatement", "src": "34019:590:130" }, { "condition": { "id": 21423, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "34631:8:130", "subExpression": { "id": 21422, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "34632:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21427, "nodeType": "IfStatement", "src": "34627:289:130", "trueBody": { "id": 21426, "nodeType": "Block", "src": "34641:275:130", "statements": [{ "expression": { "hexValue": "30", "id": 21424, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "34896:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21425, "nodeType": "Return", "src": "34889:8:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21434, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21430, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "35102:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21431, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "35109:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "35102:20:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21429, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "35094:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21428, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "35094:7:130", "typeDescriptions": {} } }, "id": 21432, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "35094:29:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21433, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21389, "src": "35127:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "35094:46:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21536, "nodeType": "IfStatement", "src": "35090:3123:130", "trueBody": { "id": 21535, "nodeType": "Block", "src": "35142:3071:130", "statements": [{ "expression": { "id": 21441, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21435, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "35337:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21436, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "35376:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21437, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "35311:94:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21439, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "35495:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }], "id": 21438, "name": "calculateDistributeExcessIdleShareProceedsNetLongEdgeCaseSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21762, "src": "35408:61:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory) pure returns (uint256,bool)" } }, "id": 21440, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "35408:115:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "35311:212:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21442, "nodeType": "ExpressionStatement", "src": "35311:212:130" }, { "condition": { "id": 21444, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "35549:8:130", "subExpression": { "id": 21443, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "35550:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21448, "nodeType": "IfStatement", "src": "35545:200:130", "trueBody": { "id": 21447, "nodeType": "Block", "src": "35559:186:130", "statements": [{ "expression": { "hexValue": "30", "id": 21445, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "35721:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21446, "nodeType": "Return", "src": "35714:8:130" }] } }, { "expression": { "id": 21477, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "expression": { "expression": { "id": 21449, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "35929:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21452, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "35936:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "35929:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21453, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "35955:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "35929:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21454, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "35994:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21455, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36001:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "35994:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21456, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "36020:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "35994:41:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21457, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36061:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21458, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36068:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "36061:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21459, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "36087:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "36061:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21460, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "36125:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21461, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "35903:251:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21463, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36211:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21464, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36218:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "36211:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21465, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36265:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21466, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36272:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "36265:30:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "id": 21467, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36321:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21468, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36328:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "36321:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21469, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36374:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21470, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36381:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "36374:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21471, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36400:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "36374:46:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21475, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "36446:25:130", "subExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 21472, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "36447:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21473, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "36461:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "36447:22:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21474, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36447:24:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21462, "name": "calculateUpdateLiquiditySafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20547, "src": "36157:28:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,int256) pure returns (uint256,int256,uint256,bool)" } }, "id": 21476, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36157:336:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_int256_$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,int256,uint256,bool)" } }, "src": "35903:590:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21478, "nodeType": "ExpressionStatement", "src": "35903:590:130" }, { "condition": { "id": 21480, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "36519:8:130", "subExpression": { "id": 21479, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "36520:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21484, "nodeType": "IfStatement", "src": "36515:200:130", "trueBody": { "id": 21483, "nodeType": "Block", "src": "36529:186:130", "statements": [{ "expression": { "hexValue": "30", "id": 21481, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "36691:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21482, "nodeType": "Return", "src": "36684:8:130" }] } }, { "expression": { "id": 21514, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21485, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21389, "src": "36737:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21486, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "36752:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21487, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "36736:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 21490, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36860:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21491, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36867:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "36860:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21492, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36886:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "36860:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21493, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "36929:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21494, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36936:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "36929:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21495, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "36955:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "36929:41:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "expression": { "expression": { "id": 21496, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "37000:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21497, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37007:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "37000:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21498, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37026:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "37000:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21499, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "37068:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21500, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37075:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "37068:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21501, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37094:20:130", "memberName": "minimumShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20559, "src": "37068:46:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21506, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21502, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "37144:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21503, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "37150:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21504, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37158:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "37150:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21505, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37177:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "37150:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "37144:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21507, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "37218:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21508, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37225:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "37218:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21509, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37244:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "37218:41:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21510, "name": "params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21385, "src": "37289:6:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21511, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37296:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "37289:25:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21512, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37315:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "37289:48:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21488, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "36763:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21489, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "36803:27:130", "memberName": "calculateMaxSellBondsInSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23353, "src": "36763:67:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21513, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "36763:600:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "36736:627:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21515, "nodeType": "ExpressionStatement", "src": "36736:627:130" }, { "condition": { "id": 21517, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "37389:8:130", "subExpression": { "id": 21516, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "37390:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21521, "nodeType": "IfStatement", "src": "37385:200:130", "trueBody": { "id": 21520, "nodeType": "Block", "src": "37399:186:130", "statements": [{ "expression": { "hexValue": "30", "id": 21518, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "37561:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21519, "nodeType": "Return", "src": "37554:8:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21528, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21522, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21389, "src": "37883:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "arguments": [{ "expression": { "id": 21525, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "37908:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21526, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "37916:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "37908:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21524, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "37900:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21523, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "37900:7:130", "typeDescriptions": {} } }, "id": 21527, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "37900:30:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "37883:47:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21533, "nodeType": "Block", "src": "38138:57:130", "statements": [{ "id": 21532, "nodeType": "Continue", "src": "38164:8:130" }] }, "id": 21534, "nodeType": "IfStatement", "src": "37879:316:130", "trueBody": { "id": 21531, "nodeType": "Block", "src": "37932:69:130", "statements": [{ "expression": { "id": 21529, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "37965:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21284, "id": 21530, "nodeType": "Return", "src": "37958:20:130" }] } }] } }] } }, { "assignments": [21540], "declarations": [{ "constant": false, "id": 21540, "mutability": "mutable", "name": "derivative", "nameLocation": "38511:10:130", "nodeType": "VariableDeclaration", "scope": 21648, "src": "38503:18:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21539, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "38503:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21541, "nodeType": "VariableDeclarationStatement", "src": "38503:18:130" }, { "expression": { "id": 21551, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21542, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "38553:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21543, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "38581:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21544, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "38535:67:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21546, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "38672:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, { "id": 21547, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21278, "src": "38697:31:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21548, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "38746:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21549, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "38754:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "38746:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21545, "name": "calculateSharesDeltaGivenBondsDeltaDerivativeSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22263, "src": "38605:49:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_DistributeExcessIdleParams_$21060_memory_ptr_$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (struct LPMath.DistributeExcessIdleParams memory,uint256,int256) pure returns (uint256,bool)" } }, "id": 21550, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "38605:176:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "38535:246:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21552, "nodeType": "ExpressionStatement", "src": "38535:246:130" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21558, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21554, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "38799:8:130", "subExpression": { "id": 21553, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21326, "src": "38800:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21557, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21555, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "38811:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 21556, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "38825:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "38811:17:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "38799:29:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21562, "nodeType": "IfStatement", "src": "38795:189:130", "trueBody": { "id": 21561, "nodeType": "Block", "src": "38830:154:130", "statements": [{ "expression": { "hexValue": "30", "id": 21559, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "38968:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21560, "nodeType": "Return", "src": "38961:8:130" }] } }, { "id": 21569, "nodeType": "UncheckedBlock", "src": "38997:72:130", "statements": [{ "expression": { "id": 21567, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21563, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "39025:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21566, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21564, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "39038:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21565, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "39044:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39038:16:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39025:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21568, "nodeType": "ExpressionStatement", "src": "39025:29:130" }] }, { "assignments": [21571], "declarations": [{ "constant": false, "id": 21571, "mutability": "mutable", "name": "delta", "nameLocation": "39363:5:130", "nodeType": "VariableDeclaration", "scope": 21648, "src": "39356:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21570, "name": "int256", "nodeType": "ElementaryTypeName", "src": "39356:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 21587, "initialValue": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21586, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "id": 21574, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21286, "src": "39392:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21572, "name": "presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21365, "src": "39371:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21573, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39384:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "39371:20:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21575, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39371:35:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21576, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39407:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "39371:44:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21577, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39371:46:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 21581, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "39513:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21582, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "39521:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "39513:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21578, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21276, "src": "39436:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21579, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "39465:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "39436:49:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21580, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39507:5:130", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18902, "src": "39436:76:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21583, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39436:105:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21584, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39563:8:130", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "39436:135:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 21585, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39436:137:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "39371:202:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "39356:217:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21590, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21588, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21571, "src": "39591:5:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "hexValue": "30", "id": 21589, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "39599:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "39591:9:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21609, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21607, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21571, "src": "39846:5:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "hexValue": "30", "id": 21608, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "39854:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "39846:9:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21641, "nodeType": "Block", "src": "40442:38:130", "statements": [{ "id": 21640, "nodeType": "Break", "src": "40460:5:130" }] }, "id": 21642, "nodeType": "IfStatement", "src": "39842:638:130", "trueBody": { "id": 21639, "nodeType": "Block", "src": "39857:579:130", "statements": [{ "assignments": [21611], "declarations": [{ "constant": false, "id": 21611, "mutability": "mutable", "name": "delta_", "nameLocation": "39955:6:130", "nodeType": "VariableDeclaration", "scope": 21639, "src": "39947:14:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21610, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39947:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21623, "initialValue": { "arguments": [{ "id": 21621, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21286, "src": "40029:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21618, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "39988:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21615, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "39972:6:130", "subExpression": { "id": 21614, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21571, "src": "39973:5:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21613, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "39964:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21612, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39964:7:130", "typeDescriptions": {} } }, "id": 21616, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:15:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21617, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39980:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "39964:23:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21619, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:35:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21620, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "40000:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "39964:43:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21622, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39964:96:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "39947:113:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21626, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21624, "name": "delta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21611, "src": "40082:6:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21625, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "40091:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40082:22:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21637, "nodeType": "Block", "src": "40249:173:130", "statements": [{ "expression": { "hexValue": "30", "id": 21635, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "40402:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "functionReturnParameters": 21284, "id": 21636, "nodeType": "Return", "src": "40395:8:130" }] }, "id": 21638, "nodeType": "IfStatement", "src": "40078:344:130", "trueBody": { "id": 21634, "nodeType": "Block", "src": "40106:137:130", "statements": [{ "id": 21633, "nodeType": "UncheckedBlock", "src": "40128:97:130", "statements": [{ "expression": { "id": 21631, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21627, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "40164:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21630, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21628, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "40180:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21629, "name": "delta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21611, "src": "40196:6:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40180:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "40164:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21632, "nodeType": "ExpressionStatement", "src": "40164:38:130" }] }] } }] } }, "id": 21643, "nodeType": "IfStatement", "src": "39587:893:130", "trueBody": { "id": 21606, "nodeType": "Block", "src": "39602:234:130", "statements": [{ "expression": { "id": 21604, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21591, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "39692:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21603, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21592, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "39728:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 21601, "name": "lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21286, "src": "39807:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21598, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21540, "src": "39787:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 21595, "name": "delta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21571, "src": "39772:5:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21594, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "39764:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21593, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "39764:7:130", "typeDescriptions": {} } }, "id": 21596, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:14:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21597, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39779:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "39764:22:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21599, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:34:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21600, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "39799:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "39764:42:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21602, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "39764:57:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39728:93:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "39692:129:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21605, "nodeType": "ExpressionStatement", "src": "39692:129:130" }] } }, { "id": 21647, "nodeType": "UncheckedBlock", "src": "40537:46:130", "statements": [{ "expression": { "id": 21645, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "++", "prefix": true, "src": "40565:3:130", "subExpression": { "id": 21644, "name": "i", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21312, "src": "40567:1:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21646, "nodeType": "ExpressionStatement", "src": "40565:3:130" }] }] }, "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21317, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21315, "name": "i", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21312, "src": "31857:1:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21316, "name": "SHARE_PROCEEDS_MAX_ITERATIONS", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20343, "src": "31861:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "31857:33:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21649, "initializationExpression": { "assignments": [21312], "declarations": [{ "constant": false, "id": 21312, "mutability": "mutable", "name": "i", "nameLocation": "31850:1:130", "nodeType": "VariableDeclaration", "scope": 21649, "src": "31842:9:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21311, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "31842:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21314, "initialValue": { "hexValue": "30", "id": 21313, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "31854:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "nodeType": "VariableDeclarationStatement", "src": "31842:13:130" }, "nodeType": "ForStatement", "src": "31837:8756:130" }, { "expression": { "id": 21650, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21294, "src": "40610:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 21284, "id": 21651, "nodeType": "Return", "src": "40603:20:130" }] }, "documentation": { "id": 21273, "nodeType": "StructuredDocumentation", "src": "29411:871:130", "text": "@dev Calculates the share proceeds to distribute to the withdrawal pool\n      assuming that all of the outstanding withdrawal shares will be\n      redeemed. The share proceeds are calculated such that the LP share\n      price is conserved. When we need to round, we round down to err on\n      the side of slightly too few shares being paid out.\n @param _params The parameters for the distribute excess idle calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @param _maxShareReservesDelta The maximum change in the share reserves\n        that can result from distributing excess idle. This provides an\n        upper bound on the share proceeds returned from this calculation.\n @return The share proceeds to distribute to the withdrawal pool." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleShareProceeds", "nameLocation": "30296:42:130", "parameters": { "id": 21281, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21276, "mutability": "mutable", "name": "_params", "nameLocation": "30382:7:130", "nodeType": "VariableDeclaration", "scope": 21653, "src": "30348:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21275, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21274, "name": "DistributeExcessIdleParams", "nameLocations": ["30348:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "30348:26:130" }, "referencedDeclaration": 21060, "src": "30348:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21278, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "30407:31:130", "nodeType": "VariableDeclaration", "scope": 21653, "src": "30399:39:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21277, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30399:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21280, "mutability": "mutable", "name": "_maxShareReservesDelta", "nameLocation": "30456:22:130", "nodeType": "VariableDeclaration", "scope": 21653, "src": "30448:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21279, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30448:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "30338:146:130" }, "returnParameters": { "id": 21284, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21283, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21653, "src": "30508:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21282, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "30508:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "30507:9:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21762, "nodeType": "FunctionDefinition", "src": "42321:1866:130", "nodes": [], "body": { "id": 21761, "nodeType": "Block", "src": "42487:1700:130", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21667, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21664, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "42728:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21665, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "42736:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "42728:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "hexValue": "30", "id": 21666, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "42763:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "42728:36:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21673, "nodeType": "IfStatement", "src": "42724:84:130", "trueBody": { "id": 21672, "nodeType": "Block", "src": "42766:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21668, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "42788:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21669, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "42791:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21670, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "42787:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21663, "id": 21671, "nodeType": "Return", "src": "42780:17:130" }] } }, { "assignments": [21675], "declarations": [{ "constant": false, "id": 21675, "mutability": "mutable", "name": "netFlatTrade", "nameLocation": "42866:12:130", "nodeType": "VariableDeclaration", "scope": 21761, "src": "42859:19:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21674, "name": "int256", "nodeType": "ElementaryTypeName", "src": "42859:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 21680, "initialValue": { "arguments": [{ "expression": { "id": 21677, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "42903:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21678, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "42911:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "42903:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" }], "id": 21676, "name": "calculateNetFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21040, "src": "42881:21:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_PresentValueParams_$20572_memory_ptr_$returns$_t_int256_$", "typeString": "function (struct LPMath.PresentValueParams memory) pure returns (int256)" } }, "id": 21679, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "42881:49:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "42859:71:130" }, { "assignments": [21682], "declarations": [{ "constant": false, "id": 21682, "mutability": "mutable", "name": "rhs", "nameLocation": "43081:3:130", "nodeType": "VariableDeclaration", "scope": 21761, "src": "43073:11:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21681, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43073:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21694, "initialValue": { "arguments": [{ "expression": { "id": 21686, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43138:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21687, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43146:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "43138:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21692, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21688, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43179:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21689, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43187:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "43179:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "expression": { "id": 21690, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43209:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21691, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43217:27:130", "memberName": "withdrawalSharesTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21049, "src": "43209:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43179:65:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21683, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43087:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21684, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43095:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "43087:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21685, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "43116:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "43087:37:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21693, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43087:167:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "43073:181:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21697, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21695, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21675, "src": "43268:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21696, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "43284:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "43268:17:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21728, "nodeType": "Block", "src": "43621:54:130", "statements": [{ "expression": { "id": 21726, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21720, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "43635:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [{ "id": 21724, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "43650:13:130", "subExpression": { "id": 21723, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21675, "src": "43651:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21722, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43642:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21721, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43642:7:130", "typeDescriptions": {} } }, "id": 21725, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43642:22:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43635:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21727, "nodeType": "ExpressionStatement", "src": "43635:29:130" }] }, "id": 21729, "nodeType": "IfStatement", "src": "43264:411:130", "trueBody": { "id": 21719, "nodeType": "Block", "src": "43287:328:130", "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21703, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "id": 21700, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21675, "src": "43313:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21699, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43305:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21698, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43305:7:130", "typeDescriptions": {} } }, "id": 21701, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43305:21:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21702, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "43329:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43305:27:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21717, "nodeType": "Block", "src": "43451:154:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21713, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "43581:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21714, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "43584:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21715, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "43580:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21663, "id": 21716, "nodeType": "Return", "src": "43573:17:130" }] }, "id": 21718, "nodeType": "IfStatement", "src": "43301:304:130", "trueBody": { "id": 21712, "nodeType": "Block", "src": "43334:111:130", "statements": [{ "id": 21711, "nodeType": "UncheckedBlock", "src": "43352:79:130", "statements": [{ "expression": { "id": 21709, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21704, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "43384:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "arguments": [{ "id": 21707, "name": "netFlatTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21675, "src": "43399:12:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21706, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43391:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21705, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43391:7:130", "typeDescriptions": {} } }, "id": 21708, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43391:21:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43384:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21710, "nodeType": "ExpressionStatement", "src": "43384:28:130" }] }] } }] } }, { "expression": { "id": 21741, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21730, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "43832:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21734, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "43890:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "expression": { "id": 21737, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43915:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21738, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43923:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "43915:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21736, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "43907:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21735, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "43907:7:130", "typeDescriptions": {} } }, "id": 21739, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43907:40:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21731, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "43838:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21732, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "43846:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "43838:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21733, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "43868:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "43838:38:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21740, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "43838:119:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "43832:125:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21742, "nodeType": "ExpressionStatement", "src": "43832:125:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21746, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21743, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "44008:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21744, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "44016:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "44008:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 21745, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "44040:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "44008:35:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21752, "nodeType": "IfStatement", "src": "44004:83:130", "trueBody": { "id": 21751, "nodeType": "Block", "src": "44045:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21747, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "44067:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21748, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "44070:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21749, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "44066:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21663, "id": 21750, "nodeType": "Return", "src": "44059:17:130" }] } }, { "id": 21760, "nodeType": "UncheckedBlock", "src": "44096:85:130", "statements": [{ "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21756, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21753, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21657, "src": "44128:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21754, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "44136:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "44128:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21755, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21682, "src": "44160:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "44128:35:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21757, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "44165:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21758, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "44127:43:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21663, "id": 21759, "nodeType": "Return", "src": "44120:50:130" }] }] }, "documentation": { "id": 21654, "nodeType": "StructuredDocumentation", "src": "40636:1680:130", "text": "@dev One of the edge cases that occurs when using Newton's method for\n      the share proceeds while distributing excess idle is when the net\n      curve trade is larger than the max bond amount. In this case, the\n      the present value simplifies to the following:\n      PV(dz) = (z - dz) + net_c(dz) + net_f - z_min\n             = (z - dz) - y_max_out(dz) + net_f - z_min\n      There are two cases to evaluate:\n      (1) zeta > 0:\n          z_max_out(dz) = ((z - dz) / z) * (z - zeta) - z_min\n          =>\n          PV(dz) = zeta * ((z - dz) / z) + net_f\n      (2) zeta <= 0:\n          z_max_out(dz) = (z - dz) - z_min\n          =>\n          PV(dz) = net_f\n      Since the present value is constant with respect to the share\n      proceeds in case 2, Newton's method has achieved a stationary point\n      and can't proceed. On the other hand, the present value is linear\n      with respect to the share proceeds, and we can solve for the next\n      step of Newton's method directly as follows:\n      PV(0) / l = PV(dz) / (l - w)\n      =>\n      dz = z - ((PV(0) / l) * (l - w) - net_f) / (zeta / z)\n      We round the share proceeds down to err on the side of the\n      withdrawal pool receiving slightly less shares.\n @param _params The parameters for the calculation.\n @return The share proceeds.\n @return A flag indicating whether the calculation was successful." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateDistributeExcessIdleShareProceedsNetLongEdgeCaseSafe", "nameLocation": "42330:61:130", "parameters": { "id": 21658, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21657, "mutability": "mutable", "name": "_params", "nameLocation": "42435:7:130", "nodeType": "VariableDeclaration", "scope": 21762, "src": "42401:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21656, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21655, "name": "DistributeExcessIdleParams", "nameLocations": ["42401:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "42401:26:130" }, "referencedDeclaration": 21060, "src": "42401:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }], "src": "42391:57:130" }, "returnParameters": { "id": 21663, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21660, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21762, "src": "42472:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21659, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "42472:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21662, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21762, "src": "42481:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21661, "name": "bool", "nodeType": "ElementaryTypeName", "src": "42481:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "42471:15:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21804, "nodeType": "FunctionDefinition", "src": "44905:1269:130", "nodes": [], "body": { "id": 21803, "nodeType": "Block", "src": "45115:1059:130", "nodes": [], "statements": [{ "expression": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21801, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21785, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21777, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21766, "src": "45422:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21778, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45430:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "45422:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21775, "name": "_presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21770, "src": "45400:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21776, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45414:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "45400:21:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21779, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45400:50:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "arguments": [{ "id": 21783, "name": "_lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21768, "src": "45567:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 21780, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21766, "src": "45532:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21781, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45540:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "45532:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21782, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45561:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "45532:34:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21784, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45532:50:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "45400:182:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "&&", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21800, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "expression": { "id": 21788, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21766, "src": "45916:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21789, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "45924:19:130", "memberName": "activeLpTotalSupply", "nodeType": "MemberAccess", "referencedDeclaration": 21047, "src": "45916:27:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21786, "name": "_presentValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21770, "src": "45896:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21787, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "45910:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "45896:19:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21790, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "45896:48:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "arguments": [{ "expression": { "id": 21796, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21766, "src": "46093:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21797, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "46101:20:130", "memberName": "startingPresentValue", "nodeType": "MemberAccess", "referencedDeclaration": 21045, "src": "46093:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21798, "name": "_lpTotalSupply", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21768, "src": "46139:14:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21793, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "leftExpression": { "id": 21791, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "46029:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 21792, "name": "SHARE_PROCEEDS_MIN_TOLERANCE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20347, "src": "46035:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "46029:34:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 21794, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "46028:36:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21795, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "46065:10:130", "memberName": "mulDivDown", "nodeType": "MemberAccess", "referencedDeclaration": 18834, "src": "46028:47:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 21799, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "46028:139:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "45896:271:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "45400:767:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "functionReturnParameters": 21774, "id": 21802, "nodeType": "Return", "src": "45125:1042:130" }] }, "documentation": { "id": 21763, "nodeType": "StructuredDocumentation", "src": "44193:707:130", "text": "@dev Checks to see if we should short-circuit the iterative calculation\n     of the share proceeds when distributing excess idle liquidity. This\n     verifies that the ending LP share price is greater than or equal to\n     the starting LP share price and less than or equal to the starting\n     LP share price plus the minimum tolerance.\n @param _params The parameters for the calculation.\n @param _lpTotalSupply The total supply of LP shares.\n @param _presentValue The present value of the pool at this iteration of\n        the calculation.\n @return A flag indicating whether or not we should short-circuit the\n         calculation." }, "implemented": true, "kind": "function", "modifiers": [], "name": "shouldShortCircuitDistributeExcessIdleShareProceeds", "nameLocation": "44914:51:130", "parameters": { "id": 21771, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21766, "mutability": "mutable", "name": "_params", "nameLocation": "45009:7:130", "nodeType": "VariableDeclaration", "scope": 21804, "src": "44975:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21765, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21764, "name": "DistributeExcessIdleParams", "nameLocations": ["44975:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "44975:26:130" }, "referencedDeclaration": 21060, "src": "44975:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21768, "mutability": "mutable", "name": "_lpTotalSupply", "nameLocation": "45034:14:130", "nodeType": "VariableDeclaration", "scope": 21804, "src": "45026:22:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21767, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "45026:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21770, "mutability": "mutable", "name": "_presentValue", "nameLocation": "45066:13:130", "nodeType": "VariableDeclaration", "scope": 21804, "src": "45058:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21769, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "45058:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "44965:120:130" }, "returnParameters": { "id": 21774, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21773, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 21804, "src": "45109:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21772, "name": "bool", "nodeType": "ElementaryTypeName", "src": "45109:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "45108:6:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 21922, "nodeType": "FunctionDefinition", "src": "46936:3239:130", "nodes": [], "body": { "id": 21921, "nodeType": "Block", "src": "47154:3021:130", "nodes": [], "statements": [{ "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21820, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 21817, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47304:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21818, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47312:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "47304:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21819, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "47329:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "47304:26:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21827, "nodeType": "IfStatement", "src": "47300:84:130", "trueBody": { "id": 21826, "nodeType": "Block", "src": "47332:52:130", "statements": [{ "expression": { "components": [{ "expression": { "id": 21821, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47354:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21822, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47362:4:130", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 21051, "src": "47354:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21823, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "47368:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21824, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "47353:20:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21816, "id": 21825, "nodeType": "Return", "src": "47346:27:130" }] } }, { "assignments": [21829], "declarations": [{ "constant": false, "id": 21829, "mutability": "mutable", "name": "netCurveTrade", "nameLocation": "47401:13:130", "nodeType": "VariableDeclaration", "scope": 21921, "src": "47393:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21828, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47393:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21836, "initialValue": { "arguments": [{ "id": 21834, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "47425:22:130", "subExpression": { "expression": { "id": 21832, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47426:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21833, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47434:13:130", "memberName": "netCurveTrade", "nodeType": "MemberAccess", "referencedDeclaration": 21053, "src": "47426:21:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21831, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "47417:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21830, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47417:7:130", "typeDescriptions": {} } }, "id": 21835, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "47417:31:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "47393:55:130" }, { "assignments": [21838], "declarations": [{ "constant": false, "id": 21838, "mutability": "mutable", "name": "maxBondAmount", "nameLocation": "47705:13:130", "nodeType": "VariableDeclaration", "scope": 21921, "src": "47697:21:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21837, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47697:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21839, "nodeType": "VariableDeclarationStatement", "src": "47697:21:130" }, { "expression": { "id": 21860, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 21840, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21838, "src": "47729:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 21841, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21815, "src": "47744:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }], "id": 21842, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "47728:24:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 21845, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21810, "src": "47811:31:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 21846, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47856:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21847, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47864:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "47856:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21852, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21848, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "47898:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 21849, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47904:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21850, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47912:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "47904:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21851, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47931:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "47904:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "47898:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21853, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "47956:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21854, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47964:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "47956:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21855, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "47983:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "47956:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21856, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "48012:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21857, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "48020:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "48012:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21858, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "48039:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "48012:49:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21843, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "47755:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 21844, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "47770:27:130", "memberName": "calculateMaxBuyBondsOutSafe", "nodeType": "MemberAccess", "referencedDeclaration": 23222, "src": "47755:42:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256,bool)" } }, "id": 21859, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "47755:316:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "src": "47728:343:130", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 21861, "nodeType": "ExpressionStatement", "src": "47728:343:130" }, { "condition": { "commonType": { "typeIdentifier": "t_bool", "typeString": "bool" }, "id": 21867, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21863, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "48085:8:130", "subExpression": { "id": 21862, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21815, "src": "48086:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "BinaryOperation", "operator": "||", "rightExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21866, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21864, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21838, "src": "48097:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "==", "rightExpression": { "hexValue": "30", "id": 21865, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "48114:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "48097:18:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "src": "48085:30:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21873, "nodeType": "IfStatement", "src": "48081:78:130", "trueBody": { "id": 21872, "nodeType": "Block", "src": "48117:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21868, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "48139:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21869, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "48142:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21870, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "48138:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21816, "id": 21871, "nodeType": "Return", "src": "48131:17:130" }] } }, { "assignments": [21875], "declarations": [{ "constant": false, "id": 21875, "mutability": "mutable", "name": "maxScalingFactor", "nameLocation": "49190:16:130", "nodeType": "VariableDeclaration", "scope": 21921, "src": "49182:24:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21874, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "49182:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21880, "initialValue": { "arguments": [{ "id": 21878, "name": "maxBondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21838, "src": "49229:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21876, "name": "netCurveTrade", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21829, "src": "49209:13:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21877, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "49223:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "49209:19:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21879, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "49209:34:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "49182:61:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21883, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21881, "name": "maxScalingFactor", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21875, "src": "49426:16:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<=", "rightExpression": { "id": 21882, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "49446:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49426:23:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21904, "nodeType": "Block", "src": "49698:177:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21900, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "49855:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21901, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "49858:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21902, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "49854:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21816, "id": 21903, "nodeType": "Return", "src": "49847:17:130" }] }, "id": 21905, "nodeType": "IfStatement", "src": "49422:453:130", "trueBody": { "id": 21899, "nodeType": "Block", "src": "49451:241:130", "statements": [{ "id": 21890, "nodeType": "UncheckedBlock", "src": "49465:89:130", "statements": [{ "expression": { "id": 21888, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21884, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21813, "src": "49493:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21887, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21885, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "49517:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21886, "name": "maxScalingFactor", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21875, "src": "49523:16:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49517:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49493:46:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21889, "nodeType": "ExpressionStatement", "src": "49493:46:130" }] }, { "expression": { "id": 21897, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21891, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21813, "src": "49567:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 21894, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "49638:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21895, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "49646:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "49638:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 21892, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21813, "src": "49591:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21893, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "49613:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "49591:29:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 21896, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "49591:90:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "49567:114:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21898, "nodeType": "ExpressionStatement", "src": "49567:114:130" }] } }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21909, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21906, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21813, "src": "50033:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "expression": { "id": 21907, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "50057:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21908, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "50065:4:130", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 21051, "src": "50057:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "50033:36:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 21916, "nodeType": "IfStatement", "src": "50029:94:130", "trueBody": { "id": 21915, "nodeType": "Block", "src": "50071:52:130", "statements": [{ "expression": { "components": [{ "expression": { "id": 21910, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21808, "src": "50093:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21911, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "50101:4:130", "memberName": "idle", "nodeType": "MemberAccess", "referencedDeclaration": 21051, "src": "50093:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21912, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "50107:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21913, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "50092:20:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21816, "id": 21914, "nodeType": "Return", "src": "50085:27:130" }] } }, { "expression": { "components": [{ "id": 21917, "name": "maxShareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21813, "src": "50140:21:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 21918, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "50163:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 21919, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "50139:29:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21816, "id": 21920, "nodeType": "Return", "src": "50132:36:130" }] }, "documentation": { "id": 21805, "nodeType": "StructuredDocumentation", "src": "46180:751:130", "text": "@dev Calculates the upper bound on the share proceeds of distributing\n      excess idle. When the pool is net long or net neutral, the upper\n      bound is the amount of idle liquidity. When the pool is net short,\n      the upper bound is the share reserves delta that results in the\n      maximum amount of bonds that can be purchased being equal to the\n      net short position.\n @param _params The parameters for the distribute excess idle calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @return maxShareReservesDelta The upper bound on the share proceeds.\n @return success A flag indicating if the calculation succeeded." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateMaxShareReservesDeltaSafe", "nameLocation": "46945:34:130", "parameters": { "id": 21811, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21808, "mutability": "mutable", "name": "_params", "nameLocation": "47023:7:130", "nodeType": "VariableDeclaration", "scope": 21922, "src": "46989:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21807, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21806, "name": "DistributeExcessIdleParams", "nameLocations": ["46989:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "46989:26:130" }, "referencedDeclaration": 21060, "src": "46989:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21810, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "47048:31:130", "nodeType": "VariableDeclaration", "scope": 21922, "src": "47040:39:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21809, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47040:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "46979:106:130" }, "returnParameters": { "id": 21816, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21813, "mutability": "mutable", "name": "maxShareReservesDelta", "nameLocation": "47117:21:130", "nodeType": "VariableDeclaration", "scope": 21922, "src": "47109:29:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21812, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "47109:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21815, "mutability": "mutable", "name": "success", "nameLocation": "47145:7:130", "nodeType": "VariableDeclaration", "scope": 21922, "src": "47140:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21814, "name": "bool", "nodeType": "ElementaryTypeName", "src": "47140:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "47108:45:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }, { "id": 22263, "nodeType": "FunctionDefinition", "src": "52581:5799:130", "nodes": [], "body": { "id": 22262, "nodeType": "Block", "src": "52812:5568:130", "nodes": [], "statements": [{ "assignments": [21938], "declarations": [{ "constant": false, "id": 21938, "mutability": "mutable", "name": "bondReserves", "nameLocation": "52903:12:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "52895:20:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21937, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52895:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21939, "nodeType": "VariableDeclarationStatement", "src": "52895:20:130" }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 21942, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21940, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21930, "src": "52929:11:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 21941, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "52944:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "52929:16:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21984, "nodeType": "Block", "src": "53087:508:130", "statements": [{ "assignments": [21956], "declarations": [{ "constant": false, "id": 21956, "mutability": "mutable", "name": "bondAmount", "nameLocation": "53109:10:130", "nodeType": "VariableDeclaration", "scope": 21984, "src": "53101:18:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21955, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53101:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 21962, "initialValue": { "arguments": [{ "id": 21960, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "53130:12:130", "subExpression": { "id": 21959, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21930, "src": "53131:11:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21958, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "53122:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21957, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53122:7:130", "typeDescriptions": {} } }, "id": 21961, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53122:21:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "53101:42:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21967, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 21963, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21956, "src": "53161:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "expression": { "expression": { "id": 21964, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "53174:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21965, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53182:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "53174:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21966, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53201:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "53174:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53161:52:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 21982, "nodeType": "Block", "src": "53419:166:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 21978, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "53561:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 21979, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "53564:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 21980, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "53560:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 21981, "nodeType": "Return", "src": "53553:17:130" }] }, "id": 21983, "nodeType": "IfStatement", "src": "53157:428:130", "trueBody": { "id": 21977, "nodeType": "Block", "src": "53215:198:130", "statements": [{ "id": 21976, "nodeType": "UncheckedBlock", "src": "53233:166:130", "statements": [{ "expression": { "id": 21974, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21968, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21938, "src": "53265:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21973, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "expression": { "id": 21969, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "53304:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21970, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53312:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "53304:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21971, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53331:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "53304:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 21972, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21956, "src": "53370:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53304:76:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "53265:115:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21975, "nodeType": "ExpressionStatement", "src": "53265:115:130" }] }] } }] }, "id": 21985, "nodeType": "IfStatement", "src": "52925:670:130", "trueBody": { "id": 21954, "nodeType": "Block", "src": "52947:134:130", "statements": [{ "expression": { "id": 21952, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 21943, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21938, "src": "52961:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 21951, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "expression": { "id": 21944, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "52992:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21945, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53000:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "52992:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21946, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53019:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "52992:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "id": 21949, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21930, "src": "53058:11:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 21948, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "53050:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 21947, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53050:7:130", "typeDescriptions": {} } }, "id": 21950, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53050:20:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "52992:78:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "52961:109:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 21953, "nodeType": "ExpressionStatement", "src": "52961:109:130" }] } }, { "assignments": [21987, 21989], "declarations": [{ "constant": false, "id": 21987, "mutability": "mutable", "name": "effectiveShareReserves", "nameLocation": "53863:22:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "53855:30:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21986, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "53855:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21989, "mutability": "mutable", "name": "success", "nameLocation": "53892:7:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "53887:12:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21988, "name": "bool", "nodeType": "ElementaryTypeName", "src": "53887:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 21999, "initialValue": { "arguments": [{ "expression": { "expression": { "id": 21992, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "53984:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21993, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "53992:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "53984:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21994, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54011:13:130", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20549, "src": "53984:40:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 21995, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54042:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 21996, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54050:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54042:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 21997, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54069:15:130", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 20551, "src": "54042:42:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "expression": { "id": 21990, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "53903:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 21991, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "53931:35:130", "memberName": "calculateEffectiveShareReservesSafe", "nodeType": "MemberAccess", "referencedDeclaration": 19800, "src": "53903:63:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$_t_bool_$", "typeString": "function (uint256,int256) pure returns (uint256,bool)" } }, "id": 21998, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "53903:195:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "nodeType": "VariableDeclarationStatement", "src": "53854:244:130" }, { "condition": { "id": 22001, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "54112:8:130", "subExpression": { "id": 22000, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21989, "src": "54113:7:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 22007, "nodeType": "IfStatement", "src": "54108:56:130", "trueBody": { "id": 22006, "nodeType": "Block", "src": "54122:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22002, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "54144:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 22003, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "54147:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 22004, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "54143:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 22005, "nodeType": "Return", "src": "54136:17:130" }] } }, { "assignments": [22009], "declarations": [{ "constant": false, "id": 22009, "mutability": "mutable", "name": "derivative", "nameLocation": "54181:10:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "54173:18:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 22008, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "54173:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 22042, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22041, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 22021, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54410:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22022, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54418:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54410:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22023, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54437:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "54410:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 22018, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21987, "src": "54365:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22014, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54256:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22015, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54281:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54256:43:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22016, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54317:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "54256:83:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22017, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54357:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "54256:108:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22019, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54256:132:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22020, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54406:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "54256:153:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22024, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54256:193:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22010, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54194:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22011, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54202:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54194:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22012, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54221:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "54194:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22013, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54237:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "54194:48:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22025, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54194:265:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 22035, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54656:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22036, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54664:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54656:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22037, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54683:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "54656:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22031, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54587:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22032, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54595:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54587:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22033, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54614:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "54587:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22034, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54627:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "54587:43:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22038, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54587:129:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22029, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21928, "src": "54526:31:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22030, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54558:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "54526:39:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22039, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54526:208:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 22026, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54474:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22027, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54482:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "54474:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22028, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54503:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "54474:34:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22040, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54474:274:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "54194:554:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "54173:575:130" }, { "assignments": [22044], "declarations": [{ "constant": false, "id": 22044, "mutability": "mutable", "name": "rhs", "nameLocation": "54826:3:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "54818:11:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 22043, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "54818:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 22058, "initialValue": { "arguments": [{ "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 22052, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54954:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22053, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54962:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "54954:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22054, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54981:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "54954:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22050, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21938, "src": "54937:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22051, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54950:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "54937:16:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22055, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54937:56:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22048, "name": "_originalEffectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21928, "src": "54882:31:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22049, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54914:5:130", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18902, "src": "54882:37:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22056, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54882:125:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "id": 22045, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "54832:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22046, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "54840:20:130", "memberName": "originalBondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21059, "src": "54832:28:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22047, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "54861:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "54832:36:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22057, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "54832:185:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "54818:199:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22061, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22059, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "55031:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 22060, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "55044:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55031:16:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 22067, "nodeType": "IfStatement", "src": "55027:64:130", "trueBody": { "id": 22066, "nodeType": "Block", "src": "55049:42:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22062, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "55071:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 22063, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "55074:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 22064, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "55070:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 22065, "nodeType": "Return", "src": "55063:17:130" }] } }, { "id": 22072, "nodeType": "UncheckedBlock", "src": "55100:52:130", "statements": [{ "expression": { "id": 22070, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22068, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "55124:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "id": 22069, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "55138:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55124:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22071, "nodeType": "ExpressionStatement", "src": "55124:17:130" }] }, { "assignments": [22074], "declarations": [{ "constant": false, "id": 22074, "mutability": "mutable", "name": "k", "nameLocation": "55389:1:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "55381:9:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 22073, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "55381:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 22093, "initialValue": { "arguments": [{ "id": 22077, "name": "effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21987, "src": "55425:22:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22078, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "55461:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22079, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55469:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "55461:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22080, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55488:12:130", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 20553, "src": "55461:39:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22085, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22081, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "55514:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22082, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "55520:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22083, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55528:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "55520:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22084, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55547:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "55520:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55514:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22086, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "55572:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22087, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55580:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "55572:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22088, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55599:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "55572:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22089, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "55628:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22090, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55636:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "55628:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22091, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55655:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "55628:49:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22075, "name": "YieldSpaceMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 23422, "src": "55393:14:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_YieldSpaceMath_$23422_$", "typeString": "type(library YieldSpaceMath)" } }, "id": 22076, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "55408:3:130", "memberName": "kUp", "nodeType": "MemberAccess", "referencedDeclaration": 23387, "src": "55393:18:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 22092, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "55393:294:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "55381:306:130" }, { "assignments": [22095], "declarations": [{ "constant": false, "id": 22095, "mutability": "mutable", "name": "inner", "nameLocation": "55705:5:130", "nodeType": "VariableDeclaration", "scope": 22262, "src": "55697:13:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 22094, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "55697:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 22104, "initialValue": { "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22102, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22098, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "55743:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22099, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "55749:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22100, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55757:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "55749:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22101, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "55776:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "55749:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55743:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22096, "name": "bondReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21938, "src": "55713:12:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22097, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "55726:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "55713:16:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22103, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "55713:84:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "55697:100:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22107, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22105, "name": "k", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22074, "src": "55811:1:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 22106, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "55815:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "55811:9:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 22113, "nodeType": "IfStatement", "src": "55807:201:130", "trueBody": { "id": 22112, "nodeType": "Block", "src": "55822:186:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22108, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "55988:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 22109, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "55991:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 22110, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "55987:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 22111, "nodeType": "Return", "src": "55980:17:130" }] } }, { "id": 22120, "nodeType": "UncheckedBlock", "src": "56017:52:130", "statements": [{ "expression": { "id": 22118, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22114, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56041:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22117, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22115, "name": "k", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22074, "src": "56049:1:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 22116, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56053:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56049:9:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56041:17:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22119, "nodeType": "ExpressionStatement", "src": "56041:17:130" }] }, { "expression": { "id": 22131, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22121, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56078:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "expression": { "id": 22124, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56114:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22125, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56122:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56114:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22126, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56141:22:130", "memberName": "initialVaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20557, "src": "56114:49:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22127, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56177:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22128, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56185:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56177:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22129, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56204:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "56177:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22122, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56086:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22123, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56092:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "56086:14:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 22130, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56086:143:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56078:151:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22132, "nodeType": "ExpressionStatement", "src": "56078:151:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22135, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22133, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56243:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 22134, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "56252:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56243:12:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22169, "nodeType": "Block", "src": "56541:282:130", "statements": [{ "expression": { "id": 22167, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22153, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56633:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22164, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22160, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "56736:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22161, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56742:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22162, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56750:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56742:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22163, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56769:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "56742:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56736:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22156, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56668:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22157, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56676:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56668:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22158, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56695:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "56668:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22159, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56707:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "56668:46:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22165, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56668:130:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22154, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56641:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22155, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56647:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "56641:9:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22166, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56641:171:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56633:179:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22168, "nodeType": "ExpressionStatement", "src": "56633:179:130" }] }, "id": 22170, "nodeType": "IfStatement", "src": "56239:584:130", "trueBody": { "id": 22152, "nodeType": "Block", "src": "56257:278:130", "statements": [{ "expression": { "id": 22150, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22136, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56347:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22147, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22143, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "56448:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "expression": { "expression": { "id": 22144, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56454:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22145, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56462:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56454:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22146, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56481:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "56454:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56448:44:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "expression": { "expression": { "id": 22139, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56382:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22140, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56390:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56382:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22141, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56409:11:130", "memberName": "timeStretch", "nodeType": "MemberAccess", "referencedDeclaration": 20563, "src": "56382:38:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22142, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56421:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "56382:44:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22148, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56382:128:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22137, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56355:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22138, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56361:3:130", "memberName": "pow", "nodeType": "MemberAccess", "referencedDeclaration": 18977, "src": "56355:9:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22149, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56355:169:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56347:177:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22151, "nodeType": "ExpressionStatement", "src": "56347:177:130" }] } }, { "expression": { "id": 22179, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22171, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "56910:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 22174, "name": "inner", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22095, "src": "56956:5:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "expression": { "id": 22175, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "56975:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22176, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "56983:18:130", "memberName": "presentValueParams", "nodeType": "MemberAccess", "referencedDeclaration": 21043, "src": "56975:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_PresentValueParams_$20572_memory_ptr", "typeString": "struct LPMath.PresentValueParams memory" } }, "id": 22177, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57002:15:130", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 20555, "src": "56975:42:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22172, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "56923:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22173, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "56934:8:130", "memberName": "mulDivUp", "nodeType": "MemberAccess", "referencedDeclaration": 18884, "src": "56923:19:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) pure returns (uint256)" } }, "id": 22178, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "56923:104:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "56910:117:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22180, "nodeType": "ExpressionStatement", "src": "56910:117:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22183, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22181, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "57081:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "id": 22182, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "57087:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57081:16:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22196, "nodeType": "Block", "src": "57201:274:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22192, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57456:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "74727565", "id": 22193, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "57459:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 22194, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "57455:9:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 22195, "nodeType": "Return", "src": "57448:16:130" }] }, "id": 22197, "nodeType": "IfStatement", "src": "57077:398:130", "trueBody": { "id": 22191, "nodeType": "Block", "src": "57099:96:130", "statements": [{ "id": 22190, "nodeType": "UncheckedBlock", "src": "57113:72:130", "statements": [{ "expression": { "id": 22188, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22184, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "57141:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22187, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22185, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "57154:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 22186, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "57160:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57154:16:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57141:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22189, "nodeType": "ExpressionStatement", "src": "57141:29:130" }] }] } }, { "condition": { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 22201, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 22198, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "57614:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22199, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57622:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "57614:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "hexValue": "30", "id": 22200, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57649:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, "src": "57614:36:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 22256, "nodeType": "Block", "src": "58098:240:130", "statements": [{ "expression": { "id": 22254, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22238, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "58112:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22252, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22241, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "58161:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "arguments": [{ "expression": { "id": 22249, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "58262:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22250, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "58270:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "58262:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 22246, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "-", "prefix": true, "src": "58195:32:130", "subExpression": { "expression": { "id": 22244, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "58196:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22245, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "58204:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "58196:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 22243, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "58187:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 22242, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "58187:7:130", "typeDescriptions": {} } }, "id": 22247, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58187:41:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22248, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58229:7:130", "memberName": "divDown", "nodeType": "MemberAccess", "referencedDeclaration": 18870, "src": "58187:49:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22251, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58187:126:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58161:152:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22239, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "58125:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22240, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58136:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "58125:18:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22253, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58125:202:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58112:215:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22255, "nodeType": "ExpressionStatement", "src": "58112:215:130" }] }, "id": 22257, "nodeType": "IfStatement", "src": "57610:728:130", "trueBody": { "id": 22237, "nodeType": "Block", "src": "57652:440:130", "statements": [{ "expression": { "id": 22212, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22202, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "57666:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "expression": { "id": 22209, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "57736:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22210, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57744:21:130", "memberName": "originalShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 21055, "src": "57736:29:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "expression": { "id": 22205, "name": "_params", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 21926, "src": "57680:7:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams memory" } }, "id": 22206, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "57688:23:130", "memberName": "originalShareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 21057, "src": "57680:31:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 22204, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "57672:7:130", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 22203, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "57672:7:130", "typeDescriptions": {} } }, "id": 22207, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "57672:40:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22208, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "57713:5:130", "memberName": "divUp", "nodeType": "MemberAccess", "referencedDeclaration": 18920, "src": "57672:46:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22211, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "57672:107:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57666:113:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22213, "nodeType": "ExpressionStatement", "src": "57666:113:130" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22216, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22214, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "57797:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">=", "rightExpression": { "id": 22215, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "57804:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "57797:10:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 22222, "nodeType": "IfStatement", "src": "57793:168:130", "trueBody": { "id": 22221, "nodeType": "Block", "src": "57809:152:130", "statements": [{ "expression": { "components": [{ "hexValue": "30", "id": 22217, "isConstant": false, "isLValue": false, "isPure": true, "kind": "number", "lValueRequested": false, "nodeType": "Literal", "src": "57937:1:130", "typeDescriptions": { "typeIdentifier": "t_rational_0_by_1", "typeString": "int_const 0" }, "value": "0" }, { "hexValue": "66616c7365", "id": 22218, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "57940:5:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "id": 22219, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "TupleExpression", "src": "57936:10:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_rational_0_by_1_$_t_bool_$", "typeString": "tuple(int_const 0,bool)" } }, "functionReturnParameters": 21936, "id": 22220, "nodeType": "Return", "src": "57929:17:130" }] } }, { "id": 22229, "nodeType": "UncheckedBlock", "src": "57974:58:130", "statements": [{ "expression": { "id": 22227, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22223, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "58002:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 22226, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 22224, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "58008:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 22225, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "58014:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58008:9:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58002:15:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22228, "nodeType": "ExpressionStatement", "src": "58002:15:130" }] }, { "expression": { "id": 22235, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 22230, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "58045:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 22233, "name": "rhs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22044, "src": "58077:3:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 22231, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "58058:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22232, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "58069:7:130", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "58058:18:130", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 22234, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "58058:23:130", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "58045:36:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 22236, "nodeType": "ExpressionStatement", "src": "58045:36:130" }] } }, { "expression": { "components": [{ "id": 22258, "name": "derivative", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22009, "src": "58356:10:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 22259, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "58368:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "id": 22260, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "58355:18:130", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_bool_$", "typeString": "tuple(uint256,bool)" } }, "functionReturnParameters": 21936, "id": 22261, "nodeType": "Return", "src": "58348:25:130" }] }, "documentation": { "id": 21923, "nodeType": "StructuredDocumentation", "src": "50181:2395:130", "text": "@dev Given a signed bond amount, this function calculates the negation\n      of the derivative of `calculateSharesOutGivenBondsIn` when the\n      bond amount is positive or the derivative of\n      `calculateSharesInGivenBondsOut` when the bond amount is negative.\n      In both cases, the calculation is given by:\n      derivative = (1 - zeta / z) * (\n          1 - (1 / c) * (\n              c * (mu * z_e(x)) ** -t_s +\n              (y / z_e) * y(x) ** -t_s  -\n              (y / z_e) * (y(x) + dy) ** -t_s\n          ) * (\n              (mu / c) * (k(x) - (y(x) + dy) ** (1 - t_s))\n          ) ** (t_s / (1 - t_s))\n      )\n      This quantity is used in Newton's method to search for the optimal\n      share proceeds. When the pool is net long, We can express the\n      derivative of the objective function F(x) by the derivative\n      -z_out'(x) that this function returns:\n      -F'(x) = l * -PV'(x)\n             = l * (1 - net_c'(x))\n             = l * (1 + z_out'(x))\n             = l * (1 - derivative)\n      When the pool is net short, we can express the derivative of the\n      objective function F(x) by the derivative z_in'(x) that this\n      function returns:\n      -F'(x) = l * -PV'(x)\n             = l * (1 - net_c'(x))\n             = l * (1 - z_in'(x))\n             = l * (1 - derivative)\n      With these calculations in mind, this function rounds its result\n      down so that F'(x) is overestimated. Since F'(x) is in the\n      denominator of Newton's method, overestimating F'(x) helps to avoid\n      overshooting the optimal solution.\n @param _params The parameters for the calculation.\n @param _originalEffectiveShareReserves The original effective share\n        reserves.\n @param _bondAmount The amount of bonds that are being bought or sold.\n @return The negation of the derivative of\n         `calculateSharesOutGivenBondsIn` when the bond amount is\n         positive or the derivative of `calculateSharesInGivenBondsOut`\n         when the bond amount is negative.\n @return A flag indicating whether the derivative could be computed." }, "implemented": true, "kind": "function", "modifiers": [], "name": "calculateSharesDeltaGivenBondsDeltaDerivativeSafe", "nameLocation": "52590:49:130", "parameters": { "id": 21931, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21926, "mutability": "mutable", "name": "_params", "nameLocation": "52683:7:130", "nodeType": "VariableDeclaration", "scope": 22263, "src": "52649:41:130", "stateVariable": false, "storageLocation": "memory", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_memory_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" }, "typeName": { "id": 21925, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 21924, "name": "DistributeExcessIdleParams", "nameLocations": ["52649:26:130"], "nodeType": "IdentifierPath", "referencedDeclaration": 21060, "src": "52649:26:130" }, "referencedDeclaration": 21060, "src": "52649:26:130", "typeDescriptions": { "typeIdentifier": "t_struct$_DistributeExcessIdleParams_$21060_storage_ptr", "typeString": "struct LPMath.DistributeExcessIdleParams" } }, "visibility": "internal" }, { "constant": false, "id": 21928, "mutability": "mutable", "name": "_originalEffectiveShareReserves", "nameLocation": "52708:31:130", "nodeType": "VariableDeclaration", "scope": 22263, "src": "52700:39:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21927, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52700:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21930, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "52756:11:130", "nodeType": "VariableDeclaration", "scope": 22263, "src": "52749:18:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 21929, "name": "int256", "nodeType": "ElementaryTypeName", "src": "52749:6:130", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "src": "52639:134:130" }, "returnParameters": { "id": 21936, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 21933, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 22263, "src": "52797:7:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 21932, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "52797:7:130", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 21935, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 22263, "src": "52806:4:130", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 21934, "name": "bool", "nodeType": "ElementaryTypeName", "src": "52806:4:130", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "src": "52796:15:130" }, "scope": 22264, "stateMutability": "pure", "virtual": false, "visibility": "internal" }], "abstract": false, "baseContracts": [], "canonicalName": "LPMath", "contractDependencies": [], "contractKind": "library", "documentation": { "id": 20334, "nodeType": "StructuredDocumentation", "src": "339:306:130", "text": "@author DELV\n @title LPMath\n @notice Math for the Hyperdrive LP system.\n @custom:disclaimer The language used in this code is for coding convenience\n                    only, and is not intended to, and does not, have any\n                    particular legal or regulatory significance." }, "fullyImplemented": true, "linearizedBaseContracts": [22264], "name": "LPMath", "nameLocation": "653:6:130", "scope": 22265, "usedErrors": [], "usedEvents": [] }], "license": "Apache-2.0" }, "id": 130 };

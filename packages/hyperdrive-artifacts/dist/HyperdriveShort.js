export const HyperdriveShort = { "abi": [{ "type": "event", "name": "AddLiquidity", "inputs": [{ "name": "provider", "type": "address", "indexed": true, "internalType": "address" }, { "name": "lpAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "lpSharePrice", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "Approval", "inputs": [{ "name": "owner", "type": "address", "indexed": true, "internalType": "address" }, { "name": "spender", "type": "address", "indexed": true, "internalType": "address" }, { "name": "value", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "ApprovalForAll", "inputs": [{ "name": "account", "type": "address", "indexed": true, "internalType": "address" }, { "name": "operator", "type": "address", "indexed": true, "internalType": "address" }, { "name": "approved", "type": "bool", "indexed": false, "internalType": "bool" }], "anonymous": false }, { "type": "event", "name": "CloseLong", "inputs": [{ "name": "trader", "type": "address", "indexed": true, "internalType": "address" }, { "name": "destination", "type": "address", "indexed": true, "internalType": "address" }, { "name": "assetId", "type": "uint256", "indexed": true, "internalType": "uint256" }, { "name": "maturityTime", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "bondAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "CloseShort", "inputs": [{ "name": "trader", "type": "address", "indexed": true, "internalType": "address" }, { "name": "destination", "type": "address", "indexed": true, "internalType": "address" }, { "name": "assetId", "type": "uint256", "indexed": true, "internalType": "uint256" }, { "name": "maturityTime", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "basePayment", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "bondAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "CollectGovernanceFee", "inputs": [{ "name": "collector", "type": "address", "indexed": true, "internalType": "address" }, { "name": "fees", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "CreateCheckpoint", "inputs": [{ "name": "checkpointTime", "type": "uint256", "indexed": true, "internalType": "uint256" }, { "name": "vaultSharePrice", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "maturedShorts", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "maturedLongs", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "lpSharePrice", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "FeeCollectorUpdated", "inputs": [{ "name": "newFeeCollector", "type": "address", "indexed": true, "internalType": "address" }], "anonymous": false }, { "type": "event", "name": "GovernanceUpdated", "inputs": [{ "name": "newGovernance", "type": "address", "indexed": true, "internalType": "address" }], "anonymous": false }, { "type": "event", "name": "Initialize", "inputs": [{ "name": "provider", "type": "address", "indexed": true, "internalType": "address" }, { "name": "lpAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "apr", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "OpenLong", "inputs": [{ "name": "trader", "type": "address", "indexed": true, "internalType": "address" }, { "name": "assetId", "type": "uint256", "indexed": true, "internalType": "uint256" }, { "name": "maturityTime", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "bondAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "OpenShort", "inputs": [{ "name": "trader", "type": "address", "indexed": true, "internalType": "address" }, { "name": "assetId", "type": "uint256", "indexed": true, "internalType": "uint256" }, { "name": "maturityTime", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "baseProceeds", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "bondAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "PauseStatusUpdated", "inputs": [{ "name": "isPaused", "type": "bool", "indexed": false, "internalType": "bool" }], "anonymous": false }, { "type": "event", "name": "PauserUpdated", "inputs": [{ "name": "newPauser", "type": "address", "indexed": true, "internalType": "address" }, { "name": "status", "type": "bool", "indexed": false, "internalType": "bool" }], "anonymous": false }, { "type": "event", "name": "RedeemWithdrawalShares", "inputs": [{ "name": "provider", "type": "address", "indexed": true, "internalType": "address" }, { "name": "destination", "type": "address", "indexed": true, "internalType": "address" }, { "name": "withdrawalShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }], "anonymous": false }, { "type": "event", "name": "RemoveLiquidity", "inputs": [{ "name": "provider", "type": "address", "indexed": true, "internalType": "address" }, { "name": "destination", "type": "address", "indexed": true, "internalType": "address" }, { "name": "lpAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "baseAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "vaultShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "asBase", "type": "bool", "indexed": false, "internalType": "bool" }, { "name": "withdrawalShareAmount", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "lpSharePrice", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "event", "name": "Sweep", "inputs": [{ "name": "collector", "type": "address", "indexed": true, "internalType": "address" }, { "name": "target", "type": "address", "indexed": true, "internalType": "address" }], "anonymous": false }, { "type": "event", "name": "SweepCollectorUpdated", "inputs": [{ "name": "newSweepCollector", "type": "address", "indexed": true, "internalType": "address" }], "anonymous": false }, { "type": "event", "name": "TransferSingle", "inputs": [{ "name": "operator", "type": "address", "indexed": true, "internalType": "address" }, { "name": "from", "type": "address", "indexed": true, "internalType": "address" }, { "name": "to", "type": "address", "indexed": true, "internalType": "address" }, { "name": "id", "type": "uint256", "indexed": false, "internalType": "uint256" }, { "name": "value", "type": "uint256", "indexed": false, "internalType": "uint256" }], "anonymous": false }, { "type": "error", "name": "ReentrancyGuardReentrantCall", "inputs": [] }], "bytecode": { "object": "0x", "sourceMap": "", "linkReferences": {} }, "deployedBytecode": { "object": "0x", "sourceMap": "", "linkReferences": {} }, "methodIdentifiers": {}, "rawMetadata": "{\"compiler\":{\"version\":\"0.8.20+commit.a1b79de6\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"name\":\"ReentrancyGuardReentrantCall\",\"type\":\"error\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"provider\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpSharePrice\",\"type\":\"uint256\"}],\"name\":\"AddLiquidity\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"spender\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"operator\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"approved\",\"type\":\"bool\"}],\"name\":\"ApprovalForAll\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"trader\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"destination\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturityTime\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"bondAmount\",\"type\":\"uint256\"}],\"name\":\"CloseLong\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"trader\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"destination\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturityTime\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"basePayment\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"bondAmount\",\"type\":\"uint256\"}],\"name\":\"CloseShort\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"collector\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"fees\",\"type\":\"uint256\"}],\"name\":\"CollectGovernanceFee\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"checkpointTime\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultSharePrice\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturedShorts\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturedLongs\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpSharePrice\",\"type\":\"uint256\"}],\"name\":\"CreateCheckpoint\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newFeeCollector\",\"type\":\"address\"}],\"name\":\"FeeCollectorUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newGovernance\",\"type\":\"address\"}],\"name\":\"GovernanceUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"provider\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"apr\",\"type\":\"uint256\"}],\"name\":\"Initialize\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"trader\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturityTime\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"bondAmount\",\"type\":\"uint256\"}],\"name\":\"OpenLong\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"trader\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"maturityTime\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseProceeds\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"bondAmount\",\"type\":\"uint256\"}],\"name\":\"OpenShort\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"isPaused\",\"type\":\"bool\"}],\"name\":\"PauseStatusUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newPauser\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"status\",\"type\":\"bool\"}],\"name\":\"PauserUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"provider\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"destination\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"withdrawalShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"}],\"name\":\"RedeemWithdrawalShares\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"provider\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"destination\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"baseAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"vaultShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"bool\",\"name\":\"asBase\",\"type\":\"bool\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"withdrawalShareAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"lpSharePrice\",\"type\":\"uint256\"}],\"name\":\"RemoveLiquidity\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"collector\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"target\",\"type\":\"address\"}],\"name\":\"Sweep\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newSweepCollector\",\"type\":\"address\"}],\"name\":\"SweepCollectorUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"operator\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"id\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"TransferSingle\",\"type\":\"event\"}],\"devdoc\":{\"author\":\"DELV\",\"custom:disclaimer\":\"The language used in this code is for coding convenience                    only, and is not intended to, and does not, have any                    particular legal or regulatory significance.\",\"errors\":{\"ReentrancyGuardReentrantCall()\":[{\"details\":\"Unauthorized reentrant call.\"}]},\"kind\":\"dev\",\"methods\":{},\"title\":\"HyperdriveShort\",\"version\":1},\"userdoc\":{\"events\":{\"AddLiquidity(address,uint256,uint256,uint256,bool,uint256)\":{\"notice\":\"Emitted when an LP adds liquidity to the Hyperdrive pool.\"},\"Approval(address,address,uint256)\":{\"notice\":\"Emitted when an account changes the allowance for another         account.\"},\"ApprovalForAll(address,address,bool)\":{\"notice\":\"Emitted when an account changes the approval for all of its         tokens.\"},\"CloseLong(address,address,uint256,uint256,uint256,uint256,bool,uint256)\":{\"notice\":\"Emitted when a long position is closed.\"},\"CloseShort(address,address,uint256,uint256,uint256,uint256,bool,uint256,uint256)\":{\"notice\":\"Emitted when a short position is closed.\"},\"CollectGovernanceFee(address,uint256)\":{\"notice\":\"Emitted when governance fees are collected.\"},\"CreateCheckpoint(uint256,uint256,uint256,uint256,uint256)\":{\"notice\":\"Emitted when a checkpoint is created.\"},\"FeeCollectorUpdated(address)\":{\"notice\":\"Emitted when the fee collector address is updated.\"},\"GovernanceUpdated(address)\":{\"notice\":\"Emitted when the governance address is updated.\"},\"Initialize(address,uint256,uint256,uint256,bool,uint256)\":{\"notice\":\"Emitted when the Hyperdrive pool is initialized.\"},\"OpenLong(address,uint256,uint256,uint256,uint256,bool,uint256)\":{\"notice\":\"Emitted when a long position is opened.\"},\"OpenShort(address,uint256,uint256,uint256,uint256,bool,uint256,uint256)\":{\"notice\":\"Emitted when a short position is opened.\"},\"PauseStatusUpdated(bool)\":{\"notice\":\"Emitted when the pause status is updated.\"},\"PauserUpdated(address,bool)\":{\"notice\":\"Emitted when a pauser is updated.\"},\"RedeemWithdrawalShares(address,address,uint256,uint256,uint256,bool)\":{\"notice\":\"Emitted when an LP redeems withdrawal shares.\"},\"RemoveLiquidity(address,address,uint256,uint256,uint256,bool,uint256,uint256)\":{\"notice\":\"Emitted when an LP removes liquidity from the Hyperdrive pool.\"},\"Sweep(address,address)\":{\"notice\":\"Emitted when tokens are swept.\"},\"SweepCollectorUpdated(address)\":{\"notice\":\"Emitted when the sweep collector address is updated.\"},\"TransferSingle(address,address,address,uint256,uint256)\":{\"notice\":\"Emitted when tokens are transferred from one account to another.\"}},\"kind\":\"user\",\"methods\":{},\"notice\":\"Implements the short accounting for Hyperdrive.\",\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/src/internal/HyperdriveShort.sol\":\"HyperdriveShort\"},\"evmVersion\":\"paris\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[\":@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/\",\":aave-v3-core/=lib/aave-v3-core/\",\":ds-test/=lib/forge-std/lib/ds-test/src/\",\":erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/\",\":forge-std/=lib/forge-std/src/\",\":openzeppelin-contracts/=lib/openzeppelin-contracts/\",\":openzeppelin/=lib/openzeppelin-contracts/contracts/\",\":solmate/=lib/solmate/src/\"]},\"sources\":{\"contracts/src/interfaces/IERC20.sol\":{\"keccak256\":\"0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac\",\"dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p\"]},\"contracts/src/interfaces/IHyperdrive.sol\":{\"keccak256\":\"0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf\",\"dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK\"]},\"contracts/src/interfaces/IHyperdriveCore.sol\":{\"keccak256\":\"0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24\",\"dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h\"]},\"contracts/src/interfaces/IHyperdriveEvents.sol\":{\"keccak256\":\"0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c\",\"dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG\"]},\"contracts/src/interfaces/IHyperdriveRead.sol\":{\"keccak256\":\"0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf\",\"dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6\"]},\"contracts/src/interfaces/IMultiToken.sol\":{\"keccak256\":\"0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7\",\"dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp\"]},\"contracts/src/interfaces/IMultiTokenCore.sol\":{\"keccak256\":\"0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae\",\"dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs\"]},\"contracts/src/interfaces/IMultiTokenEvents.sol\":{\"keccak256\":\"0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222\",\"dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK\"]},\"contracts/src/interfaces/IMultiTokenMetadata.sol\":{\"keccak256\":\"0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3\",\"dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG\"]},\"contracts/src/interfaces/IMultiTokenRead.sol\":{\"keccak256\":\"0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11\",\"dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR\"]},\"contracts/src/internal/HyperdriveBase.sol\":{\"keccak256\":\"0x7feb8df22e6f91b1ee70f50f5ca16a7819601bcb88fc5a5fa9cf16c708cc52bb\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://60ff7ff4faa45551099b025d03f2438477b5fd1f64f82b78c6ed26cbdafc64f6\",\"dweb:/ipfs/QmWtbftziGdSKAEvpRoaWRnTxMNwgUVs2nDN6nFugX1WYN\"]},\"contracts/src/internal/HyperdriveLP.sol\":{\"keccak256\":\"0x72410851e77940e66681e23b9d10f3c3de0e8c9a3e5b1cca627e93bba431775d\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://82a9292f388b16572cc5c5e873d1ead666ddcc3e436cf5d7fb036fd6c63ee9a2\",\"dweb:/ipfs/Qmauzxkn46ACS4XV43m2MbDF91KYP4ExYwSxL3cm1SDL6j\"]},\"contracts/src/internal/HyperdriveMultiToken.sol\":{\"keccak256\":\"0x21a9aafb8e23a22c77111e13538fa8f709446e4f3a64ef84b2eebc2aa9d04373\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://41517912353540de5b430587ca8220f9d34d4432d3c723951d5fb618d5907b5d\",\"dweb:/ipfs/QmU3cTCrAq94digVS97s5af1Pu86uGBpmpus6w7828fUbG\"]},\"contracts/src/internal/HyperdriveShort.sol\":{\"keccak256\":\"0xc42b5a9ee5eee3cb9177b136eb9f4b81a4b51d9468f8faa97309934b6b371bc5\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://b9291237fcdbb8ff97517acd19499cfa4afc6d670a89fd5cc0309a201a7b1006\",\"dweb:/ipfs/QmfQmUwvGhJgPFyNaHvur8AViePBzvSBNAdaZJBwMkY5Je\"]},\"contracts/src/internal/HyperdriveStorage.sol\":{\"keccak256\":\"0xf13ba4bcf41673bc04e4ae32a29c31b62514d66cfedee70b0d3bff574efc0e4a\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://e505639a656cf7c908e7c64cfd5cae6f4174a679de19d17a3f12f6e3fc4b2195\",\"dweb:/ipfs/QmNmcmz9nV9uDyeouo8yWAKMoMqEVx6JMTfZwCRa9QU83N\"]},\"contracts/src/libraries/AssetId.sol\":{\"keccak256\":\"0x3031a1ec376be333eebe0062c474a22d7f970cb02de62ab6823c6918c0a7f83b\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://6c80cc2fd8b7908b6420ebb21cb99266c93e01d6cdd9d1a41f8847493849b131\",\"dweb:/ipfs/QmeMehWbF2RwQaf6c6yaj5KHjXboDRpzBCtvFnLW4BXBbc\"]},\"contracts/src/libraries/Errors.sol\":{\"keccak256\":\"0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88\",\"dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41\"]},\"contracts/src/libraries/FixedPointMath.sol\":{\"keccak256\":\"0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd\",\"dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L\"]},\"contracts/src/libraries/HyperdriveMath.sol\":{\"keccak256\":\"0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002\",\"dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY\"]},\"contracts/src/libraries/LPMath.sol\":{\"keccak256\":\"0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f\",\"dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ\"]},\"contracts/src/libraries/SafeCast.sol\":{\"keccak256\":\"0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8\",\"dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8\"]},\"contracts/src/libraries/YieldSpaceMath.sol\":{\"keccak256\":\"0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891\",\"license\":\"Apache-2.0\",\"urls\":[\"bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c\",\"dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy\"]},\"lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol\":{\"keccak256\":\"0xf980daa263b661ab8ddee7d4fd833c7da7e7995e2c359ff1f17e67e4112f2236\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://7448ab095d6940130bcf76ba47a2eab14148c83119523b93dd89f6d84edd6c02\",\"dweb:/ipfs/QmawrZ4voKQjH3oomXT3Kuheb3Mnmo2VvVpxg8Ne5UJUrd\"]}},\"version\":1}", "metadata": { "compiler": { "version": "0.8.20+commit.a1b79de6" }, "language": "Solidity", "output": { "abi": [{ "inputs": [], "type": "error", "name": "ReentrancyGuardReentrantCall" }, { "inputs": [{ "internalType": "address", "name": "provider", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "lpAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "lpSharePrice", "type": "uint256", "indexed": false }], "type": "event", "name": "AddLiquidity", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "owner", "type": "address", "indexed": true }, { "internalType": "address", "name": "spender", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "value", "type": "uint256", "indexed": false }], "type": "event", "name": "Approval", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "account", "type": "address", "indexed": true }, { "internalType": "address", "name": "operator", "type": "address", "indexed": true }, { "internalType": "bool", "name": "approved", "type": "bool", "indexed": false }], "type": "event", "name": "ApprovalForAll", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "trader", "type": "address", "indexed": true }, { "internalType": "address", "name": "destination", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "assetId", "type": "uint256", "indexed": true }, { "internalType": "uint256", "name": "maturityTime", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "bondAmount", "type": "uint256", "indexed": false }], "type": "event", "name": "CloseLong", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "trader", "type": "address", "indexed": true }, { "internalType": "address", "name": "destination", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "assetId", "type": "uint256", "indexed": true }, { "internalType": "uint256", "name": "maturityTime", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "basePayment", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "bondAmount", "type": "uint256", "indexed": false }], "type": "event", "name": "CloseShort", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "collector", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "fees", "type": "uint256", "indexed": false }], "type": "event", "name": "CollectGovernanceFee", "anonymous": false }, { "inputs": [{ "internalType": "uint256", "name": "checkpointTime", "type": "uint256", "indexed": true }, { "internalType": "uint256", "name": "vaultSharePrice", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "maturedShorts", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "maturedLongs", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "lpSharePrice", "type": "uint256", "indexed": false }], "type": "event", "name": "CreateCheckpoint", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "newFeeCollector", "type": "address", "indexed": true }], "type": "event", "name": "FeeCollectorUpdated", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "newGovernance", "type": "address", "indexed": true }], "type": "event", "name": "GovernanceUpdated", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "provider", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "lpAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "apr", "type": "uint256", "indexed": false }], "type": "event", "name": "Initialize", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "trader", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "assetId", "type": "uint256", "indexed": true }, { "internalType": "uint256", "name": "maturityTime", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "bondAmount", "type": "uint256", "indexed": false }], "type": "event", "name": "OpenLong", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "trader", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "assetId", "type": "uint256", "indexed": true }, { "internalType": "uint256", "name": "maturityTime", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "baseProceeds", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "bondAmount", "type": "uint256", "indexed": false }], "type": "event", "name": "OpenShort", "anonymous": false }, { "inputs": [{ "internalType": "bool", "name": "isPaused", "type": "bool", "indexed": false }], "type": "event", "name": "PauseStatusUpdated", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "newPauser", "type": "address", "indexed": true }, { "internalType": "bool", "name": "status", "type": "bool", "indexed": false }], "type": "event", "name": "PauserUpdated", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "provider", "type": "address", "indexed": true }, { "internalType": "address", "name": "destination", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "withdrawalShareAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }], "type": "event", "name": "RedeemWithdrawalShares", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "provider", "type": "address", "indexed": true }, { "internalType": "address", "name": "destination", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "lpAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "baseAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "vaultShareAmount", "type": "uint256", "indexed": false }, { "internalType": "bool", "name": "asBase", "type": "bool", "indexed": false }, { "internalType": "uint256", "name": "withdrawalShareAmount", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "lpSharePrice", "type": "uint256", "indexed": false }], "type": "event", "name": "RemoveLiquidity", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "collector", "type": "address", "indexed": true }, { "internalType": "address", "name": "target", "type": "address", "indexed": true }], "type": "event", "name": "Sweep", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "newSweepCollector", "type": "address", "indexed": true }], "type": "event", "name": "SweepCollectorUpdated", "anonymous": false }, { "inputs": [{ "internalType": "address", "name": "operator", "type": "address", "indexed": true }, { "internalType": "address", "name": "from", "type": "address", "indexed": true }, { "internalType": "address", "name": "to", "type": "address", "indexed": true }, { "internalType": "uint256", "name": "id", "type": "uint256", "indexed": false }, { "internalType": "uint256", "name": "value", "type": "uint256", "indexed": false }], "type": "event", "name": "TransferSingle", "anonymous": false }], "devdoc": { "kind": "dev", "methods": {}, "version": 1 }, "userdoc": { "kind": "user", "methods": {}, "version": 1 } }, "settings": { "remappings": ["@openzeppelin/contracts/=lib/openzeppelin-contracts/contracts/", "aave-v3-core/=lib/aave-v3-core/", "ds-test/=lib/forge-std/lib/ds-test/src/", "erc4626-tests/=lib/openzeppelin-contracts/lib/erc4626-tests/", "forge-std/=lib/forge-std/src/", "openzeppelin-contracts/=lib/openzeppelin-contracts/", "openzeppelin/=lib/openzeppelin-contracts/contracts/", "solmate/=lib/solmate/src/"], "optimizer": { "enabled": true, "runs": 200 }, "metadata": { "bytecodeHash": "ipfs" }, "compilationTarget": { "contracts/src/internal/HyperdriveShort.sol": "HyperdriveShort" }, "libraries": {} }, "sources": { "contracts/src/interfaces/IERC20.sol": { "keccak256": "0x5f446a4987d57c64380d44c234ee079172e98bed9595ec067eb519898c3117d9", "urls": ["bzz-raw://a3245994c58110716f5099c07e5cb270137356d288044f03c713d29c36e207ac", "dweb:/ipfs/QmYdn52sGRQKXfSyL8ieSz8HysG6R5kLJWsNwEnyX1e22p"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdrive.sol": { "keccak256": "0xb8ee04f3090b498966970e210f7de0f982f6445628556f2f176385423d8c5952", "urls": ["bzz-raw://db789f03faa935c6e3b0882b6e873e8f683c9c8841a4b128366dcbe7321911bf", "dweb:/ipfs/QmSQh1cX79nApuSAfJbVN99dmEaE4CK9QwWfEGcwhJMBLK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveCore.sol": { "keccak256": "0x68adcd293ff25711add1698b6024faa45beec01eb044bd0103d3020aa96d856e", "urls": ["bzz-raw://0e0f5e35a7d2c656e249394d25896e5adfb9af3e210c01b9ef5fa81d25a45e24", "dweb:/ipfs/QmbLASezHPWHcbodqSfw3Qh9NzqekqVPM8FhCXKGTCXL1h"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveEvents.sol": { "keccak256": "0x812ccb32dff907e8614c89a65196eec239eceb3e63f9f14dde2b2269c75a67c0", "urls": ["bzz-raw://da5f2ce974bfcd8185342c121c879ba5aef23e1e4e7b36cf9fcba68296b8892c", "dweb:/ipfs/QmSho3PWs9bzejTYYjySuXcH9tVP4xFnkbUmSzQA54g8eG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IHyperdriveRead.sol": { "keccak256": "0x5922cbd86a7267c8fd19e3dc7a6f2636bad2b3330c28bca8e66adc7cd8ce2b55", "urls": ["bzz-raw://ced8bce3f3c15a9f0bcdd11ba16e69651179edd6b16e267936788f4ab4d6eabf", "dweb:/ipfs/QmcoZPj4h2ym6r13KDU7JG2GoVdDWa1GwfKL2jjFRsp8H6"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiToken.sol": { "keccak256": "0xf5f82b8223e0c1bfcf4f73566a909ba07a9266960dfe2335c1494e06debbbe3f", "urls": ["bzz-raw://920cf3fd66132a1e98a6a5708ad9a3bb047f4df8848119ab382b51094c1290a7", "dweb:/ipfs/QmWL3SyG8L91Coe9DsHz3Ke9tGMvYBf2NgRRDr3Fg5xFzp"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenCore.sol": { "keccak256": "0x5c27315743bb6ef8a121ecf72cb24d5c144786dedb6526ef010f580eb872e501", "urls": ["bzz-raw://3e102c51bac9c82766c9826d97dc780a05a2bf64703b070757a7531a0851a1ae", "dweb:/ipfs/QmXYwbzPbiznj5AeDiX7NNfRE9xyhSx1huTMfMFndrUZWs"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenEvents.sol": { "keccak256": "0x165f79e628b1975343f979549f3fdb5073a29aeecb03861f41d165961ee39fdb", "urls": ["bzz-raw://3c0751cf322944d080a7a6692897807d0cef798268689afc1f6c8f91182a4222", "dweb:/ipfs/QmQVWtCgphU9sjqD2q6F6ww62uXDSWZx5KJVj6jFJpXeDK"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenMetadata.sol": { "keccak256": "0xcc21ad6d3d4e3de354fbc25a472d940e5e2af0b48766404f9efecdac600d72ca", "urls": ["bzz-raw://b48fa111a773c820fe578efdd737d164e3957930ed46f3f304c6a8602a7e26a3", "dweb:/ipfs/QmcA7bjBC6ZBvYyojZZx3eKpugHmSrAAA14p14bQugiVKG"], "license": "Apache-2.0" }, "contracts/src/interfaces/IMultiTokenRead.sol": { "keccak256": "0xac84dd306f29ae9d6becf764d93545c33f7c37737bb1aeb714c85930d0c074a0", "urls": ["bzz-raw://d9082a16d5a736ab7ce5670be4f2475ea5c5fdae8ad7096ed9663f84eed96b11", "dweb:/ipfs/QmUTH8dZaQJt56UsT7N2aCUCKmjQYj7Ah53rRXk6DuVNUR"], "license": "Apache-2.0" }, "contracts/src/internal/HyperdriveBase.sol": { "keccak256": "0x7feb8df22e6f91b1ee70f50f5ca16a7819601bcb88fc5a5fa9cf16c708cc52bb", "urls": ["bzz-raw://60ff7ff4faa45551099b025d03f2438477b5fd1f64f82b78c6ed26cbdafc64f6", "dweb:/ipfs/QmWtbftziGdSKAEvpRoaWRnTxMNwgUVs2nDN6nFugX1WYN"], "license": "Apache-2.0" }, "contracts/src/internal/HyperdriveLP.sol": { "keccak256": "0x72410851e77940e66681e23b9d10f3c3de0e8c9a3e5b1cca627e93bba431775d", "urls": ["bzz-raw://82a9292f388b16572cc5c5e873d1ead666ddcc3e436cf5d7fb036fd6c63ee9a2", "dweb:/ipfs/Qmauzxkn46ACS4XV43m2MbDF91KYP4ExYwSxL3cm1SDL6j"], "license": "Apache-2.0" }, "contracts/src/internal/HyperdriveMultiToken.sol": { "keccak256": "0x21a9aafb8e23a22c77111e13538fa8f709446e4f3a64ef84b2eebc2aa9d04373", "urls": ["bzz-raw://41517912353540de5b430587ca8220f9d34d4432d3c723951d5fb618d5907b5d", "dweb:/ipfs/QmU3cTCrAq94digVS97s5af1Pu86uGBpmpus6w7828fUbG"], "license": "Apache-2.0" }, "contracts/src/internal/HyperdriveShort.sol": { "keccak256": "0xc42b5a9ee5eee3cb9177b136eb9f4b81a4b51d9468f8faa97309934b6b371bc5", "urls": ["bzz-raw://b9291237fcdbb8ff97517acd19499cfa4afc6d670a89fd5cc0309a201a7b1006", "dweb:/ipfs/QmfQmUwvGhJgPFyNaHvur8AViePBzvSBNAdaZJBwMkY5Je"], "license": "Apache-2.0" }, "contracts/src/internal/HyperdriveStorage.sol": { "keccak256": "0xf13ba4bcf41673bc04e4ae32a29c31b62514d66cfedee70b0d3bff574efc0e4a", "urls": ["bzz-raw://e505639a656cf7c908e7c64cfd5cae6f4174a679de19d17a3f12f6e3fc4b2195", "dweb:/ipfs/QmNmcmz9nV9uDyeouo8yWAKMoMqEVx6JMTfZwCRa9QU83N"], "license": "Apache-2.0" }, "contracts/src/libraries/AssetId.sol": { "keccak256": "0x3031a1ec376be333eebe0062c474a22d7f970cb02de62ab6823c6918c0a7f83b", "urls": ["bzz-raw://6c80cc2fd8b7908b6420ebb21cb99266c93e01d6cdd9d1a41f8847493849b131", "dweb:/ipfs/QmeMehWbF2RwQaf6c6yaj5KHjXboDRpzBCtvFnLW4BXBbc"], "license": "Apache-2.0" }, "contracts/src/libraries/Errors.sol": { "keccak256": "0x45f48f5b8caec5b751850b7266abd84c7400debfbad0f112847582bb052058b0", "urls": ["bzz-raw://46c85e0c750cdb752bec5d67a8a0bc8df071d934c568c880d08a5120a1a11d88", "dweb:/ipfs/Qmc2L1ePB1gqBwUiaAUeoG6hvoPtS2hdY6rhEXzX1SfB41"], "license": "Apache-2.0" }, "contracts/src/libraries/FixedPointMath.sol": { "keccak256": "0x631f6529908f62f71775f8c6120afdca3a836fb24fa9fa4701cad54f4a9da076", "urls": ["bzz-raw://2baf6ad8917a3fbb6d040334451f6b4f6936b00518c4cd308b9c6fa11569b2bd", "dweb:/ipfs/QmXD16vk6MRxmPRqy8ZXSpRA5XxhSf1pnsQH32ARDJTk8L"], "license": "Apache-2.0" }, "contracts/src/libraries/HyperdriveMath.sol": { "keccak256": "0xcf305dde8aa320d1e1b767734ce8edce456af537525d40e30d5345f09f6e34ab", "urls": ["bzz-raw://056c9a563f1a9e0133e17463497ad19be517d35b770170122edea50ca9fbe002", "dweb:/ipfs/QmS6dkVRHzdbv7etumcCtNtm9GuXDCjqZxxhtYfP6keAAY"], "license": "Apache-2.0" }, "contracts/src/libraries/LPMath.sol": { "keccak256": "0x5b3c0d159b1945a14227028d835e011bf740e007f664cba049ece1b6ab963067", "urls": ["bzz-raw://d8f4fef22462dabc799b2f8124440a7cc57076f7ceecb46219c69b09f50baf5f", "dweb:/ipfs/Qmcw9iC1RZt4Nh7dGH1yR7vUi6qZHJf6ReAvF2uLFHESqZ"], "license": "Apache-2.0" }, "contracts/src/libraries/SafeCast.sol": { "keccak256": "0xc5282be69c8c85c1a1bbbf1554a501c17599f4b84119339b660018ae90eb7148", "urls": ["bzz-raw://fd29b570d1e3205d25939b1c0e78e98ae34747a8118703fc5b2c9690791b26c8", "dweb:/ipfs/QmSdecxKRE66cgEipikK5uS4mUJxz2FgfncCk9iXvkdjG8"], "license": "Apache-2.0" }, "contracts/src/libraries/YieldSpaceMath.sol": { "keccak256": "0x4a9c91313bed7cda6ef503af23c9f777008b5258e9cb2176eab6acc52be79891", "urls": ["bzz-raw://88da1f5502a12fe1024be90f6a6ea08556cc1f2660ab8cbeb5e07640abb7711c", "dweb:/ipfs/QmVQoG9TyrAsVYcgvgZfgA5pQk8V8wvS4BewGNP4B3Txyy"], "license": "Apache-2.0" }, "lib/openzeppelin-contracts/contracts/utils/ReentrancyGuard.sol": { "keccak256": "0xf980daa263b661ab8ddee7d4fd833c7da7e7995e2c359ff1f17e67e4112f2236", "urls": ["bzz-raw://7448ab095d6940130bcf76ba47a2eab14148c83119523b93dd89f6d84edd6c02", "dweb:/ipfs/QmawrZ4voKQjH3oomXT3Kuheb3Mnmo2VvVpxg8Ne5UJUrd"], "license": "MIT" } }, "version": 1 }, "ast": { "absolutePath": "contracts/src/internal/HyperdriveShort.sol", "id": 18282, "exportedSymbols": { "AssetId": [18772], "Errors": [18797], "FixedPointMath": [19572], "HyperdriveLP": [15877], "HyperdriveMath": [20320], "HyperdriveShort": [18281], "IHyperdrive": [11143], "IHyperdriveEvents": [11666], "ONE": [18806], "SafeCast": [22443] }, "nodeType": "SourceUnit", "src": "39:31485:123", "nodes": [{ "id": 17297, "nodeType": "PragmaDirective", "src": "39:23:123", "nodes": [], "literals": ["solidity", "0.8", ".20"] }, { "id": 17299, "nodeType": "ImportDirective", "src": "64:60:123", "nodes": [], "absolutePath": "contracts/src/interfaces/IHyperdrive.sol", "file": "../interfaces/IHyperdrive.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 11144, "symbolAliases": [{ "foreign": { "id": 17298, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "73:11:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17301, "nodeType": "ImportDirective", "src": "125:72:123", "nodes": [], "absolutePath": "contracts/src/interfaces/IHyperdriveEvents.sol", "file": "../interfaces/IHyperdriveEvents.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 11667, "symbolAliases": [{ "foreign": { "id": 17300, "name": "IHyperdriveEvents", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11666, "src": "134:17:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17303, "nodeType": "ImportDirective", "src": "198:51:123", "nodes": [], "absolutePath": "contracts/src/libraries/AssetId.sol", "file": "../libraries/AssetId.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 18773, "symbolAliases": [{ "foreign": { "id": 17302, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "207:7:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17305, "nodeType": "ImportDirective", "src": "250:49:123", "nodes": [], "absolutePath": "contracts/src/libraries/Errors.sol", "file": "../libraries/Errors.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 18798, "symbolAliases": [{ "foreign": { "id": 17304, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "259:6:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17308, "nodeType": "ImportDirective", "src": "300:70:123", "nodes": [], "absolutePath": "contracts/src/libraries/FixedPointMath.sol", "file": "../libraries/FixedPointMath.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 19573, "symbolAliases": [{ "foreign": { "id": 17306, "name": "FixedPointMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 19572, "src": "309:14:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }, { "foreign": { "id": 17307, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "325:3:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17310, "nodeType": "ImportDirective", "src": "371:65:123", "nodes": [], "absolutePath": "contracts/src/libraries/HyperdriveMath.sol", "file": "../libraries/HyperdriveMath.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 20321, "symbolAliases": [{ "foreign": { "id": 17309, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "380:14:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17312, "nodeType": "ImportDirective", "src": "437:53:123", "nodes": [], "absolutePath": "contracts/src/libraries/SafeCast.sol", "file": "../libraries/SafeCast.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 22444, "symbolAliases": [{ "foreign": { "id": 17311, "name": "SafeCast", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 22443, "src": "446:8:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 17314, "nodeType": "ImportDirective", "src": "491:50:123", "nodes": [], "absolutePath": "contracts/src/internal/HyperdriveLP.sol", "file": "./HyperdriveLP.sol", "nameLocation": "-1:-1:-1", "scope": 18282, "sourceUnit": 15878, "symbolAliases": [{ "foreign": { "id": 17313, "name": "HyperdriveLP", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 15877, "src": "500:12:123", "typeDescriptions": {} }, "nameLocation": "-1:-1:-1" }], "unitAlias": "" }, { "id": 18281, "nodeType": "ContractDefinition", "src": "871:30652:123", "nodes": [{ "id": 17322, "nodeType": "UsingForDirective", "src": "946:33:123", "nodes": [], "global": false, "libraryName": { "id": 17320, "name": "FixedPointMath", "nameLocations": ["952:14:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 19572, "src": "952:14:123" }, "typeName": { "id": 17321, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "971:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } } }, { "id": 17325, "nodeType": "UsingForDirective", "src": "984:32:123", "nodes": [], "global": false, "libraryName": { "id": 17323, "name": "FixedPointMath", "nameLocations": ["990:14:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 19572, "src": "990:14:123" }, "typeName": { "id": 17324, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1009:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } } }, { "id": 17328, "nodeType": "UsingForDirective", "src": "1021:27:123", "nodes": [], "global": false, "libraryName": { "id": 17326, "name": "SafeCast", "nameLocations": ["1027:8:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 22443, "src": "1027:8:123" }, "typeName": { "id": 17327, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1040:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } } }, { "id": 17331, "nodeType": "UsingForDirective", "src": "1053:26:123", "nodes": [], "global": false, "libraryName": { "id": 17329, "name": "SafeCast", "nameLocations": ["1059:8:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 22443, "src": "1059:8:123" }, "typeName": { "id": 17330, "name": "int256", "nodeType": "ElementaryTypeName", "src": "1072:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } } }, { "id": 17512, "nodeType": "FunctionDefinition", "src": "1957:4443:123", "nodes": [], "body": { "id": 17511, "nodeType": "Block", "src": "2186:4214:123", "nodes": [], "statements": [{ "expression": { "arguments": [], "expression": { "argumentTypes": [], "id": 17352, "name": "_checkMessageValue", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13576, "src": "2246:18:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$__$", "typeString": "function () view" } }, "id": 17353, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2246:20:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17354, "nodeType": "ExpressionStatement", "src": "2246:20:123" }, { "expression": { "arguments": [{ "id": 17356, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17341, "src": "2345:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17355, "name": "_checkOptions", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13598, "src": "2331:13:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_Options_$10990_calldata_ptr_$returns$__$", "typeString": "function (struct IHyperdrive.Options calldata) pure" } }, "id": 17357, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2331:23:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17358, "nodeType": "ExpressionStatement", "src": "2331:23:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17361, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17359, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17334, "src": "2479:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17360, "name": "_minimumTransactionAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18334, "src": "2493:25:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "2479:39:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17368, "nodeType": "IfStatement", "src": "2475:115:123", "trueBody": { "id": 17367, "nodeType": "Block", "src": "2520:70:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17362, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "2541:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17364, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "2553:24:123", "memberName": "MinimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 11056, "src": "2541:36:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17365, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2541:38:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17366, "nodeType": "RevertStatement", "src": "2534:45:123" }] } }, { "assignments": [17370], "declarations": [{ "constant": false, "id": 17370, "mutability": "mutable", "name": "vaultSharePrice", "nameLocation": "2924:15:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "2916:23:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17369, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2916:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17373, "initialValue": { "arguments": [], "expression": { "argumentTypes": [], "id": 17371, "name": "_pricePerVaultShare", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13530, "src": "2942:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 17372, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "2942:21:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "2916:47:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17376, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17374, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "2977:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17375, "name": "_minVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17338, "src": "2995:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "2977:37:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17383, "nodeType": "IfStatement", "src": "2973:106:123", "trueBody": { "id": 17382, "nodeType": "Block", "src": "3016:63:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17377, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "3037:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17379, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "3049:17:123", "memberName": "MinimumSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 11053, "src": "3037:29:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17380, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "3037:31:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17381, "nodeType": "RevertStatement", "src": "3030:38:123" }] } }, { "assignments": [17385], "declarations": [{ "constant": false, "id": 17385, "mutability": "mutable", "name": "latestCheckpoint", "nameLocation": "3096:16:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3088:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17384, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3088:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17388, "initialValue": { "arguments": [], "expression": { "argumentTypes": [], "id": 17386, "name": "_latestCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13736, "src": "3115:17:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 17387, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "3115:19:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "3088:46:123" }, { "assignments": [17390], "declarations": [{ "constant": false, "id": 17390, "mutability": "mutable", "name": "openVaultSharePrice", "nameLocation": "3152:19:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3144:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17389, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3144:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17395, "initialValue": { "arguments": [{ "id": 17392, "name": "latestCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17385, "src": "3204:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17393, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "3234:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17391, "name": "_applyCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13650, "src": "3174:16:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256) returns (uint256)" } }, "id": 17394, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "3174:85:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "3144:115:123" }, { "assignments": [17397], "declarations": [{ "constant": false, "id": 17397, "mutability": "mutable", "name": "maturityTime", "nameLocation": "3506:12:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3498:20:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17396, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3498:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17401, "initialValue": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17400, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17398, "name": "latestCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17385, "src": "3521:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 17399, "name": "_positionDuration", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18310, "src": "3540:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "3521:36:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "3498:59:123" }, { "assignments": [17403, 17405, 17407], "declarations": [{ "constant": false, "id": 17403, "mutability": "mutable", "name": "baseDeposit", "nameLocation": "3589:11:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3581:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17402, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3581:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17405, "mutability": "mutable", "name": "shareReservesDelta", "nameLocation": "3622:18:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3614:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17404, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3614:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17407, "mutability": "mutable", "name": "totalGovernanceFee", "nameLocation": "3662:18:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "3654:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17406, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "3654:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17413, "initialValue": { "arguments": [{ "id": 17409, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17334, "src": "3730:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17410, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "3759:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17411, "name": "openVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17390, "src": "3792:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17408, "name": "_calculateOpenShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18076, "src": "3693:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) view returns (uint256,uint256,uint256)" } }, "id": 17412, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "3693:132:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256)" } }, "nodeType": "VariableDeclarationStatement", "src": "3567:258:123" }, { "expression": { "id": 17416, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 17414, "name": "_governanceFeesAccrued", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18360, "src": "3878:22:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "id": 17415, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17407, "src": "3904:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "3878:44:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17417, "nodeType": "ExpressionStatement", "src": "3878:44:123" }, { "assignments": [17419], "declarations": [{ "constant": false, "id": 17419, "mutability": "mutable", "name": "deposit", "nameLocation": "4564:7:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "4556:15:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17418, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "4556:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17425, "initialValue": { "arguments": [{ "id": 17421, "name": "baseDeposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17403, "src": "4612:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17422, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "4637:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17423, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17341, "src": "4666:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17420, "name": "_convertToOptionFromBase", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14510, "src": "4574:24:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,struct IHyperdrive.Options calldata) pure returns (uint256)" } }, "id": 17424, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4574:110:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "4556:128:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17428, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17426, "name": "_maxDeposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17336, "src": "4698:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17427, "name": "deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17419, "src": "4712:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "4698:21:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17435, "nodeType": "IfStatement", "src": "4694:84:123", "trueBody": { "id": 17434, "nodeType": "Block", "src": "4721:57:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17429, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "4742:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17431, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "4754:11:123", "memberName": "OutputLimit", "nodeType": "MemberAccess", "referencedDeclaration": 11065, "src": "4742:23:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17432, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4742:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17433, "nodeType": "RevertStatement", "src": "4735:32:123" }] } }, { "expression": { "arguments": [{ "id": 17437, "name": "deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17419, "src": "4796:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17438, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17341, "src": "4805:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17436, "name": "_deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13456, "src": "4787:8:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$_t_uint256_$", "typeString": "function (uint256,struct IHyperdrive.Options calldata) returns (uint256,uint256)" } }, "id": 17439, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "4787:27:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "id": 17440, "nodeType": "ExpressionStatement", "src": "4787:27:123" }, { "expression": { "arguments": [{ "id": 17442, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17334, "src": "5071:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17443, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17405, "src": "5096:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17444, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "5128:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17445, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17397, "src": "5157:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17441, "name": "_applyOpenShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17895, "src": "5042:15:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$__$", "typeString": "function (uint256,uint256,uint256,uint256)" } }, "id": 17446, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5042:137:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17447, "nodeType": "ExpressionStatement", "src": "5042:137:123" }, { "assignments": [17449], "declarations": [{ "constant": false, "id": 17449, "mutability": "mutable", "name": "assetId", "nameLocation": "5246:7:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "5238:15:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17448, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5238:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17457, "initialValue": { "arguments": [{ "expression": { "expression": { "id": 17452, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "5291:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17453, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5299:13:123", "memberName": "AssetIdPrefix", "nodeType": "MemberAccess", "referencedDeclaration": 18519, "src": "5291:21:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_AssetIdPrefix_$18519_$", "typeString": "type(enum AssetId.AssetIdPrefix)" } }, "id": 17454, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "5313:5:123", "memberName": "Short", "nodeType": "MemberAccess", "referencedDeclaration": 18517, "src": "5291:27:123", "typeDescriptions": { "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" } }, { "id": 17455, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17397, "src": "5332:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 17450, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "5256:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17451, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5264:13:123", "memberName": "encodeAssetId", "nodeType": "MemberAccess", "referencedDeclaration": 18542, "src": "5256:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_AssetIdPrefix_$18519_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (enum AssetId.AssetIdPrefix,uint256) pure returns (uint256)" } }, "id": 17456, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5256:98:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "5238:116:123" }, { "assignments": [17459], "declarations": [{ "constant": false, "id": 17459, "mutability": "mutable", "name": "bondAmount", "nameLocation": "5372:10:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "5364:18:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17458, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5364:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17461, "initialValue": { "id": 17460, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17334, "src": "5385:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "5364:32:123" }, { "expression": { "arguments": [{ "id": 17463, "name": "assetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17449, "src": "5443:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17464, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17341, "src": "5452:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "id": 17465, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5461:11:123", "memberName": "destination", "nodeType": "MemberAccess", "referencedDeclaration": 10983, "src": "5452:20:123", "typeDescriptions": { "typeIdentifier": "t_address", "typeString": "address" } }, { "id": 17466, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17459, "src": "5474:10:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_address", "typeString": "address" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17462, "name": "_mint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17085, "src": "5437:5:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_address_$_t_uint256_$returns$__$", "typeString": "function (uint256,address,uint256)" } }, "id": 17467, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5437:48:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17468, "nodeType": "ExpressionStatement", "src": "5437:48:123" }, { "assignments": [17470], "declarations": [{ "constant": false, "id": 17470, "mutability": "mutable", "name": "shareReservesDelta_", "nameLocation": "5540:19:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "5532:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17469, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5532:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17472, "initialValue": { "id": 17471, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17405, "src": "5562:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "5532:48:123" }, { "assignments": [17474], "declarations": [{ "constant": false, "id": 17474, "mutability": "mutable", "name": "vaultSharePrice_", "nameLocation": "5629:16:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "5621:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17473, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "5621:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17476, "initialValue": { "id": 17475, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17370, "src": "5648:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "5621:42:123" }, { "assignments": [17481], "declarations": [{ "constant": false, "id": 17481, "mutability": "mutable", "name": "options", "nameLocation": "5733:7:123", "nodeType": "VariableDeclaration", "scope": 17511, "src": "5704:36:123", "stateVariable": false, "storageLocation": "calldata", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options" }, "typeName": { "id": 17480, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 17479, "name": "IHyperdrive.Options", "nameLocations": ["5704:11:123", "5716:7:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 10990, "src": "5704:19:123" }, "referencedDeclaration": 10990, "src": "5704:19:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_storage_ptr", "typeString": "struct IHyperdrive.Options" } }, "visibility": "internal" }], "id": 17483, "initialValue": { "id": 17482, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17341, "src": "5743:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "nodeType": "VariableDeclarationStatement", "src": "5704:47:123" }, { "eventCall": { "arguments": [{ "expression": { "id": 17485, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17481, "src": "5789:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "id": 17486, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "5797:11:123", "memberName": "destination", "nodeType": "MemberAccess", "referencedDeclaration": 10983, "src": "5789:19:123", "typeDescriptions": { "typeIdentifier": "t_address", "typeString": "address" } }, { "id": 17487, "name": "assetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17449, "src": "5822:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17488, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17397, "src": "5843:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17489, "name": "baseDeposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17403, "src": "5869:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "id": 17491, "name": "deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17419, "src": "5942:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17492, "name": "vaultSharePrice_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17474, "src": "5951:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17493, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17481, "src": "5969:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17490, "name": "_convertToVaultSharesFromOption", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14484, "src": "5910:31:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,struct IHyperdrive.Options calldata) pure returns (uint256)" } }, "id": 17494, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5910:67:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17495, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17481, "src": "6015:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "id": 17496, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6023:6:123", "memberName": "asBase", "nodeType": "MemberAccess", "referencedDeclaration": 10986, "src": "6015:14:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, { "arguments": [{ "id": 17502, "name": "vaultSharePrice_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17474, "src": "6288:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17499, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17497, "name": "shareReservesDelta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17470, "src": "6221:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 17498, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17407, "src": "6243:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "6221:40:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 17500, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6220:42:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17501, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "6263:7:123", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "6220:50:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 17503, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "6220:98:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17504, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17459, "src": "6332:10:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_address", "typeString": "address" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_bool", "typeString": "bool" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17484, "name": "OpenShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11571, "src": "5766:9:123", "typeDescriptions": { "typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_uint256_$_t_uint256_$returns$__$", "typeString": "function (address,uint256,uint256,uint256,uint256,bool,uint256,uint256)" } }, "id": 17505, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "5766:586:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17506, "nodeType": "EmitStatement", "src": "5761:591:123" }, { "expression": { "components": [{ "id": 17507, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17397, "src": "6371:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17508, "name": "deposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17419, "src": "6385:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 17509, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "6370:23:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256)" } }, "functionReturnParameters": 17351, "id": 17510, "nodeType": "Return", "src": "6363:30:123" }] }, "documentation": { "id": 17332, "nodeType": "StructuredDocumentation", "src": "1085:867:123", "text": "@dev Opens a short position.\n @param _bondAmount The amount of bonds to short.\n @param _maxDeposit The most the user expects to deposit for this trade.\n        The units of this quantity are either base or vault shares,\n        depending on the value of `_options.asBase`.\n @param _minVaultSharePrice The minimum vault share price at which to open\n        the short. This allows traders to protect themselves from opening\n        a short in a checkpoint where negative interest has accrued.\n @param _options The options that configure how the trade is settled.\n @return The maturity time of the short.\n @return The amount the user deposited for this trade. The units of this\n         quantity are either base or vault shares, depending on the value\n         of `_options.asBase`." }, "implemented": true, "kind": "function", "modifiers": [{ "id": 17344, "kind": "modifierInvocation", "modifierName": { "id": 17343, "name": "nonReentrant", "nameLocations": ["2134:12:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 72137, "src": "2134:12:123" }, "nodeType": "ModifierInvocation", "src": "2134:12:123" }, { "id": 17346, "kind": "modifierInvocation", "modifierName": { "id": 17345, "name": "isNotPaused", "nameLocations": ["2147:11:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 13640, "src": "2147:11:123" }, "nodeType": "ModifierInvocation", "src": "2147:11:123" }], "name": "_openShort", "nameLocation": "1966:10:123", "parameters": { "id": 17342, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17334, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "1994:11:123", "nodeType": "VariableDeclaration", "scope": 17512, "src": "1986:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17333, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "1986:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17336, "mutability": "mutable", "name": "_maxDeposit", "nameLocation": "2023:11:123", "nodeType": "VariableDeclaration", "scope": 17512, "src": "2015:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17335, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2015:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17338, "mutability": "mutable", "name": "_minVaultSharePrice", "nameLocation": "2052:19:123", "nodeType": "VariableDeclaration", "scope": 17512, "src": "2044:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17337, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2044:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17341, "mutability": "mutable", "name": "_options", "nameLocation": "2110:8:123", "nodeType": "VariableDeclaration", "scope": 17512, "src": "2081:37:123", "stateVariable": false, "storageLocation": "calldata", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options" }, "typeName": { "id": 17340, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 17339, "name": "IHyperdrive.Options", "nameLocations": ["2081:11:123", "2093:7:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 10990, "src": "2081:19:123" }, "referencedDeclaration": 10990, "src": "2081:19:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_storage_ptr", "typeString": "struct IHyperdrive.Options" } }, "visibility": "internal" }], "src": "1976:148:123" }, "returnParameters": { "id": 17351, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17348, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 17512, "src": "2168:7:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17347, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2168:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17350, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 17512, "src": "2177:7:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17349, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "2177:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "2167:18:123" }, "scope": 18281, "stateMutability": "nonpayable", "virtual": false, "visibility": "internal" }, { "id": 17752, "nodeType": "FunctionDefinition", "src": "7055:6341:123", "nodes": [], "body": { "id": 17751, "nodeType": "Block", "src": "7257:6139:123", "nodes": [], "statements": [{ "expression": { "arguments": [{ "id": 17530, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17522, "src": "7335:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17529, "name": "_checkOptions", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13598, "src": "7321:13:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_struct$_Options_$10990_calldata_ptr_$returns$__$", "typeString": "function (struct IHyperdrive.Options calldata) pure" } }, "id": 17531, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7321:23:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17532, "nodeType": "ExpressionStatement", "src": "7321:23:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17535, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17533, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "7469:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17534, "name": "_minimumTransactionAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18334, "src": "7483:25:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "7469:39:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17542, "nodeType": "IfStatement", "src": "7465:115:123", "trueBody": { "id": 17541, "nodeType": "Block", "src": "7510:70:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17536, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "7531:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17538, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "7543:24:123", "memberName": "MinimumTransactionAmount", "nodeType": "MemberAccess", "referencedDeclaration": 11056, "src": "7531:36:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17539, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7531:38:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17540, "nodeType": "RevertStatement", "src": "7524:45:123" }] } }, { "assignments": [17544], "declarations": [{ "constant": false, "id": 17544, "mutability": "mutable", "name": "vaultSharePrice", "nameLocation": "7858:15:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "7850:23:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17543, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7850:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17547, "initialValue": { "arguments": [], "expression": { "argumentTypes": [], "id": 17545, "name": "_pricePerVaultShare", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13530, "src": "7876:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 17546, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7876:21:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "7850:47:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17551, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 17548, "name": "block", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -4, "src": "7911:5:123", "typeDescriptions": { "typeIdentifier": "t_magic_block", "typeString": "block" } }, "id": 17549, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "7917:9:123", "memberName": "timestamp", "nodeType": "MemberAccess", "src": "7911:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17550, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "7929:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "7911:31:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 17564, "nodeType": "Block", "src": "8029:73:123", "statements": [{ "expression": { "arguments": [{ "id": 17560, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "8060:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17561, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "8075:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17559, "name": "_applyCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13650, "src": "8043:16:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256) returns (uint256)" } }, "id": 17562, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8043:48:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17563, "nodeType": "ExpressionStatement", "src": "8043:48:123" }] }, "id": 17565, "nodeType": "IfStatement", "src": "7907:195:123", "trueBody": { "id": 17558, "nodeType": "Block", "src": "7944:79:123", "statements": [{ "expression": { "arguments": [{ "arguments": [], "expression": { "argumentTypes": [], "id": 17553, "name": "_latestCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13736, "src": "7975:17:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 17554, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7975:19:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17555, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "7996:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17552, "name": "_applyCheckpoint", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13650, "src": "7958:16:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256) returns (uint256)" } }, "id": 17556, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "7958:54:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17557, "nodeType": "ExpressionStatement", "src": "7958:54:123" }] } }, { "expression": { "arguments": [{ "arguments": [{ "expression": { "expression": { "id": 17569, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "8203:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17570, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "8211:13:123", "memberName": "AssetIdPrefix", "nodeType": "MemberAccess", "referencedDeclaration": 18519, "src": "8203:21:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_AssetIdPrefix_$18519_$", "typeString": "type(enum AssetId.AssetIdPrefix)" } }, "id": 17571, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "8225:5:123", "memberName": "Short", "nodeType": "MemberAccess", "referencedDeclaration": 18517, "src": "8203:27:123", "typeDescriptions": { "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" } }, { "id": 17572, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "8232:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 17567, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "8181:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17568, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "8189:13:123", "memberName": "encodeAssetId", "nodeType": "MemberAccess", "referencedDeclaration": 18542, "src": "8181:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_AssetIdPrefix_$18519_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (enum AssetId.AssetIdPrefix,uint256) pure returns (uint256)" } }, "id": 17573, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8181:65:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17574, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "8260:3:123", "typeDescriptions": { "typeIdentifier": "t_magic_message", "typeString": "msg" } }, "id": 17575, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "8264:6:123", "memberName": "sender", "nodeType": "MemberAccess", "src": "8260:10:123", "typeDescriptions": { "typeIdentifier": "t_address", "typeString": "address" } }, { "id": 17576, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "8284:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_address", "typeString": "address" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17566, "name": "_burn", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17137, "src": "8162:5:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_address_$_t_uint256_$returns$__$", "typeString": "function (uint256,address,uint256)" } }, "id": 17577, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8162:143:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17578, "nodeType": "ExpressionStatement", "src": "8162:143:123" }, { "assignments": [17580, 17582, 17584, 17586, 17588], "declarations": [{ "constant": false, "id": 17580, "mutability": "mutable", "name": "bondReservesDelta", "nameLocation": "8601:17:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "8593:25:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17579, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8593:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17582, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "8640:13:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "8632:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17581, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8632:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17584, "mutability": "mutable", "name": "shareReservesDelta", "nameLocation": "8675:18:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "8667:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17583, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8667:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17586, "mutability": "mutable", "name": "shareAdjustmentDelta", "nameLocation": "8714:20:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "8707:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 17585, "name": "int256", "nodeType": "ElementaryTypeName", "src": "8707:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 17588, "mutability": "mutable", "name": "totalGovernanceFee", "nameLocation": "8756:18:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "8748:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17587, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "8748:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17594, "initialValue": { "arguments": [{ "id": 17590, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "8808:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17591, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "8821:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17592, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "8838:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17589, "name": "_calculateCloseShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18280, "src": "8787:20:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256) view returns (uint256,uint256,uint256,int256,uint256)" } }, "id": 17593, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "8787:65:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,int256,uint256)" } }, "nodeType": "VariableDeclarationStatement", "src": "8579:273:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17598, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 17595, "name": "block", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -4, "src": "9058:5:123", "typeDescriptions": { "typeIdentifier": "t_magic_block", "typeString": "block" } }, "id": 17596, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9064:9:123", "memberName": "timestamp", "nodeType": "MemberAccess", "src": "9058:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17597, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "9076:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "9058:31:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseBody": { "id": 17667, "nodeType": "Block", "src": "10703:652:123", "statements": [{ "expression": { "id": 17661, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 17656, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17582, "src": "10915:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 17658, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17582, "src": "10949:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17659, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "10964:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17657, "name": "_applyZombieClose", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14117, "src": "10931:17:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256) returns (uint256)" } }, "id": 17660, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "10931:49:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "10915:65:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17662, "nodeType": "ExpressionStatement", "src": "10915:65:123" }, { "expression": { "arguments": [{ "id": 17664, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "11328:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17663, "name": "_distributeExcessIdleSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 15800, "src": "11302:25:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)" } }, "id": 17665, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11302:42:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17666, "nodeType": "ExpressionStatement", "src": "11302:42:123" }] }, "id": 17668, "nodeType": "IfStatement", "src": "9054:2301:123", "trueBody": { "id": 17655, "nodeType": "Block", "src": "9091:1606:123", "statements": [{ "expression": { "id": 17601, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 17599, "name": "_governanceFeesAccrued", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18360, "src": "9151:22:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "id": 17600, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17588, "src": "9177:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "9151:44:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17602, "nodeType": "ExpressionStatement", "src": "9151:44:123" }, { "expression": { "arguments": [{ "id": 17604, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "9322:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17605, "name": "bondReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17580, "src": "9351:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17606, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17584, "src": "9386:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17607, "name": "shareAdjustmentDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17586, "src": "9422:20:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 17608, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "9460:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17603, "name": "_applyCloseShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17969, "src": "9288:16:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$returns$__$", "typeString": "function (uint256,uint256,uint256,int256,uint256)" } }, "id": 17609, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9288:199:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17610, "nodeType": "ExpressionStatement", "src": "9288:199:123" }, { "assignments": [17612], "declarations": [{ "constant": false, "id": 17612, "mutability": "mutable", "name": "nonNettedLongs", "nameLocation": "9662:14:123", "nodeType": "VariableDeclaration", "scope": 17655, "src": "9655:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 17611, "name": "int256", "nodeType": "ElementaryTypeName", "src": "9655:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 17616, "initialValue": { "arguments": [{ "id": 17614, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "9695:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17613, "name": "_nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13784, "src": "9679:15:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$returns$_t_int256_$", "typeString": "function (uint256) view returns (int256)" } }, "id": 17615, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9679:30:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "9655:54:123" }, { "expression": { "arguments": [{ "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 17622, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17618, "name": "nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17612, "src": "9760:14:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17619, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "9777:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17620, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "9789:8:123", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "9777:20:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 17621, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9777:22:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "9760:39:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 17623, "name": "nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17612, "src": "9817:14:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 17617, "name": "_updateLongExposure", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14025, "src": "9723:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_int256_$_t_int256_$returns$__$", "typeString": "function (int256,int256)" } }, "id": 17624, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "9723:122:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17625, "nodeType": "ExpressionStatement", "src": "9723:122:123" }, { "condition": { "id": 17629, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "10061:28:123", "subExpression": { "arguments": [{ "id": 17627, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "10073:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17626, "name": "_isSolvent", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13972, "src": "10062:10:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) view returns (bool)" } }, "id": 17628, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "10062:27:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17639, "nodeType": "IfStatement", "src": "10057:201:123", "trueBody": { "id": 17638, "nodeType": "Block", "src": "10091:167:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 17633, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "10169:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17634, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "10181:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "10169:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 17635, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "10209:16:123", "memberName": "SolvencyViolated", "nodeType": "MemberAccess", "referencedDeclaration": 10995, "src": "10169:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 17630, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "10109:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 17632, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "10116:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "10109:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 17636, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "10109:134:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17637, "nodeType": "ExpressionStatement", "src": "10109:134:123" }] } }, { "assignments": [17641], "declarations": [{ "constant": false, "id": 17641, "mutability": "mutable", "name": "success", "nameLocation": "10527:7:123", "nodeType": "VariableDeclaration", "scope": 17655, "src": "10522:12:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 17640, "name": "bool", "nodeType": "ElementaryTypeName", "src": "10522:4:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 17645, "initialValue": { "arguments": [{ "id": 17643, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "10563:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17642, "name": "_distributeExcessIdleSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 15800, "src": "10537:25:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)" } }, "id": 17644, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "10537:42:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "VariableDeclarationStatement", "src": "10522:57:123" }, { "condition": { "id": 17647, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "10597:8:123", "subExpression": { "id": 17646, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17641, "src": "10598:7:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17654, "nodeType": "IfStatement", "src": "10593:94:123", "trueBody": { "id": 17653, "nodeType": "Block", "src": "10607:80:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17648, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "10632:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17650, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "10644:26:123", "memberName": "DistributeExcessIdleFailed", "nodeType": "MemberAccess", "referencedDeclaration": 11085, "src": "10632:38:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17651, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "10632:40:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17652, "nodeType": "RevertStatement", "src": "10625:47:123" }] } }] } }, { "assignments": [17670], "declarations": [{ "constant": false, "id": 17670, "mutability": "mutable", "name": "proceeds", "nameLocation": "11572:8:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "11564:16:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17669, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "11564:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17676, "initialValue": { "arguments": [{ "id": 17672, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17582, "src": "11593:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17673, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "11608:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17674, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17522, "src": "11625:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17671, "name": "_withdraw", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13519, "src": "11583:9:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,struct IHyperdrive.Options calldata) returns (uint256)" } }, "id": 17675, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11583:51:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "11564:70:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17679, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17677, "name": "proceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17670, "src": "11926:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17678, "name": "_minOutput", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17519, "src": "11937:10:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "11926:21:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17686, "nodeType": "IfStatement", "src": "11922:84:123", "trueBody": { "id": 17685, "nodeType": "Block", "src": "11949:57:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17680, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "11970:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17682, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "11982:11:123", "memberName": "OutputLimit", "nodeType": "MemberAccess", "referencedDeclaration": 11065, "src": "11970:23:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17683, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "11970:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17684, "nodeType": "RevertStatement", "src": "11963:32:123" }] } }, { "assignments": [17688], "declarations": [{ "constant": false, "id": 17688, "mutability": "mutable", "name": "bondAmount", "nameLocation": "12060:10:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12052:18:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17687, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12052:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17690, "initialValue": { "id": 17689, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17517, "src": "12073:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12052:32:123" }, { "assignments": [17692], "declarations": [{ "constant": false, "id": 17692, "mutability": "mutable", "name": "maturityTime", "nameLocation": "12133:12:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12125:20:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17691, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12125:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17694, "initialValue": { "id": 17693, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17515, "src": "12148:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12125:36:123" }, { "assignments": [17696], "declarations": [{ "constant": false, "id": 17696, "mutability": "mutable", "name": "shareReservesDelta_", "nameLocation": "12210:19:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12202:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17695, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12202:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17698, "initialValue": { "id": 17697, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17584, "src": "12232:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12202:48:123" }, { "assignments": [17700], "declarations": [{ "constant": false, "id": 17700, "mutability": "mutable", "name": "totalGovernanceFee_", "nameLocation": "12299:19:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12291:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17699, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12291:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17702, "initialValue": { "id": 17701, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17588, "src": "12321:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12291:48:123" }, { "assignments": [17704], "declarations": [{ "constant": false, "id": 17704, "mutability": "mutable", "name": "vaultSharePrice_", "nameLocation": "12388:16:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12380:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17703, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "12380:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17706, "initialValue": { "id": 17705, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17544, "src": "12407:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "12380:42:123" }, { "assignments": [17711], "declarations": [{ "constant": false, "id": 17711, "mutability": "mutable", "name": "options", "nameLocation": "12492:7:123", "nodeType": "VariableDeclaration", "scope": 17751, "src": "12463:36:123", "stateVariable": false, "storageLocation": "calldata", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options" }, "typeName": { "id": 17710, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 17709, "name": "IHyperdrive.Options", "nameLocations": ["12463:11:123", "12475:7:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 10990, "src": "12463:19:123" }, "referencedDeclaration": 10990, "src": "12463:19:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_storage_ptr", "typeString": "struct IHyperdrive.Options" } }, "visibility": "internal" }], "id": 17713, "initialValue": { "id": 17712, "name": "_options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17522, "src": "12502:8:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "nodeType": "VariableDeclarationStatement", "src": "12463:47:123" }, { "eventCall": { "arguments": [{ "expression": { "id": 17715, "name": "msg", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -15, "src": "12580:3:123", "typeDescriptions": { "typeIdentifier": "t_magic_message", "typeString": "msg" } }, "id": 17716, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12584:6:123", "memberName": "sender", "nodeType": "MemberAccess", "src": "12580:10:123", "typeDescriptions": { "typeIdentifier": "t_address", "typeString": "address" } }, { "expression": { "id": 17717, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17711, "src": "12614:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "id": 17718, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12622:11:123", "memberName": "destination", "nodeType": "MemberAccess", "referencedDeclaration": 10983, "src": "12614:19:123", "typeDescriptions": { "typeIdentifier": "t_address", "typeString": "address" } }, { "arguments": [{ "expression": { "expression": { "id": 17721, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "12684:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17722, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12692:13:123", "memberName": "AssetIdPrefix", "nodeType": "MemberAccess", "referencedDeclaration": 18519, "src": "12684:21:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_AssetIdPrefix_$18519_$", "typeString": "type(enum AssetId.AssetIdPrefix)" } }, "id": 17723, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "12706:5:123", "memberName": "Short", "nodeType": "MemberAccess", "referencedDeclaration": 18517, "src": "12684:27:123", "typeDescriptions": { "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" } }, { "id": 17724, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17692, "src": "12713:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_AssetIdPrefix_$18519", "typeString": "enum AssetId.AssetIdPrefix" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 17719, "name": "AssetId", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18772, "src": "12662:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_AssetId_$18772_$", "typeString": "type(library AssetId)" } }, "id": 17720, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "12670:13:123", "memberName": "encodeAssetId", "nodeType": "MemberAccess", "referencedDeclaration": 18542, "src": "12662:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_AssetIdPrefix_$18519_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (enum AssetId.AssetIdPrefix,uint256) pure returns (uint256)" } }, "id": 17725, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12662:64:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17726, "name": "maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17692, "src": "12740:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "id": 17728, "name": "proceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17670, "src": "12820:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17729, "name": "vaultSharePrice_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17704, "src": "12830:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17730, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17711, "src": "12848:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17727, "name": "_convertToBaseFromOption", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14458, "src": "12795:24:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,struct IHyperdrive.Options calldata) pure returns (uint256)" } }, "id": 17731, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12795:61:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "id": 17733, "name": "proceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17670, "src": "12956:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17734, "name": "vaultSharePrice_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17704, "src": "12982:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17735, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17711, "src": "13016:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" }], "id": 17732, "name": "_convertToVaultSharesFromOption", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14484, "src": "12907:31:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_struct$_Options_$10990_calldata_ptr_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,struct IHyperdrive.Options calldata) pure returns (uint256)" } }, "id": 17736, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12907:130:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17737, "name": "options", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17711, "src": "13051:7:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options calldata" } }, "id": 17738, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "13059:6:123", "memberName": "asBase", "nodeType": "MemberAccess", "referencedDeclaration": 10986, "src": "13051:14:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, { "arguments": [{ "id": 17744, "name": "vaultSharePrice_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17704, "src": "13299:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "components": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17741, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17739, "name": "shareReservesDelta_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17696, "src": "13231:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 17740, "name": "totalGovernanceFee_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17700, "src": "13253:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "13231:41:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 17742, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "13230:43:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17743, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "13274:7:123", "memberName": "mulDown", "nodeType": "MemberAccess", "referencedDeclaration": 18852, "src": "13230:51:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 17745, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "13230:99:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17746, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17688, "src": "13343:10:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_address", "typeString": "address" }, { "typeIdentifier": "t_address", "typeString": "address" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_bool", "typeString": "bool" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17714, "name": "CloseShort", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11611, "src": "12556:10:123", "typeDescriptions": { "typeIdentifier": "t_function_event_nonpayable$_t_address_$_t_address_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$_t_uint256_$_t_uint256_$returns$__$", "typeString": "function (address,address,uint256,uint256,uint256,uint256,bool,uint256,uint256)" } }, "id": 17747, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "12556:807:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17748, "nodeType": "EmitStatement", "src": "12551:812:123" }, { "expression": { "id": 17749, "name": "proceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17670, "src": "13381:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "functionReturnParameters": 17528, "id": 17750, "nodeType": "Return", "src": "13374:15:123" }] }, "documentation": { "id": 17513, "nodeType": "StructuredDocumentation", "src": "6406:644:123", "text": "@dev Closes a short position with a specified maturity time.\n @param _maturityTime The maturity time of the short.\n @param _bondAmount The amount of shorts to close.\n @param _minOutput The minimum output of this trade. The units of this\n        quantity are either base or vault shares, depending on the value\n        of `_options.asBase`.\n @param _options The options that configure how the trade is settled.\n @return The proceeds of closing this short. The units of this quantity\n         are either base or vault shares, depending on the value of\n         `_options.asBase`." }, "implemented": true, "kind": "function", "modifiers": [{ "id": 17525, "kind": "modifierInvocation", "modifierName": { "id": 17524, "name": "nonReentrant", "nameLocations": ["7226:12:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 72137, "src": "7226:12:123" }, "nodeType": "ModifierInvocation", "src": "7226:12:123" }], "name": "_closeShort", "nameLocation": "7064:11:123", "parameters": { "id": 17523, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17515, "mutability": "mutable", "name": "_maturityTime", "nameLocation": "7093:13:123", "nodeType": "VariableDeclaration", "scope": 17752, "src": "7085:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17514, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7085:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17517, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "7124:11:123", "nodeType": "VariableDeclaration", "scope": 17752, "src": "7116:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17516, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7116:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17519, "mutability": "mutable", "name": "_minOutput", "nameLocation": "7153:10:123", "nodeType": "VariableDeclaration", "scope": 17752, "src": "7145:18:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17518, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7145:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17522, "mutability": "mutable", "name": "_options", "nameLocation": "7202:8:123", "nodeType": "VariableDeclaration", "scope": 17752, "src": "7173:37:123", "stateVariable": false, "storageLocation": "calldata", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_calldata_ptr", "typeString": "struct IHyperdrive.Options" }, "typeName": { "id": 17521, "nodeType": "UserDefinedTypeName", "pathNode": { "id": 17520, "name": "IHyperdrive.Options", "nameLocations": ["7173:11:123", "7185:7:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 10990, "src": "7173:19:123" }, "referencedDeclaration": 10990, "src": "7173:19:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Options_$10990_storage_ptr", "typeString": "struct IHyperdrive.Options" } }, "visibility": "internal" }], "src": "7075:141:123" }, "returnParameters": { "id": 17528, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17527, "mutability": "mutable", "name": "", "nameLocation": "-1:-1:-1", "nodeType": "VariableDeclaration", "scope": 17752, "src": "7248:7:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17526, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "7248:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "7247:9:123" }, "scope": 18281, "stateMutability": "nonpayable", "virtual": false, "visibility": "internal" }, { "id": 17895, "nodeType": "FunctionDefinition", "src": "13794:3622:123", "nodes": [], "body": { "id": 17894, "nodeType": "Block", "src": "13965:3451:123", "nodes": [], "statements": [{ "assignments": [17765], "declarations": [{ "constant": false, "id": 17765, "mutability": "mutable", "name": "shareReserves", "nameLocation": "14122:13:123", "nodeType": "VariableDeclaration", "scope": 17894, "src": "14114:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17764, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "14114:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 17768, "initialValue": { "expression": { "id": 17766, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "14138:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17767, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "14151:13:123", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10795, "src": "14138:26:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "VariableDeclarationStatement", "src": "14114:50:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17771, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17769, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17765, "src": "14178:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17770, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17757, "src": "14194:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "14178:35:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17781, "nodeType": "IfStatement", "src": "14174:192:123", "trueBody": { "id": 17780, "nodeType": "Block", "src": "14215:151:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 17775, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "14285:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17776, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "14297:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "14285:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 17777, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "14325:16:123", "memberName": "SolvencyViolated", "nodeType": "MemberAccess", "referencedDeclaration": 10995, "src": "14285:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 17772, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "14229:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 17774, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "14236:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "14229:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 17778, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "14229:126:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17779, "nodeType": "ExpressionStatement", "src": "14229:126:123" }] } }, { "id": 17786, "nodeType": "UncheckedBlock", "src": "14375:71:123", "statements": [{ "expression": { "id": 17784, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 17782, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17765, "src": "14399:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "id": 17783, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17757, "src": "14416:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "14399:36:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17785, "nodeType": "ExpressionStatement", "src": "14399:36:123" }] }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17794, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "id": 17789, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17765, "src": "14879:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17790, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "14910:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17791, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "14923:15:123", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 10807, "src": "14910:28:123", "typeDescriptions": { "typeIdentifier": "t_int128", "typeString": "int128" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_int128", "typeString": "int128" }], "expression": { "id": 17787, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "14815:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 17788, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "14830:31:123", "memberName": "calculateEffectiveShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 19763, "src": "14815:46:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_int256_$returns$_t_uint256_$", "typeString": "function (uint256,int256) pure returns (uint256)" } }, "id": 17792, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "14815:137:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 17793, "name": "_minimumShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18331, "src": "14955:21:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "14815:161:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17804, "nodeType": "IfStatement", "src": "14798:395:123", "trueBody": { "id": 17803, "nodeType": "Block", "src": "14987:206:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 17798, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "15057:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17799, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15090:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "15057:60:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 17800, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "15139:29:123", "memberName": "InvalidEffectiveShareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10993, "src": "15057:111:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 17795, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "15001:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 17797, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15008:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "15001:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 17801, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15001:181:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17802, "nodeType": "ExpressionStatement", "src": "15001:181:123" }] } }, { "expression": { "id": 17824, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17805, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "15267:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17807, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "15280:24:123", "memberName": "shortAverageMaturityTime", "nodeType": "MemberAccess", "referencedDeclaration": 10816, "src": "15267:37:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "expression": { "id": 17814, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "15428:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17815, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15441:17:123", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 10810, "src": "15428:30:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17818, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17816, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17761, "src": "15476:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": { "id": 17817, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "15492:3:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "15476:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17819, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17755, "src": "15546:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "74727565", "id": 17820, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "15575:4:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "true" }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_bool", "typeString": "bool" }], "expression": { "arguments": [{ "expression": { "id": 17810, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "15328:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17811, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "15341:24:123", "memberName": "shortAverageMaturityTime", "nodeType": "MemberAccess", "referencedDeclaration": 10816, "src": "15328:37:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint128", "typeString": "uint128" }], "id": 17809, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "15307:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 17808, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "15307:7:123", "typeDescriptions": {} } }, "id": 17812, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15307:68:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17813, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15389:21:123", "memberName": "updateWeightedAverage", "nodeType": "MemberAccess", "referencedDeclaration": 19499, "src": "15307:103:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool) pure returns (uint256)" } }, "id": 17821, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15307:286:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17822, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15607:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "15307:309:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17823, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15307:311:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "15267:351:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17825, "nodeType": "ExpressionStatement", "src": "15267:351:123" }, { "expression": { "id": 17832, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17826, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "15912:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17828, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "15925:13:123", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10795, "src": "15912:26:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17829, "name": "shareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17765, "src": "15941:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17830, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "15955:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "15941:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17831, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "15941:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "15912:54:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17833, "nodeType": "ExpressionStatement", "src": "15912:54:123" }, { "expression": { "id": 17840, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17834, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "15976:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17836, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "15989:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "15976:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17837, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17755, "src": "16005:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17838, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16017:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "16005:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17839, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16005:23:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "15976:52:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17841, "nodeType": "ExpressionStatement", "src": "15976:52:123" }, { "expression": { "id": 17848, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17842, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "16038:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17844, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "16051:17:123", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 10810, "src": "16038:30:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17845, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17755, "src": "16072:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17846, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16084:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "16072:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17847, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16072:23:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "16038:57:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17849, "nodeType": "ExpressionStatement", "src": "16038:57:123" }, { "assignments": [17851], "declarations": [{ "constant": false, "id": 17851, "mutability": "mutable", "name": "nonNettedLongs", "nameLocation": "16258:14:123", "nodeType": "VariableDeclaration", "scope": 17894, "src": "16251:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 17850, "name": "int256", "nodeType": "ElementaryTypeName", "src": "16251:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }], "id": 17855, "initialValue": { "arguments": [{ "id": 17853, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17761, "src": "16291:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17852, "name": "_nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13784, "src": "16275:15:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$returns$_t_int256_$", "typeString": "function (uint256) view returns (int256)" } }, "id": 17854, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16275:30:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "VariableDeclarationStatement", "src": "16251:54:123" }, { "expression": { "arguments": [{ "id": 17857, "name": "nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17851, "src": "16348:14:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "commonType": { "typeIdentifier": "t_int256", "typeString": "int256" }, "id": 17862, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17858, "name": "nonNettedLongs", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17851, "src": "16376:14:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17859, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17755, "src": "16393:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17860, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16405:8:123", "memberName": "toInt256", "nodeType": "MemberAccess", "referencedDeclaration": 22442, "src": "16393:20:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_int256_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (int256)" } }, "id": 17861, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16393:22:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "src": "16376:39:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_int256", "typeString": "int256" }, { "typeIdentifier": "t_int256", "typeString": "int256" }], "id": 17856, "name": "_updateLongExposure", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14025, "src": "16315:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_int256_$_t_int256_$returns$__$", "typeString": "function (int256,int256)" } }, "id": 17863, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16315:110:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17864, "nodeType": "ExpressionStatement", "src": "16315:110:123" }, { "condition": { "id": 17868, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "16841:29:123", "subExpression": { "arguments": [{ "id": 17866, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17759, "src": "16853:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17865, "name": "_isSolvent", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13972, "src": "16842:10:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) view returns (bool)" } }, "id": 17867, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16842:28:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17878, "nodeType": "IfStatement", "src": "16837:186:123", "trueBody": { "id": 17877, "nodeType": "Block", "src": "16872:151:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 17872, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "16942:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17873, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16954:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "16942:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 17874, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "16982:16:123", "memberName": "SolvencyViolated", "nodeType": "MemberAccess", "referencedDeclaration": 10995, "src": "16942:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 17869, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "16886:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 17871, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "16893:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "16886:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 17875, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "16886:126:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17876, "nodeType": "ExpressionStatement", "src": "16886:126:123" }] } }, { "assignments": [17880], "declarations": [{ "constant": false, "id": 17880, "mutability": "mutable", "name": "success", "nameLocation": "17261:7:123", "nodeType": "VariableDeclaration", "scope": 17894, "src": "17256:12:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "typeName": { "id": 17879, "name": "bool", "nodeType": "ElementaryTypeName", "src": "17256:4:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "visibility": "internal" }], "id": 17884, "initialValue": { "arguments": [{ "id": 17882, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17759, "src": "17297:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 17881, "name": "_distributeExcessIdleSafe", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 15800, "src": "17271:25:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_nonpayable$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256) returns (bool)" } }, "id": 17883, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "17271:43:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "nodeType": "VariableDeclarationStatement", "src": "17256:58:123" }, { "condition": { "id": 17886, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "UnaryOperation", "operator": "!", "prefix": true, "src": "17328:8:123", "subExpression": { "id": 17885, "name": "success", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17880, "src": "17329:7:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 17893, "nodeType": "IfStatement", "src": "17324:86:123", "trueBody": { "id": 17892, "nodeType": "Block", "src": "17338:72:123", "statements": [{ "errorCall": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17887, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "17359:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 17889, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "17371:26:123", "memberName": "DistributeExcessIdleFailed", "nodeType": "MemberAccess", "referencedDeclaration": 11085, "src": "17359:38:123", "typeDescriptions": { "typeIdentifier": "t_function_error_pure$__$returns$__$", "typeString": "function () pure" } }, "id": 17890, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "17359:40:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 17891, "nodeType": "RevertStatement", "src": "17352:47:123" }] } }] }, "documentation": { "id": 17753, "nodeType": "StructuredDocumentation", "src": "13402:387:123", "text": "@dev Applies an open short to the state. This includes updating the\n      reserves and maintaining the reserve invariants.\n @param _bondAmount The amount of bonds shorted.\n @param _shareReservesDelta The amount of shares paid to the curve.\n @param _vaultSharePrice The current vault share price.\n @param _maturityTime The maturity time of the long." }, "implemented": true, "kind": "function", "modifiers": [], "name": "_applyOpenShort", "nameLocation": "13803:15:123", "parameters": { "id": 17762, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17755, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "13836:11:123", "nodeType": "VariableDeclaration", "scope": 17895, "src": "13828:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17754, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13828:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17757, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "13865:19:123", "nodeType": "VariableDeclaration", "scope": 17895, "src": "13857:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17756, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13857:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17759, "mutability": "mutable", "name": "_vaultSharePrice", "nameLocation": "13902:16:123", "nodeType": "VariableDeclaration", "scope": 17895, "src": "13894:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17758, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13894:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17761, "mutability": "mutable", "name": "_maturityTime", "nameLocation": "13936:13:123", "nodeType": "VariableDeclaration", "scope": 17895, "src": "13928:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17760, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "13928:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "13818:137:123" }, "returnParameters": { "id": 17763, "nodeType": "ParameterList", "parameters": [], "src": "13965:0:123" }, "scope": 18281, "stateMutability": "nonpayable", "virtual": false, "visibility": "internal" }, { "id": 17969, "nodeType": "FunctionDefinition", "src": "17905:1127:123", "nodes": [], "body": { "id": 17968, "nodeType": "Block", "src": "18117:915:123", "nodes": [], "statements": [{ "assignments": [17910], "declarations": [{ "constant": false, "id": 17910, "mutability": "mutable", "name": "shortsOutstanding_", "nameLocation": "18186:18:123", "nodeType": "VariableDeclaration", "scope": 17968, "src": "18178:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" }, "typeName": { "id": 17909, "name": "uint128", "nodeType": "ElementaryTypeName", "src": "18178:7:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "visibility": "internal" }], "id": 17913, "initialValue": { "expression": { "id": 17911, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18207:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17912, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "18220:17:123", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 10810, "src": "18207:30:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "VariableDeclarationStatement", "src": "18178:59:123" }, { "expression": { "id": 17932, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17914, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18247:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17916, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "18260:24:123", "memberName": "shortAverageMaturityTime", "nodeType": "MemberAccess", "referencedDeclaration": 10816, "src": "18247:37:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "arguments": [{ "id": 17923, "name": "shortsOutstanding_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17910, "src": "18408:18:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 17926, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17924, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17906, "src": "18444:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "*", "rightExpression": { "id": 17925, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "18460:3:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "18444:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17927, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17898, "src": "18514:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "66616c7365", "id": 17928, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "18543:5:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_bool", "typeString": "bool" }], "expression": { "arguments": [{ "expression": { "id": 17919, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18308:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17920, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "18321:24:123", "memberName": "shortAverageMaturityTime", "nodeType": "MemberAccess", "referencedDeclaration": 10816, "src": "18308:37:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint128", "typeString": "uint128" }], "id": 17918, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "nodeType": "ElementaryTypeNameExpression", "src": "18287:7:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_uint256_$", "typeString": "type(uint256)" }, "typeName": { "id": 17917, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "18287:7:123", "typeDescriptions": {} } }, "id": 17921, "isConstant": false, "isLValue": false, "isPure": false, "kind": "typeConversion", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18287:68:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17922, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18369:21:123", "memberName": "updateWeightedAverage", "nodeType": "MemberAccess", "referencedDeclaration": 19499, "src": "18287:103:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,bool) pure returns (uint256)" } }, "id": 17929, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18287:275:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17930, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18576:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "18287:298:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17931, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18287:300:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "18247:340:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17933, "nodeType": "ExpressionStatement", "src": "18247:340:123" }, { "expression": { "id": 17942, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17934, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18652:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17936, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "18665:17:123", "memberName": "shortsOutstanding", "nodeType": "MemberAccess", "referencedDeclaration": 10810, "src": "18652:30:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint128", "typeString": "uint128" }, "id": 17941, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 17937, "name": "shortsOutstanding_", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17910, "src": "18697:18:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17938, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17898, "src": "18730:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17939, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18742:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "18730:21:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17940, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18730:23:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "18697:56:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "18652:101:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17943, "nodeType": "ExpressionStatement", "src": "18652:101:123" }, { "expression": { "id": 17950, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17944, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18821:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17946, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "18834:13:123", "memberName": "shareReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10795, "src": "18821:26:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17947, "name": "_shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17902, "src": "18851:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17948, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18871:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "18851:29:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17949, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18851:31:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "18821:61:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17951, "nodeType": "ExpressionStatement", "src": "18821:61:123" }, { "expression": { "id": 17958, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17952, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18892:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17954, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "18905:15:123", "memberName": "shareAdjustment", "nodeType": "MemberAccess", "referencedDeclaration": 10807, "src": "18892:28:123", "typeDescriptions": { "typeIdentifier": "t_int128", "typeString": "int128" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17955, "name": "_shareAdjustmentDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17904, "src": "18924:21:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "id": 17956, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "18946:8:123", "memberName": "toInt128", "nodeType": "MemberAccess", "referencedDeclaration": 22407, "src": "18924:30:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_int256_$returns$_t_int128_$attached_to$_t_int256_$", "typeString": "function (int256) pure returns (int128)" } }, "id": 17957, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18924:32:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_int128", "typeString": "int128" } }, "src": "18892:64:123", "typeDescriptions": { "typeIdentifier": "t_int128", "typeString": "int128" } }, "id": 17959, "nodeType": "ExpressionStatement", "src": "18892:64:123" }, { "expression": { "id": 17966, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "expression": { "id": 17960, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "18966:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17962, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": true, "memberLocation": "18979:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "18966:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "arguments": [], "expression": { "argumentTypes": [], "expression": { "id": 17963, "name": "_bondReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17900, "src": "18995:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17964, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "19014:9:123", "memberName": "toUint128", "nodeType": "MemberAccess", "referencedDeclaration": 22329, "src": "18995:28:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$returns$_t_uint128_$attached_to$_t_uint256_$", "typeString": "function (uint256) pure returns (uint128)" } }, "id": 17965, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "18995:30:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "src": "18966:59:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 17967, "nodeType": "ExpressionStatement", "src": "18966:59:123" }] }, "documentation": { "id": 17896, "nodeType": "StructuredDocumentation", "src": "17422:478:123", "text": "@dev Applies the trading deltas from a closed short to the reserves and\n      the withdrawal pool.\n @param _bondAmount The amount of shorts that were closed.\n @param _bondReservesDelta The amount of bonds removed from the reserves.\n @param _shareReservesDelta The amount of shares added to the reserves.\n @param _shareAdjustmentDelta The amount to increase the share adjustment.\n @param _maturityTime The maturity time of the short." }, "implemented": true, "kind": "function", "modifiers": [], "name": "_applyCloseShort", "nameLocation": "17914:16:123", "parameters": { "id": 17907, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17898, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "17948:11:123", "nodeType": "VariableDeclaration", "scope": 17969, "src": "17940:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17897, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "17940:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17900, "mutability": "mutable", "name": "_bondReservesDelta", "nameLocation": "17977:18:123", "nodeType": "VariableDeclaration", "scope": 17969, "src": "17969:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17899, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "17969:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17902, "mutability": "mutable", "name": "_shareReservesDelta", "nameLocation": "18013:19:123", "nodeType": "VariableDeclaration", "scope": 17969, "src": "18005:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17901, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "18005:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17904, "mutability": "mutable", "name": "_shareAdjustmentDelta", "nameLocation": "18049:21:123", "nodeType": "VariableDeclaration", "scope": 17969, "src": "18042:28:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 17903, "name": "int256", "nodeType": "ElementaryTypeName", "src": "18042:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 17906, "mutability": "mutable", "name": "_maturityTime", "nameLocation": "18088:13:123", "nodeType": "VariableDeclaration", "scope": 17969, "src": "18080:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17905, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "18080:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "17930:177:123" }, "returnParameters": { "id": 17908, "nodeType": "ParameterList", "parameters": [], "src": "18117:0:123" }, "scope": 18281, "stateMutability": "nonpayable", "virtual": false, "visibility": "internal" }, { "id": 18076, "nodeType": "FunctionDefinition", "src": "19644:4007:123", "nodes": [], "body": { "id": 18075, "nodeType": "Block", "src": "19954:3697:123", "nodes": [], "statements": [{ "expression": { "id": 17997, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 17985, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17981, "src": "20180:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [], "expression": { "argumentTypes": [], "id": 17988, "name": "_effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13751, "src": "20248:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 17989, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20248:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 17990, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "20287:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 17991, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "20300:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "20287:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "id": 17992, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17972, "src": "20326:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17993, "name": "_timeStretch", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18313, "src": "20351:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17994, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "20377:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 17995, "name": "_initialVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18328, "src": "20407:23:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 17986, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "20201:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 17987, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20216:18:123", "memberName": "calculateOpenShort", "nodeType": "MemberAccess", "referencedDeclaration": 20154, "src": "20201:33:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 17996, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20201:239:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "20180:260:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 17998, "nodeType": "ExpressionStatement", "src": "20180:260:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18004, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "id": 18001, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "20749:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 17999, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17981, "src": "20724:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18000, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20743:5:123", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18902, "src": "20724:24:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 18002, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20724:42:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "id": 18003, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17972, "src": "20769:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "20724:56:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 18014, "nodeType": "IfStatement", "src": "20720:213:123", "trueBody": { "id": 18013, "nodeType": "Block", "src": "20782:151:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 18008, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "20852:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 18009, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20864:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "20852:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 18010, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "20892:16:123", "memberName": "NegativeInterest", "nodeType": "MemberAccess", "referencedDeclaration": 10994, "src": "20852:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 18005, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "20796:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 18007, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "20803:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "20796:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 18011, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "20796:126:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18012, "nodeType": "ExpressionStatement", "src": "20796:126:123" }] } }, { "assignments": [18016], "declarations": [{ "constant": false, "id": 18016, "mutability": "mutable", "name": "curveFee", "nameLocation": "21103:8:123", "nodeType": "VariableDeclaration", "scope": 18075, "src": "21095:16:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18015, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21095:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18017, "nodeType": "VariableDeclarationStatement", "src": "21095:16:123" }, { "assignments": [18019], "declarations": [{ "constant": false, "id": 18019, "mutability": "mutable", "name": "governanceCurveFee", "nameLocation": "21129:18:123", "nodeType": "VariableDeclaration", "scope": 18075, "src": "21121:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18018, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21121:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18020, "nodeType": "VariableDeclarationStatement", "src": "21121:26:123" }, { "assignments": [18022], "declarations": [{ "constant": false, "id": 18022, "mutability": "mutable", "name": "spotPrice", "nameLocation": "21165:9:123", "nodeType": "VariableDeclaration", "scope": 18075, "src": "21157:17:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18021, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "21157:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18032, "initialValue": { "arguments": [{ "arguments": [], "expression": { "argumentTypes": [], "id": 18025, "name": "_effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13751, "src": "21224:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 18026, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "21224:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 18027, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "21263:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 18028, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "21276:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "21263:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "id": 18029, "name": "_initialVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18328, "src": "21302:23:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18030, "name": "_timeStretch", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18313, "src": "21339:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18023, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "21177:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18024, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "21192:18:123", "memberName": "calculateSpotPrice", "nodeType": "MemberAccess", "referencedDeclaration": 19690, "src": "21177:33:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 18031, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "21177:184:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "21157:204:123" }, { "expression": { "id": 18042, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 18033, "name": "curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18016, "src": "21525:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, null, { "id": 18034, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18019, "src": "21537:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, null], "id": 18035, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "21524:34:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$__$_t_uint256_$__$", "typeString": "tuple(uint256,,uint256,)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 18037, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17972, "src": "21599:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18038, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "21624:3:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18039, "name": "spotPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18022, "src": "21691:9:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18040, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "21714:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 18036, "name": "_calculateFeesGivenBonds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14432, "src": "21561:24:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256) view returns (uint256,uint256,uint256,uint256)" } }, "id": 18041, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "21561:179:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,uint256)" } }, "src": "21524:216:123", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18043, "nodeType": "ExpressionStatement", "src": "21524:216:123" }, { "expression": { "id": 18048, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18044, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17981, "src": "22391:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18047, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 18045, "name": "curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18016, "src": "22413:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 18046, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18019, "src": "22424:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "22413:29:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "22391:51:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18049, "nodeType": "ExpressionStatement", "src": "22391:51:123" }, { "expression": { "id": 18068, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18050, "name": "baseDeposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17979, "src": "23017:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 18066, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "23556:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "arguments": [{ "id": 18053, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17972, "src": "23101:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18056, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 18054, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17981, "src": "23325:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 18055, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18019, "src": "23346:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "23325:39:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18057, "name": "_openVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17976, "src": "23382:20:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "id": 18060, "name": "_openVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17976, "src": "23441:20:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18058, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "23420:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18059, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "23437:3:123", "memberName": "max", "nodeType": "MemberAccess", "referencedDeclaration": 19535, "src": "23420:20:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 18061, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23420:42:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18062, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17974, "src": "23480:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18063, "name": "_flatFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18319, "src": "23514:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18051, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "23031:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18052, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "23059:24:123", "memberName": "calculateShortProceedsUp", "nodeType": "MemberAccess", "referencedDeclaration": 19919, "src": "23031:52:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 18064, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23031:505:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18065, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "23550:5:123", "memberName": "mulUp", "nodeType": "MemberAccess", "referencedDeclaration": 18902, "src": "23031:524:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$attached_to$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 18067, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "23031:542:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "23017:556:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18069, "nodeType": "ExpressionStatement", "src": "23017:556:123" }, { "expression": { "components": [{ "id": 18070, "name": "baseDeposit", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17979, "src": "23592:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18071, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 17981, "src": "23605:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18072, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18019, "src": "23625:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 18073, "isConstant": false, "isInlineArray": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "TupleExpression", "src": "23591:53:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256)" } }, "functionReturnParameters": 17984, "id": 18074, "nodeType": "Return", "src": "23584:60:123" }] }, "documentation": { "id": 17970, "nodeType": "StructuredDocumentation", "src": "19038:601:123", "text": "@dev Calculate the pool reserve and trader deltas that result from\n      opening a short. This calculation includes trading fees.\n @param _bondAmount The amount of bonds being sold to open the short.\n @param _vaultSharePrice The current vault share price.\n @param _openVaultSharePrice The vault share price at the beginning of\n        the checkpoint.\n @return baseDeposit The deposit, in base, required to open the short.\n @return shareReservesDelta The change in the share reserves.\n @return totalGovernanceFee The governance fee in shares." }, "implemented": true, "kind": "function", "modifiers": [], "name": "_calculateOpenShort", "nameLocation": "19653:19:123", "parameters": { "id": 17977, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17972, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "19690:11:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19682:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17971, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19682:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17974, "mutability": "mutable", "name": "_vaultSharePrice", "nameLocation": "19719:16:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19711:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17973, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19711:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17976, "mutability": "mutable", "name": "_openVaultSharePrice", "nameLocation": "19753:20:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19745:28:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17975, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19745:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "19672:107:123" }, "returnParameters": { "id": 17984, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 17979, "mutability": "mutable", "name": "baseDeposit", "nameLocation": "19848:11:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19840:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17978, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19840:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17981, "mutability": "mutable", "name": "shareReservesDelta", "nameLocation": "19881:18:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19873:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17980, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19873:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 17983, "mutability": "mutable", "name": "totalGovernanceFee", "nameLocation": "19921:18:123", "nodeType": "VariableDeclaration", "scope": 18076, "src": "19913:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 17982, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "19913:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "19826:123:123" }, "scope": 18281, "stateMutability": "view", "virtual": false, "visibility": "internal" }, { "id": 18280, "nodeType": "FunctionDefinition", "src": "24382:7139:123", "nodes": [], "body": { "id": 18279, "nodeType": "Block", "src": "24768:6753:123", "nodes": [], "statements": [{ "assignments": [18097], "declarations": [{ "constant": false, "id": 18097, "mutability": "mutable", "name": "shareCurveDelta", "nameLocation": "25007:15:123", "nodeType": "VariableDeclaration", "scope": 18279, "src": "24999:23:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18096, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24999:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18098, "nodeType": "VariableDeclarationStatement", "src": "24999:23:123" }, { "id": 18196, "nodeType": "Block", "src": "25032:3532:123", "statements": [{ "assignments": [18100], "declarations": [{ "constant": false, "id": 18100, "mutability": "mutable", "name": "timeRemaining", "nameLocation": "25488:13:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "25480:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18099, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "25480:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18104, "initialValue": { "arguments": [{ "id": 18102, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18083, "src": "25528:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 18101, "name": "_calculateTimeRemaining", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13682, "src": "25504:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256) view returns (uint256)" } }, "id": 18103, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "25504:38:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "25480:62:123" }, { "expression": { "id": 18121, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 18105, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "25574:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18106, "name": "bondReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18086, "src": "25607:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18107, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "25642:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 18108, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "25556:118:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "arguments": [], "expression": { "argumentTypes": [], "id": 18111, "name": "_effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13751, "src": "25729:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 18112, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "25729:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 18113, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "25772:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 18114, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "25785:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "25772:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "id": 18115, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18079, "src": "25815:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18116, "name": "timeRemaining", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18100, "src": "25844:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18117, "name": "_timeStretch", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18313, "src": "25875:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18118, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18081, "src": "25905:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18119, "name": "_initialVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18328, "src": "25939:23:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18109, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "25677:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18110, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "25692:19:123", "memberName": "calculateCloseShort", "nodeType": "MemberAccess", "referencedDeclaration": 20219, "src": "25677:34:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256,uint256,uint256)" } }, "id": 18120, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "25677:299:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256)" } }, "src": "25556:420:123", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18122, "nodeType": "ExpressionStatement", "src": "25556:420:123" }, { "assignments": [18124], "declarations": [{ "constant": false, "id": 18124, "mutability": "mutable", "name": "spotPrice", "nameLocation": "26129:9:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "26121:17:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18123, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "26121:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18134, "initialValue": { "arguments": [{ "arguments": [], "expression": { "argumentTypes": [], "id": 18127, "name": "_effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13751, "src": "26192:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 18128, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "26192:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "expression": { "id": 18129, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "26235:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 18130, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "26248:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "26235:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, { "id": 18131, "name": "_initialVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18328, "src": "26278:23:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18132, "name": "_timeStretch", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18313, "src": "26319:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint128", "typeString": "uint128" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18125, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "26141:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18126, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "26156:18:123", "memberName": "calculateSpotPrice", "nodeType": "MemberAccess", "referencedDeclaration": 19690, "src": "26141:33:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 18133, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "26141:204:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "26121:224:123" }, { "condition": { "arguments": [{ "id": 18136, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "26421:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18137, "name": "bondReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18086, "src": "26458:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "arguments": [{ "id": 18140, "name": "spotPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18124, "src": "26569:9:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18141, "name": "_curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18316, "src": "26604:9:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18138, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "26497:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18139, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "26512:31:123", "memberName": "calculateCloseShortMaxSpotPrice", "nodeType": "MemberAccess", "referencedDeclaration": 20027, "src": "26497:46:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256) pure returns (uint256)" } }, "id": 18142, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "26497:138:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 18135, "name": "_isNegativeInterest", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13946, "src": "26380:19:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_bool_$", "typeString": "function (uint256,uint256,uint256) view returns (bool)" } }, "id": 18143, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "26380:273:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 18153, "nodeType": "IfStatement", "src": "26359:476:123", "trueBody": { "id": 18152, "nodeType": "Block", "src": "26668:167:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 18147, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "26746:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 18148, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "26758:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "26746:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 18149, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "26786:16:123", "memberName": "NegativeInterest", "nodeType": "MemberAccess", "referencedDeclaration": 10994, "src": "26746:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 18144, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "26686:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 18146, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "26693:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "26686:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 18150, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "26686:134:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18151, "nodeType": "ExpressionStatement", "src": "26686:134:123" }] } }, { "assignments": [18155], "declarations": [{ "constant": false, "id": 18155, "mutability": "mutable", "name": "bondAmount", "nameLocation": "27044:10:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "27036:18:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18154, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27036:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18157, "initialValue": { "id": 18156, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18079, "src": "27057:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "27036:32:123" }, { "assignments": [18159], "declarations": [{ "constant": false, "id": 18159, "mutability": "mutable", "name": "vaultSharePrice", "nameLocation": "27115:15:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "27107:23:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18158, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27107:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18161, "initialValue": { "id": 18160, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18081, "src": "27133:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "27107:42:123" }, { "assignments": [18163], "declarations": [{ "constant": false, "id": 18163, "mutability": "mutable", "name": "curveFee", "nameLocation": "27196:8:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "27188:16:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18162, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27188:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18164, "nodeType": "VariableDeclarationStatement", "src": "27188:16:123" }, { "assignments": [18166], "declarations": [{ "constant": false, "id": 18166, "mutability": "mutable", "name": "flatFee", "nameLocation": "27226:7:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "27218:15:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18165, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27218:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18167, "nodeType": "VariableDeclarationStatement", "src": "27218:15:123" }, { "assignments": [18169], "declarations": [{ "constant": false, "id": 18169, "mutability": "mutable", "name": "governanceCurveFee", "nameLocation": "27255:18:123", "nodeType": "VariableDeclaration", "scope": 18196, "src": "27247:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18168, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "27247:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18170, "nodeType": "VariableDeclarationStatement", "src": "27247:26:123" }, { "expression": { "id": 18182, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 18171, "name": "curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18163, "src": "27305:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18172, "name": "flatFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18166, "src": "27331:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18173, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18169, "src": "27356:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18174, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18094, "src": "27392:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 18175, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "27287:137:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,uint256)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 18177, "name": "bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18155, "src": "27469:10:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18178, "name": "timeRemaining", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18100, "src": "27497:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18179, "name": "spotPrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18124, "src": "27528:9:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18180, "name": "vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18159, "src": "27555:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "id": 18176, "name": "_calculateFeesGivenBonds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 14432, "src": "27427:24:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256) view returns (uint256,uint256,uint256,uint256)" } }, "id": 18181, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "27427:157:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,uint256)" } }, "src": "27287:297:123", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18183, "nodeType": "ExpressionStatement", "src": "27287:297:123" }, { "expression": { "id": 18188, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18184, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "28213:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18187, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 18185, "name": "curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18163, "src": "28232:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 18186, "name": "governanceCurveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18169, "src": "28243:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28232:29:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28213:48:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18189, "nodeType": "ExpressionStatement", "src": "28213:48:123" }, { "expression": { "id": 18194, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18190, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "28513:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "+=", "rightHandSide": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18193, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 18191, "name": "curveFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18163, "src": "28535:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 18192, "name": "flatFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18166, "src": "28546:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28535:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28513:40:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18195, "nodeType": "ExpressionStatement", "src": "28513:40:123" }] }, { "id": 18278, "nodeType": "Block", "src": "28707:2808:123", "statements": [{ "assignments": [18198], "declarations": [{ "constant": false, "id": 18198, "mutability": "mutable", "name": "openVaultSharePrice", "nameLocation": "28729:19:123", "nodeType": "VariableDeclaration", "scope": 18278, "src": "28721:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18197, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "28721:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18205, "initialValue": { "expression": { "baseExpression": { "id": 18199, "name": "_checkpoints", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18348, "src": "28751:12:123", "typeDescriptions": { "typeIdentifier": "t_mapping$_t_uint256_$_t_struct$_Checkpoint_$10833_storage_$", "typeString": "mapping(uint256 => struct IHyperdrive.Checkpoint storage ref)" } }, "id": 18203, "indexExpression": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18202, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "id": 18200, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18083, "src": "28781:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 18201, "name": "_positionDuration", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18310, "src": "28797:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28781:33:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "28751:77:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Checkpoint_$10833_storage", "typeString": "struct IHyperdrive.Checkpoint storage ref" } }, "id": 18204, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "28829:15:123", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 10832, "src": "28751:93:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "VariableDeclarationStatement", "src": "28721:123:123" }, { "assignments": [18207], "declarations": [{ "constant": false, "id": 18207, "mutability": "mutable", "name": "closeVaultSharePrice", "nameLocation": "28866:20:123", "nodeType": "VariableDeclaration", "scope": 18278, "src": "28858:28:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18206, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "28858:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "id": 18218, "initialValue": { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18211, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 18208, "name": "block", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": -4, "src": "28889:5:123", "typeDescriptions": { "typeIdentifier": "t_magic_block", "typeString": "block" } }, "id": 18209, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "28895:9:123", "memberName": "timestamp", "nodeType": "MemberAccess", "src": "28889:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "<", "rightExpression": { "id": 18210, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18083, "src": "28907:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "28889:31:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "falseExpression": { "expression": { "baseExpression": { "id": 18213, "name": "_checkpoints", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18348, "src": "28974:12:123", "typeDescriptions": { "typeIdentifier": "t_mapping$_t_uint256_$_t_struct$_Checkpoint_$10833_storage_$", "typeString": "mapping(uint256 => struct IHyperdrive.Checkpoint storage ref)" } }, "id": 18215, "indexExpression": { "id": 18214, "name": "_maturityTime", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18083, "src": "28987:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "nodeType": "IndexAccess", "src": "28974:27:123", "typeDescriptions": { "typeIdentifier": "t_struct$_Checkpoint_$10833_storage", "typeString": "struct IHyperdrive.Checkpoint storage ref" } }, "id": 18216, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "29002:15:123", "memberName": "vaultSharePrice", "nodeType": "MemberAccess", "referencedDeclaration": 10832, "src": "28974:43:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "id": 18217, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "nodeType": "Conditional", "src": "28889:128:123", "trueExpression": { "id": 18212, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18081, "src": "28939:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "VariableDeclarationStatement", "src": "28858:159:123" }, { "expression": { "id": 18229, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18219, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18088, "src": "29650:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 18222, "name": "_bondAmount", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18079, "src": "29725:11:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18223, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "29754:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18224, "name": "openVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18198, "src": "29790:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18225, "name": "closeVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18207, "src": "29827:20:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18226, "name": "_vaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18081, "src": "29865:16:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18227, "name": "_flatFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18319, "src": "29899:8:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18220, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "29666:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18221, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "29681:26:123", "memberName": "calculateShortProceedsDown", "nodeType": "MemberAccess", "referencedDeclaration": 19971, "src": "29666:41:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 18228, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "29666:255:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "29650:271:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18230, "nodeType": "ExpressionStatement", "src": "29650:271:123" }, { "expression": { "id": 18233, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "id": 18231, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "30127:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "Assignment", "operator": "-=", "rightHandSide": { "id": 18232, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18094, "src": "30149:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30127:40:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "id": 18234, "nodeType": "ExpressionStatement", "src": "30127:40:123" }, { "condition": { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18249, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [{ "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18240, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "arguments": [], "expression": { "argumentTypes": [], "id": 18237, "name": "_effectiveShareReserves", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 13751, "src": "30323:23:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_view$__$returns$_t_uint256_$", "typeString": "function () view returns (uint256)" } }, "id": 18238, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "30323:25:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": "+", "rightExpression": { "id": 18239, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "30351:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30323:43:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "commonType": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "id": 18244, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftExpression": { "expression": { "id": 18241, "name": "_marketState", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18338, "src": "30388:12:123", "typeDescriptions": { "typeIdentifier": "t_struct$_MarketState_$10829_storage", "typeString": "struct IHyperdrive.MarketState storage ref" } }, "id": 18242, "isConstant": false, "isLValue": true, "isPure": false, "lValueRequested": false, "memberLocation": "30401:12:123", "memberName": "bondReserves", "nodeType": "MemberAccess", "referencedDeclaration": 10798, "src": "30388:25:123", "typeDescriptions": { "typeIdentifier": "t_uint128", "typeString": "uint128" } }, "nodeType": "BinaryOperation", "operator": "-", "rightExpression": { "id": 18243, "name": "bondReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18086, "src": "30416:17:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30388:45:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18245, "name": "_initialVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18328, "src": "30455:23:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18246, "name": "_timeStretch", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18313, "src": "30500:12:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }], "expression": { "id": 18235, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "30268:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18236, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "30283:18:123", "memberName": "calculateSpotPrice", "nodeType": "MemberAccess", "referencedDeclaration": 19690, "src": "30268:33:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$returns$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256) pure returns (uint256)" } }, "id": 18247, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "30268:262:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "nodeType": "BinaryOperation", "operator": ">", "rightExpression": { "id": 18248, "name": "ONE", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18806, "src": "30533:3:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "src": "30268:268:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" } }, "id": 18259, "nodeType": "IfStatement", "src": "30247:471:123", "trueBody": { "id": 18258, "nodeType": "Block", "src": "30551:167:123", "statements": [{ "expression": { "arguments": [{ "expression": { "expression": { "id": 18253, "name": "IHyperdrive", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 11143, "src": "30629:11:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_IHyperdrive_$11143_$", "typeString": "type(contract IHyperdrive)" } }, "id": 18254, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "30641:27:123", "memberName": "InsufficientLiquidityReason", "nodeType": "MemberAccess", "referencedDeclaration": 10996, "src": "30629:39:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_enum$_InsufficientLiquidityReason_$10996_$", "typeString": "type(enum IHyperdrive.InsufficientLiquidityReason)" } }, "id": 18255, "isConstant": false, "isLValue": false, "isPure": true, "lValueRequested": false, "memberLocation": "30669:16:123", "memberName": "NegativeInterest", "nodeType": "MemberAccess", "referencedDeclaration": 10994, "src": "30629:56:123", "typeDescriptions": { "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" } }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_enum$_InsufficientLiquidityReason_$10996", "typeString": "enum IHyperdrive.InsufficientLiquidityReason" }], "expression": { "id": 18250, "name": "Errors", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18797, "src": "30569:6:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_Errors_$18797_$", "typeString": "type(library Errors)" } }, "id": 18252, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "30576:31:123", "memberName": "throwInsufficientLiquidityError", "nodeType": "MemberAccess", "referencedDeclaration": 18796, "src": "30569:38:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_enum$_InsufficientLiquidityReason_$10996_$returns$__$", "typeString": "function (enum IHyperdrive.InsufficientLiquidityReason) pure" } }, "id": 18256, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "30569:134:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18257, "nodeType": "ExpressionStatement", "src": "30569:134:123" }] } }, { "expression": { "id": 18276, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "leftHandSide": { "components": [{ "id": 18260, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18088, "src": "31036:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18261, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "31067:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18262, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "31103:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18263, "name": "shareAdjustmentDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18092, "src": "31136:20:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, { "id": 18264, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18094, "src": "31174:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }], "id": 18265, "isConstant": false, "isInlineArray": false, "isLValue": true, "isPure": false, "lValueRequested": true, "nodeType": "TupleExpression", "src": "31018:188:123", "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,int256,uint256)" } }, "nodeType": "Assignment", "operator": "=", "rightHandSide": { "arguments": [{ "id": 18268, "name": "shareProceeds", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18088, "src": "31274:13:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18269, "name": "shareReservesDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18090, "src": "31305:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18270, "name": "shareCurveDelta", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18097, "src": "31341:15:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18271, "name": "totalGovernanceFee", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18094, "src": "31374:18:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18272, "name": "openVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18198, "src": "31410:19:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "id": 18273, "name": "closeVaultSharePrice", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 18207, "src": "31447:20:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, { "hexValue": "66616c7365", "id": 18274, "isConstant": false, "isLValue": false, "isPure": true, "kind": "bool", "lValueRequested": false, "nodeType": "Literal", "src": "31485:5:123", "typeDescriptions": { "typeIdentifier": "t_bool", "typeString": "bool" }, "value": "false" }], "expression": { "argumentTypes": [{ "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_uint256", "typeString": "uint256" }, { "typeIdentifier": "t_bool", "typeString": "bool" }], "expression": { "id": 18266, "name": "HyperdriveMath", "nodeType": "Identifier", "overloadedDeclarations": [], "referencedDeclaration": 20320, "src": "31209:14:123", "typeDescriptions": { "typeIdentifier": "t_type$_t_contract$_HyperdriveMath_$20320_$", "typeString": "type(library HyperdriveMath)" } }, "id": 18267, "isConstant": false, "isLValue": false, "isPure": false, "lValueRequested": false, "memberLocation": "31224:32:123", "memberName": "calculateNegativeInterestOnClose", "nodeType": "MemberAccess", "referencedDeclaration": 20319, "src": "31209:47:123", "typeDescriptions": { "typeIdentifier": "t_function_internal_pure$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_uint256_$_t_bool_$returns$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$", "typeString": "function (uint256,uint256,uint256,uint256,uint256,uint256,bool) pure returns (uint256,uint256,uint256,int256,uint256)" } }, "id": 18275, "isConstant": false, "isLValue": false, "isPure": false, "kind": "functionCall", "lValueRequested": false, "nameLocations": [], "names": [], "nodeType": "FunctionCall", "src": "31209:295:123", "tryCall": false, "typeDescriptions": { "typeIdentifier": "t_tuple$_t_uint256_$_t_uint256_$_t_uint256_$_t_int256_$_t_uint256_$", "typeString": "tuple(uint256,uint256,uint256,int256,uint256)" } }, "src": "31018:486:123", "typeDescriptions": { "typeIdentifier": "t_tuple$__$", "typeString": "tuple()" } }, "id": 18277, "nodeType": "ExpressionStatement", "src": "31018:486:123" }] }] }, "documentation": { "id": 18077, "nodeType": "StructuredDocumentation", "src": "23657:720:123", "text": "@dev Calculate the pool reserve and trader deltas that result from\n      closing a short. This calculation includes trading fees.\n @param _bondAmount The amount of bonds being purchased to close the\n        short.\n @param _vaultSharePrice The current vault share price.\n @param _maturityTime The maturity time of the short position.\n @return bondReservesDelta The change in the bond reserves.\n @return shareProceeds The proceeds in shares of closing the short.\n @return shareReservesDelta The shares added to the reserves.\n @return shareAdjustmentDelta The change in the share adjustment.\n @return totalGovernanceFee The governance fee in shares." }, "implemented": true, "kind": "function", "modifiers": [], "name": "_calculateCloseShort", "nameLocation": "24391:20:123", "parameters": { "id": 18084, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 18079, "mutability": "mutable", "name": "_bondAmount", "nameLocation": "24429:11:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24421:19:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18078, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24421:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 18081, "mutability": "mutable", "name": "_vaultSharePrice", "nameLocation": "24458:16:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24450:24:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18080, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24450:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 18083, "mutability": "mutable", "name": "_maturityTime", "nameLocation": "24492:13:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24484:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18082, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24484:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "24411:100:123" }, "returnParameters": { "id": 18095, "nodeType": "ParameterList", "parameters": [{ "constant": false, "id": 18086, "mutability": "mutable", "name": "bondReservesDelta", "nameLocation": "24580:17:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24572:25:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18085, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24572:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 18088, "mutability": "mutable", "name": "shareProceeds", "nameLocation": "24619:13:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24611:21:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18087, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24611:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 18090, "mutability": "mutable", "name": "shareReservesDelta", "nameLocation": "24654:18:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24646:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18089, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24646:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }, { "constant": false, "id": 18092, "mutability": "mutable", "name": "shareAdjustmentDelta", "nameLocation": "24693:20:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24686:27:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" }, "typeName": { "id": 18091, "name": "int256", "nodeType": "ElementaryTypeName", "src": "24686:6:123", "typeDescriptions": { "typeIdentifier": "t_int256", "typeString": "int256" } }, "visibility": "internal" }, { "constant": false, "id": 18094, "mutability": "mutable", "name": "totalGovernanceFee", "nameLocation": "24735:18:123", "nodeType": "VariableDeclaration", "scope": 18280, "src": "24727:26:123", "stateVariable": false, "storageLocation": "default", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" }, "typeName": { "id": 18093, "name": "uint256", "nodeType": "ElementaryTypeName", "src": "24727:7:123", "typeDescriptions": { "typeIdentifier": "t_uint256", "typeString": "uint256" } }, "visibility": "internal" }], "src": "24558:205:123" }, "scope": 18281, "stateMutability": "view", "virtual": false, "visibility": "internal" }], "abstract": true, "baseContracts": [{ "baseName": { "id": 17316, "name": "IHyperdriveEvents", "nameLocations": ["908:17:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 11666, "src": "908:17:123" }, "id": 17317, "nodeType": "InheritanceSpecifier", "src": "908:17:123" }, { "baseName": { "id": 17318, "name": "HyperdriveLP", "nameLocations": ["927:12:123"], "nodeType": "IdentifierPath", "referencedDeclaration": 15877, "src": "927:12:123" }, "id": 17319, "nodeType": "InheritanceSpecifier", "src": "927:12:123" }], "canonicalName": "HyperdriveShort", "contractDependencies": [], "contractKind": "contract", "documentation": { "id": 17315, "nodeType": "StructuredDocumentation", "src": "543:328:123", "text": "@author DELV\n @title HyperdriveShort\n @notice Implements the short accounting for Hyperdrive.\n @custom:disclaimer The language used in this code is for coding convenience\n                    only, and is not intended to, and does not, have any\n                    particular legal or regulatory significance." }, "fullyImplemented": false, "linearizedBaseContracts": [18281, 15877, 17295, 14511, 18497, 72173, 11666, 12232], "name": "HyperdriveShort", "nameLocation": "889:15:123", "scope": 18282, "usedErrors": [72118], "usedEvents": [11486, 11501, 11520, 11535, 11552, 11571, 11590, 11611, 11624, 11631, 11636, 11641, 11646, 11653, 11658, 11665, 12213, 12222, 12231] }], "license": "Apache-2.0" }, "id": 123 };
